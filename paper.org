# -*- coding: utf-8 -*-
# -*- org-confirm-babel-evaluate: nil -*-
# -*- mode: org -*-
#+TITLE:
#+LANGUAGE:  en
#+OPTIONS: H:5 author:nil email:nil creator:nil timestamp:nil skip:nil toc:nil ^:nil
#+TAGS: ARNAUD(a) CHRISTIAN(c) TOM(T)
#+TAGS: noexport(n) DEPRECATED(d) ignore(i)
#+TAGS: EXPERIMENT(e) LU(l) EP(e)
#+STARTUP: overview indent inlineimages logdrawer hidestars
#+EXPORT_SELECT_TAGS: export
#+EXPORT_EXCLUDE_TAGS: noexport
#+SEQ_TODO: TODO(t!) STARTED(s!) WAITING(w@) | DONE(d!) CANCELLED(c@) DEFERRED(@) FLAWED(f@)
#+LATEX_CLASS: acmart
#+LATEX_CLASS_OPTIONS: [sigconf,review]
#+PROPERTY: header-args :eval never-export

* R and Python dependencies and versions                           :noexport:
The following two sections provide an idea of the software environment
we used to generate this document. If you run into trouble with a
specific package, this will indicate you which version you should try
to install.
** R information
#+begin_src R :results output :session *R* :exports both
library(ggplot2)
library(gridExtra)
library(grid)
sessionInfo()
devtools::session_info()
#+end_src

#+RESULTS:
#+begin_example
R version 3.5.1 (2018-07-02)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Debian GNU/Linux buster/sid

Matrix products: default
BLAS: /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.8.0
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.8.0

locale:
[1] C

attached base packages:
[1] grid      stats     graphics  grDevices utils     datasets  methods  
[8] base     

other attached packages:
[1] gridExtra_2.3 ggplot2_3.1.0

loaded via a namespace (and not attached):
 [1] Rcpp_1.0.0         digest_0.6.15      withr_2.1.2        crayon_1.3.4      
 [5] dplyr_0.8.0.1      assertthat_0.2.0   plyr_1.8.4         R6_2.4.0          
 [9] gtable_0.2.0       magrittr_1.5       scales_1.0.0       pillar_1.3.1      
[13] rlang_0.3.1        lazyeval_0.2.1     labeling_0.3       RColorBrewer_1.1-2
[17] tools_3.5.1        glue_1.3.0         purrr_0.3.1        munsell_0.5.0     
[21] compiler_3.5.1     pkgconfig_2.0.2    colorspace_1.3-2   tidyselect_0.2.5  
[25] tibble_2.0.1
Session info ------------------------------------------------------------------
 setting  value                       
 version  R version 3.5.1 (2018-07-02)
 system   x86_64, linux-gnu           
 ui       X11                         
 language fr_FR.UTF-8                 
 collate  C                           
 tz       Europe/Paris                
 date     2019-04-03                  

Packages ----------------------------------------------------------------------
 package      * version date       source         
 assertthat     0.2.0   2017-04-11 CRAN (R 3.5.0) 
 base         * 3.5.1   2018-11-26 local          
 colorspace     1.3-2   2016-12-14 CRAN (R 3.5.0) 
 compiler       3.5.1   2018-11-26 local          
 crayon         1.3.4   2017-09-16 CRAN (R 3.5.0) 
 datasets     * 3.5.1   2018-11-26 local          
 devtools       1.13.6  2018-06-27 CRAN (R 3.5.1) 
 digest         0.6.15  2018-01-28 CRAN (R 3.5.0) 
 dplyr          0.8.0.1 2019-02-15 cran (@0.8.0.1)
 ggplot2      * 3.1.0   2018-10-25 CRAN (R 3.5.1) 
 glue           1.3.0   2018-07-17 cran (@1.3.0)  
 graphics     * 3.5.1   2018-11-26 local          
 grDevices    * 3.5.1   2018-11-26 local          
 grid         * 3.5.1   2018-11-26 local          
 gridExtra    * 2.3     2017-09-09 CRAN (R 3.5.1) 
 gtable         0.2.0   2016-02-26 CRAN (R 3.5.0) 
 labeling       0.3     2014-08-23 CRAN (R 3.5.0) 
 lazyeval       0.2.1   2017-10-29 CRAN (R 3.5.0) 
 magrittr       1.5     2014-11-22 CRAN (R 3.5.0) 
 memoise        1.1.0   2017-04-21 CRAN (R 3.5.1) 
 methods      * 3.5.1   2018-11-26 local          
 munsell        0.5.0   2018-06-12 CRAN (R 3.5.0) 
 pillar         1.3.1   2018-12-15 cran (@1.3.1)  
 pkgconfig      2.0.2   2018-08-16 cran (@2.0.2)  
 plyr           1.8.4   2016-06-08 CRAN (R 3.5.0) 
 purrr          0.3.1   2019-03-03 cran (@0.3.1)  
 R6             2.4.0   2019-02-14 cran (@2.4.0)  
 RColorBrewer   1.1-2   2014-12-07 CRAN (R 3.5.0) 
 Rcpp           1.0.0   2018-11-07 cran (@1.0.0)  
 rlang          0.3.1   2019-01-08 cran (@0.3.1)  
 scales         1.0.0   2018-08-09 cran (@1.0.0)  
 stats        * 3.5.1   2018-11-26 local          
 tibble         2.0.1   2019-01-12 cran (@2.0.1)  
 tidyselect     0.2.5   2018-10-11 cran (@0.2.5)  
 tools          3.5.1   2018-11-26 local          
 utils        * 3.5.1   2018-11-26 local          
 withr          2.1.2   2018-03-15 CRAN (R 3.5.0)
#+end_example

#+begin_src R :results table :session *R* :exports both :colnames yes
installed.packages()
#+end_src

#+RESULTS:
| Package                                                         | LibPath                                                    |                                                       Version | Priority       | Depends                                                      | Imports                                                        | LinkingTo         | Suggests                                                      | Enhances                                                 | License                     | License_is_FOSS | License_restricts_use | OS_type | MD5sum | NeedsCompilation | Built |       |       |
|-----------------------------------------------------------------+------------------------------------------------------------+---------------------------------------------------------------+----------------+--------------------------------------------------------------+----------------------------------------------------------------+-------------------+---------------------------------------------------------------+----------------------------------------------------------+-----------------------------+-----------------+-----------------------+---------+--------+------------------+-------+-------+-------|
| BH                                                              | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                      1.69.0-1 | nil            | nil                                                          | nil                                                            | nil               | nil                                                           | nil                                                      | BSL-1.0                     | nil             | nil                   | nil     | nil    | no               | 3.5.1 |       |       |
| Cubist                                                          | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         0.2.2 | nil            | lattice                                                      | reshape2                                                       | nil               | mlbench, caret, knitr                                         | nil                                                      | GPL-3                       | nil             | nil                   | nil     | nil    | yes              | 3.5.1 |       |       |
| Formula                                                         | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         1.2-3 | nil            | R (>= 2.0.0), stats                                          | nil                                                            | nil               | nil                                                           | nil                                                      | GPL-2                       | GPL-3           | nil                   | nil     | nil    | nil              |    no | 3.5.1 |       |
| Hmisc                                                           | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         4.1-1 | nil            | lattice, survival (>= 2.40-1), Formula, ggplot2 (>= 2.2)     | methods, latticeExtra, cluster, rpart, nnet, acepack, foreign, |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| gtable, grid, gridExtra, data.table, htmlTable (>= 1.11.0),     |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| viridis, htmltools, base64enc                                   | nil                                                        |       chron, rms, mice, tables, knitr, ff, ffbase, plotly (>= |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| 4.5.6)                                                          | nil                                                        |                                                    GPL (>= 2) | nil            | nil                                                          | nil                                                            | nil               | yes                                                           | 3.5.1                                                    |                             |                 |                       |         |        |                  |       |       |       |
| Matrix                                                          | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                        1.2-14 | recommended    | R (>= 3.2.0)                                                 | methods, graphics, grid, stats, utils, lattice                 | nil               | expm, MASS                                                    | MatrixModels, graph, SparseM, sfsmisc                    | GPL (>= 2)                  | file LICENCE    | nil                   | nil     | nil    | nil              |   yes | 3.5.1 |       |
| PKI                                                             | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                       0.1-5.1 | nil            | R (>= 2.9.0), base64enc                                      | nil                                                            | nil               | nil                                                           | gmp                                                      | GPL-2                       | GPL-3           | file LICENSE          | nil     | nil    | nil              |   nil |   yes | 3.5.1 |
| R.methodsS3                                                     | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         1.7.1 | nil            | R (>= 2.13.0)                                                | utils                                                          | nil               | nil                                                           | nil                                                      | LGPL (>= 2.1)               | nil             | nil                   | nil     | nil    | no               | 3.5.1 |       |       |
| R.oo                                                            | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                        1.22.0 | nil            | R (>= 2.13.0), R.methodsS3 (>= 1.7.1)                        | methods, utils                                                 | nil               | tools                                                         | nil                                                      | LGPL (>= 2.1)               | nil             | nil                   | nil     | nil    | no               | 3.5.1 |       |       |
| R.utils                                                         | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         2.7.0 | nil            | R (>= 2.14.0), R.oo (>= 1.21.0)                              | methods, utils, tools, R.methodsS3 (>= 1.7.1)                  | nil               | digest (>= 0.6.10)                                            | nil                                                      | LGPL (>= 2.1)               | nil             | nil                   | nil     | nil    | no               | 3.5.1 |       |       |
| R6                                                              | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         2.4.0 | nil            | R (>= 3.0)                                                   | nil                                                            | nil               | knitr, microbenchmark, pryr, testthat, ggplot2, scales        | nil                                                      | MIT + file LICENSE          | nil             | nil                   | nil     | nil    | no               | 3.5.1 |       |       |
| RCurl                                                           | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                     1.95-4.11 | nil            | R (>= 3.0.0), methods, bitops                                | nil                                                            | nil               | Rcompression, XML                                             | nil                                                      | BSD                         | nil             | nil                   | nil     | nil    | yes              | 3.5.1 |       |       |
| RJSONIO                                                         | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         1.3-0 | nil            | nil                                                          | methods                                                        | nil               | nil                                                           | nil                                                      | BSD_3_clause + file LICENSE | nil             | nil                   | nil     | nil    | yes              | 3.5.1 |       |       |
| Rcpp                                                            | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         1.0.0 | nil            | R (>= 3.0.0)                                                 | methods, utils                                                 | nil               | RUnit, inline, rbenchmark, knitr, rmarkdown, pinp, pkgKitten  |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| (>= 0.1.2)                                                      | nil                                                        |                                                    GPL (>= 2) | nil            | nil                                                          | nil                                                            | nil               | yes                                                           | 3.5.1                                                    |                             |                 |                       |         |        |                  |       |       |       |
| RgoogleMaps                                                     | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         1.4.2 | nil            | R (>= 2.10)                                                  | graphics, stats, utils, grDevices, methods, png                | nil               | PBSmapping, maptools, sp, loa, RColorBrewer, leaflet          | nil                                                      | GPL                         | nil             | nil                   | nil     | nil    | no               | 3.5.1 |       |       |
| Rttf2pt1                                                        | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         1.3.7 | nil            | R (>= 2.15)                                                  | nil                                                            | nil               | nil                                                           | nil                                                      | file LICENSE                | yes             | nil                   | nil     | nil    | yes              | 3.5.1 |       |       |
| acepack                                                         | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         1.4.1 | nil            | nil                                                          | nil                                                            | nil               | testthat                                                      | nil                                                      | MIT + file LICENSE          | nil             | nil                   | nil     | nil    | yes              | 3.5.1 |       |       |
| ascii                                                           | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                           2.1 | nil            | R (>= 2.13), utils, methods                                  | nil                                                            | nil               | survival, Hmisc, xtable, R2HTML, cacheSweave, weaver          | nil                                                      | GPL (>= 2)                  | nil             | nil                   | nil     | nil    | nil              | 3.5.1 |       |       |
| backports                                                       | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         1.1.2 | nil            | R (>= 3.0.0)                                                 | utils                                                          | nil               | nil                                                           | nil                                                      | GPL-2                       | nil             | nil                   | nil     | nil    | yes              | 3.5.1 |       |       |
| bitops                                                          | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         1.0-6 | nil            | nil                                                          | nil                                                            | nil               | nil                                                           | nil                                                      | GPL (>= 2)                  | nil             | nil                   | nil     | nil    | yes              | 3.5.1 |       |       |
| bookdown                                                        | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                           0.9 | nil            | nil                                                          | htmltools (>= 0.3.6), knitr (>= 1.16), rmarkdown (>= 1.9),     |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| xfun (>= 0.2), tinytex, yaml (>= 2.1.14)                        | nil                                                        |  htmlwidgets, rstudioapi, miniUI, rsconnect (>= 0.4.3), servr |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| (>= 0.3), shiny, testit (>= 0.5), tufte, webshot                | nil                                                        |                                                         GPL-3 | nil            | nil                                                          | nil                                                            | nil               | no                                                            | 3.5.1                                                    |                             |                 |                       |         |        |                  |       |       |       |
| caTools                                                         | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                      1.17.1.1 | nil            | R (>= 2.2.0)                                                 | bitops                                                         | nil               | MASS, rpart                                                   | nil                                                      | GPL-3                       | nil             | nil                   | nil     | nil    | yes              | 3.5.1 |       |       |
| checkmate                                                       | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         1.8.5 | nil            | R (>= 3.0.0)                                                 | backports (>= 1.1.0), utils                                    | nil               | R6, bit, fastmatch, data.table (>= 1.9.8), devtools, ggplot2, |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| knitr, magrittr, microbenchmark, rmarkdown, testthat (>=        |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| 0.11.0), tibble                                                 | nil                                                        |                                   BSD_3_clause + file LICENSE | nil            | nil                                                          | nil                                                            | nil               | yes                                                           | 3.5.1                                                    |                             |                 |                       |         |        |                  |       |       |       |
| cli                                                             | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         1.0.1 | nil            | R (>= 2.10)                                                  | assertthat, crayon (>= 1.3.4), methods, utils                  | nil               | covr, fansi, mockery, testthat, webshot, withr                | nil                                                      | MIT + file LICENSE          | nil             | nil                   | nil     | nil    | no               | 3.5.1 |       |       |
| cluster                                                         | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                       2.0.7-1 | recommended    | R (>= 3.2.0)                                                 | graphics, grDevices, stats, utils                              | nil               | MASS, Matrix                                                  | nil                                                      | GPL (>= 2)                  | nil             | nil                   | nil     | nil    | yes              | 3.5.1 |       |       |
| curl                                                            | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                           3.2 | nil            | R (>= 3.0.0)                                                 | nil                                                            | nil               | spelling, testthat (>= 1.0.0), knitr, jsonlite, rmarkdown,    |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| magrittr, httpuv, webutils                                      | nil                                                        |                                            MIT + file LICENSE | nil            | nil                                                          | nil                                                            | nil               | yes                                                           | 3.5.1                                                    |                             |                 |                       |         |        |                  |       |       |       |
| data.table                                                      | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                        1.11.4 | nil            | R (>= 3.1.0)                                                 | methods                                                        | nil               | bit64, curl, knitr, xts, nanotime, zoo, reshape2              | nil                                                      | MPL-2.0                     | file LICENSE    | nil                   | nil     | nil    | nil              |   yes | 3.5.1 |       |
| devtools                                                        | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                        1.13.6 | nil            | R (>= 3.0.2)                                                 | httr (>= 0.4), utils, tools, methods, memoise (>= 1.0.0),      |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| whisker, digest, rstudioapi (>= 0.2.0), jsonlite, stats, git2r  |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| (>= 0.11.0), withr                                              | nil                                                        |    curl (>= 0.9), crayon, testthat (>= 1.0.2), BiocInstaller, |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| Rcpp (>= 0.10.0), MASS, rmarkdown, knitr, hunspell (>= 2.0),    |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| lintr (>= 0.2.1), bitops, roxygen2 (>= 5.0.0), evaluate,        |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| rversions, covr, gmailr (> 0.7.0)                               | nil                                                        |                                                    GPL (>= 2) | nil            | nil                                                          | nil                                                            | nil               | no                                                            | 3.5.1                                                    |                             |                 |                       |         |        |                  |       |       |       |
| dplyr                                                           | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                       0.8.0.1 | nil            | R (>= 3.1.2)                                                 | assertthat (>= 0.2.0), glue (>= 1.1.1), magrittr (>= 1.5),     |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| methods, pkgconfig (>= 2.0.1), R6 (>= 2.2.2), Rcpp (>= 1.0.0),  |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| rlang (>= 0.3.0), tibble (>= 2.0.0), tidyselect (>= 0.2.5),     |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| utils                                                           | BH (>= 1.58.0-1), plogr (>= 0.1.10), Rcpp (>= 1.0.0)       |  bit64 (>= 0.9.7), callr (>= 3.1.1), covr (>= 3.0.1), DBI (>= |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| 0.7.14), dbplyr (>= 1.2.0), dtplyr (>= 0.0.2), ggplot2 (>=      |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| 2.2.1), hms (>= 0.4.1), knitr (>= 1.19), Lahman (>= 3.0-1),     |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| lubridate (>= 1.7.4), MASS, mgcv (>= 1.8.23), microbenchmark    |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| (>= 1.4.4), nycflights13 (>= 0.2.2), rmarkdown (>= 1.8), RMySQL |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| (>= 0.10.13), RPostgreSQL (>= 0.6.2), RSQLite (>= 2.0),         |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| testthat (>= 2.0.0), withr (>= 2.1.1), broom (>= 0.5.1), purrr  |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| (>= 0.3.0), readr (>= 1.3.1), crayon (>= 1.3.4)                 | nil                                                        |                                            MIT + file LICENSE | nil            | nil                                                          | nil                                                            | nil               | yes                                                           | 3.5.1                                                    |                             |                 |                       |         |        |                  |       |       |       |
| extrafont                                                       | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                          0.17 | nil            | R (>= 2.15)                                                  | extrafontdb, grDevices, utils, Rttf2pt1                        | nil               | fontcm                                                        | nil                                                      | GPL-2                       | nil             | nil                   | nil     | nil    | no               | 3.5.1 |       |       |
| extrafontdb                                                     | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                           1.0 | nil            | R (>= 2.14)                                                  | nil                                                            | nil               | nil                                                           | nil                                                      | GPL-2                       | nil             | nil                   | nil     | nil    | nil              | 3.5.1 |       |       |
| fansi                                                           | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         0.4.0 | nil            | R (>= 3.1.0)                                                 | nil                                                            | nil               | unitizer, knitr, rmarkdown                                    | nil                                                      | GPL (>= 2)                  | nil             | nil                   | nil     | nil    | yes              | 3.5.1 |       |       |
| foreign                                                         | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                        0.8-71 | recommended    | R (>= 3.0.0)                                                 | methods, utils, stats                                          | nil               | nil                                                           | nil                                                      | GPL (>= 2)                  | nil             | nil                   | nil     | nil    | yes              | 3.5.1 |       |       |
| geosphere                                                       | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         1.5-7 | nil            | R (>= 3.0.0)                                                 | sp                                                             | nil               | methods, raster                                               | nil                                                      | GPL (>= 3)                  | nil             | nil                   | nil     | nil    | yes              | 3.5.1 |       |       |
| gg3D                                                            | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                    0.0.0.9000 | nil            | R (>= 3.3.3), ggplot2                                        | plyr, dplyr, magrittr, plot3D, scales                          | nil               | knitr,                                                        |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| rmarkdown                                                       | nil                                                        |                                                         GPLv3 | nil            | nil                                                          | nil                                                            | nil               | nil                                                           | 3.5.1                                                    |                             |                 |                       |         |        |                  |       |       |       |
| ggmap                                                           | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         2.6.1 | nil            | R (>= 2.14.0), ggplot2 (>= 2.0.0)                            | proto, RgoogleMaps, png, plyr, reshape2, rjson, mapproj, jpeg, |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| geosphere, digest, scales                                       | nil                                                        |                                  MASS, stringr, hexbin, dplyr | nil            | GPL-2                                                        | nil                                                            | nil               | nil                                                           | nil                                                      | no                          | 3.5.1           |                       |         |        |                  |       |       |       |
| ggrepel                                                         | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         0.8.0 | nil            | R (>= 3.0.0), ggplot2 (>= 2.2.0)                             | grid, Rcpp, scales (>= 0.3.0)                                  | Rcpp              | knitr, rmarkdown, testthat, gridExtra, devtools, prettydoc    | nil                                                      | GPL-3                       | file LICENSE    | nil                   | nil     | nil    | nil              |   yes | 3.5.1 |       |
| ggthemes                                                        | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         4.0.1 | nil            | R (>= 3.0.0)                                                 | ggplot2 (>= 3.0.0), graphics, grid, methods, purrr, scales,    |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| stringr, tibble                                                 | nil                                                        |    dplyr, covr, extrafont, glue, knitr, lattice, lintr, maps, |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| mapproj, pander, rlang, rmarkdown, spelling, testthat, tidyr,   |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| vdiffr, withr                                                   | nil                                                        |                                                         GPL-2 | nil            | nil                                                          | nil                                                            | nil               | no                                                            | 3.5.1                                                    |                             |                 |                       |         |        |                  |       |       |       |
| git2r                                                           | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                        0.23.0 | nil            | R (>= 3.1)                                                   | graphics, utils                                                | nil               | getPass                                                       | nil                                                      | GPL-2                       | nil             | nil                   | nil     | nil    | yes              | 3.5.1 |       |       |
| glue                                                            | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         1.3.0 | nil            | R (>= 3.1)                                                   | methods                                                        | nil               | testthat, covr, magrittr, crayon, knitr, rmarkdown, DBI,      |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| RSQLite, R.utils, forcats, microbenchmark, rprintf, stringr,    |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| ggplot2, dplyr, withr                                           | nil                                                        |                                            MIT + file LICENSE | nil            | nil                                                          | nil                                                            | nil               | yes                                                           | 3.5.1                                                    |                             |                 |                       |         |        |                  |       |       |       |
| gridExtra                                                       | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                           2.3 | nil            | nil                                                          | gtable, grid, grDevices, graphics, utils                       | nil               | ggplot2, egg, lattice, knitr, testthat                        | nil                                                      | GPL (>= 2)                  | nil             | nil                   | nil     | nil    | no               | 3.5.1 |       |       |
| htmlTable                                                       | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                          1.12 | nil            | nil                                                          | stringr, knitr (>= 1.6), magrittr (>= 1.5), methods,           |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| checkmate, htmlwidgets, htmltools, rstudioapi (>= 0.6)          | nil                                                        |     testthat, XML, xtable, ztable, Hmisc, reshape, rmarkdown, |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| pander, chron, lubridate, tibble, tidyr (>= 0.7.2), dplyr (>=   |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| 0.7.4)                                                          | nil                                                        |                                                    GPL (>= 3) | nil            | nil                                                          | nil                                                            | nil               | no                                                            | 3.5.1                                                    |                             |                 |                       |         |        |                  |       |       |       |
| htmlwidgets                                                     | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                           1.2 | nil            | nil                                                          | grDevices, htmltools (>= 0.3), jsonlite (>= 0.9.16), yaml      | nil               | knitr (>= 1.8)                                                | shiny (>= 1.0.5)                                         | MIT + file LICENSE          | nil             | nil                   | nil     | nil    | no               | 3.5.1 |       |       |
| httr                                                            | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         1.3.1 | nil            | R (>= 3.0.0)                                                 | jsonlite, mime, curl (>= 0.9.1), openssl (>= 0.8), R6          | nil               | httpuv, jpeg, knitr, png, testthat (>= 0.8.0), readr, xml2,   |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| rmarkdown, covr                                                 | nil                                                        |                                            MIT + file LICENSE | nil            | nil                                                          | nil                                                            | nil               | no                                                            | 3.5.1                                                    |                             |                 |                       |         |        |                  |       |       |       |
| inline                                                          | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                        0.3.15 | nil            | R (>= 2.4.0)                                                 | methods                                                        | nil               | Rcpp (>= 0.11.0)                                              | nil                                                      | LGPL                        | nil             | nil                   | nil     | nil    | no               | 3.5.1 |       |       |
| jpeg                                                            | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         0.1-8 | nil            | R (>= 2.9.0)                                                 | nil                                                            | nil               | nil                                                           | nil                                                      | GPL-2                       | GPL-3           | nil                   | nil     | nil    | nil              |   yes | 3.5.1 |       |
| jsonlite                                                        | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                           1.5 | nil            | methods                                                      | nil                                                            | nil               | httr, curl, plyr, testthat, knitr, rmarkdown, R.rsp, sp       | nil                                                      | MIT + file LICENSE          | nil             | nil                   | nil     | nil    | yes              | 3.5.1 |       |       |
| latex2exp                                                       | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         0.4.0 | nil            | nil                                                          | stringr, magrittr                                              | nil               | testthat, knitr, ggplot2, plyr, rmarkdown                     | nil                                                      | MIT + file LICENSE          | nil             | nil                   | nil     | nil    | no               | 3.5.1 |       |       |
| latticeExtra                                                    | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                        0.6-28 | nil            | R (>= 2.10.0), lattice, RColorBrewer                         | grid, stats, utils, grDevices                                  | nil               | maps, mapproj, deldir, tripack, zoo, MASS, quantreg, mgcv     | nil                                                      | GPL (>= 2)                  | nil             | nil                   | nil     | nil    | no               | 3.5.1 |       |       |
| mailR                                                           | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         0.4.1 | nil            | nil                                                          | rJava, stringr, R.utils                                        | nil               | nil                                                           | nil                                                      | GPL-3                       | nil             | nil                   | nil     | nil    | no               | 3.5.1 |       |       |
| mapproj                                                         | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         1.2.6 | nil            | R (>= 3.0.0), maps (>= 2.3-0)                                | stats, graphics                                                | nil               | nil                                                           | nil                                                      | Lucent Public License       | nil             | nil                   | nil     | nil    | yes              | 3.5.1 |       |       |
| maps                                                            | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         3.3.0 | nil            | R (>= 3.0.0)                                                 | graphics, utils                                                | nil               | mapproj (>= 1.2-0), mapdata (>= 2.3.0), sp, maptools,         |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| rnaturalearth                                                   | nil                                                        |                                                         GPL-2 | nil            | nil                                                          | nil                                                            | nil               | yes                                                           | 3.5.1                                                    |                             |                 |                       |         |        |                  |       |       |       |
| memoise                                                         | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         1.1.0 | nil            | nil                                                          | digest (>= 0.6.3)                                              | nil               | testthat, aws.s3, httr, covr                                  | nil                                                      | MIT + file LICENSE          | nil             | nil                   | nil     | nil    | no               | 3.5.1 |       |       |
| misc3d                                                          | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         0.8-4 | nil            | nil                                                          | nil                                                            | nil               | rgl, tkrplot, MASS                                            | nil                                                      | GPL                         | nil             | nil                   | nil     | nil    | nil              | 3.5.1 |       |       |
| network3d                                                       | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         0.1.0 | nil            | nil                                                          | htmlwidgets                                                    | nil               | nil                                                           | nil                                                      | What license is it under?   | nil             | nil                   | nil     | nil    | nil              | 3.5.1 |       |       |
| openssl                                                         | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         1.0.2 | nil            | nil                                                          | nil                                                            | nil               | testthat, digest, knitr, rmarkdown, jsonlite, jose            | nil                                                      | MIT + file LICENSE          | nil             | nil                   | nil     | nil    | yes              | 3.5.1 |       |       |
| packrat                                                         | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                       0.4.9-3 | nil            | R (>= 3.0.0)                                                 | tools, utils                                                   | nil               | testthat (>= 0.7), devtools, httr, knitr, rmarkdown           | BiocInstaller                                            | GPL-2                       | nil             | nil                   | nil     | nil    | no               | 3.5.1 |       |       |
| pillar                                                          | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         1.3.1 | nil            | nil                                                          | cli (>= 1.0.0), crayon (>= 1.3.4), fansi (>= 0.4.0), methods,  |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| rlang (>= 0.3.0.1), utf8 (>= 1.1.3)                             | nil                                                        |   knitr (>= 1.19), lubridate (>= 1.7.4), testthat (>= 2.0.0), |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| withr (>= 2.1.2)                                                | nil                                                        |                                                         GPL-3 | nil            | nil                                                          | nil                                                            | nil               | no                                                            | 3.5.1                                                    |                             |                 |                       |         |        |                  |       |       |       |
| pkgconfig                                                       | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         2.0.2 | nil            | nil                                                          | utils                                                          | nil               | covr, testthat, disposables (>= 1.0.3)                        | nil                                                      | MIT + file LICENSE          | nil             | nil                   | nil     | nil    | no               | 3.5.1 |       |       |
| plogr                                                           | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         0.2.0 | nil            | nil                                                          | nil                                                            | nil               | Rcpp                                                          | nil                                                      | MIT + file LICENSE          | nil             | nil                   | nil     | nil    | no               | 3.5.1 |       |       |
| plot3D                                                          | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         1.1.1 | nil            | R (>= 2.15)                                                  | misc3d, stats, graphics, grDevices                             | nil               | nil                                                           | nil                                                      | GPL (>= 3.0)                | nil             | nil                   | nil     | nil    | no               | 3.5.1 |       |       |
| prettyunits                                                     | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         1.0.2 | nil            | nil                                                          | magrittr, assertthat, methods                                  | nil               | testthat                                                      | nil                                                      | MIT + file LICENSE          | nil             | nil                   | nil     | nil    | no               | 3.5.1 |       |       |
| proto                                                           | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         1.0.0 | nil            | nil                                                          | nil                                                            | nil               | testthat, covr                                                | nil                                                      | GPL-2                       | nil             | nil                   | nil     | nil    | no               | 3.5.1 |       |       |
| ps                                                              | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         1.2.1 | nil            | R (>= 3.1)                                                   | utils                                                          | nil               | callr, covr, curl, pingr, processx (>= 3.1.0), R6, rlang,     |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| testthat, tibble                                                | nil                                                        |                                   BSD_3_clause + file LICENSE | nil            | nil                                                          | nil                                                            | nil               | yes                                                           | 3.5.1                                                    |                             |                 |                       |         |        |                  |       |       |       |
| purrr                                                           | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         0.3.1 | nil            | R (>= 3.1)                                                   | magrittr (>= 1.5), rlang (>= 0.3.1)                            | nil               | covr, crayon, dplyr (>= 0.7.8), knitr, rmarkdown, testthat,   |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| tibble, tidyselect                                              | nil                                                        |                                                         GPL-3 | file LICENSE   | nil                                                          | nil                                                            | nil               | nil                                                           | yes                                                      | 3.5.1                       |                 |                       |         |        |                  |       |       |       |
| rJava                                                           | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                        0.9-10 | nil            | R (>= 2.5.0), methods                                        | nil                                                            | nil               | nil                                                           | nil                                                      | GPL-2                       | nil             | nil                   | nil     | nil    | yes              | 3.5.1 |       |       |
| reshape                                                         | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         0.8.8 | nil            | R (>= 2.6.1)                                                 | plyr                                                           | nil               | nil                                                           | nil                                                      | MIT + file LICENSE          | nil             | nil                   | nil     | nil    | yes              | 3.5.1 |       |       |
| rjson                                                           | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                        0.2.20 | nil            | R (>= 3.1.0)                                                 | nil                                                            | nil               | nil                                                           | nil                                                      | GPL-2                       | nil             | nil                   | nil     | nil    | yes              | 3.5.1 |       |       |
| rlang                                                           | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         0.3.1 | nil            | R (>= 3.1.0)                                                 | nil                                                            | nil               | crayon, magrittr, methods, pillar, testthat (>= 2.0.0), covr  | nil                                                      | GPL-3                       | nil             | nil                   | nil     | nil    | yes              | 3.5.1 |       |       |
| rmarkdown                                                       | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                           1.1 | nil            | R (>= 3.0)                                                   | tools, utils, knitr (>= 1.18), yaml (>= 2.1.5), htmltools (>=  |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| 0.3.5), evaluate (>= 0.8), base64enc, jsonlite, rprojroot,      |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| mime, tinytex (>= 0.3), methods, stringr (>= 1.2.0)             | nil                                                        |    shiny (>= 0.11), tufte, testthat, digest, dygraphs, tibble | nil            | GPL-3                                                        | nil                                                            | nil               | nil                                                           | nil                                                      | no                          | 3.5.1           |                       |         |        |                  |       |       |       |
| rprojroot                                                       | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         1.3-2 | nil            | R (>= 3.0.0)                                                 | backports                                                      | nil               | testthat, mockr, knitr, withr, rmarkdown                      | nil                                                      | GPL-3                       | nil             | nil                   | nil     | nil    | no               | 3.5.1 |       |       |
| rsconnect                                                       | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         0.8.8 | nil            | R (>= 3.0.0)                                                 | digest, PKI, RCurl, RJSONIO, packrat (>= 0.4.8-1), yaml (>=    |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| 2.1.5), rstudioapi (>= 0.5)                                     | nil                                                        |      knitr, testthat, rmarkdown (>= 1.1), plumber (>= 0.3.2), |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| shiny, sourcetools, xtable                                      | BiocInstaller                                              |                                                         GPL-2 | nil            | nil                                                          | nil                                                            | nil               | no                                                            | 3.5.1                                                    |                             |                 |                       |         |        |                  |       |       |       |
| rstudioapi                                                      | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                           0.7 | nil            | nil                                                          | nil                                                            | nil               | testthat, knitr, rmarkdown                                    | nil                                                      | MIT + file LICENSE          | nil             | nil                   | nil     | nil    | no               | 3.5.1 |       |       |
| scales                                                          | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         1.0.0 | nil            | R (>= 3.1)                                                   | labeling, munsell (>= 0.5), R6, RColorBrewer, Rcpp,            |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| viridisLite                                                     | Rcpp                                                       |                dichromat, bit64, covr, hms, testthat (>= 2.0) | nil            | MIT + file LICENSE                                           | nil                                                            | nil               | nil                                                           | nil                                                      | yes                         | 3.5.1           |                       |         |        |                  |       |       |       |
| sp                                                              | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         1.3-1 | nil            | R (>= 3.0.0), methods                                        | utils, stats, graphics, grDevices, lattice, grid               | nil               | RColorBrewer, rgdal (>= 0.8-7), rgeos (>= 0.3-13), gstat,     |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| maptools, deldir                                                | nil                                                        |                                                    GPL (>= 2) | nil            | nil                                                          | nil                                                            | nil               | yes                                                           | 3.5.1                                                    |                             |                 |                       |         |        |                  |       |       |       |
| survival                                                        | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                        2.42-6 | recommended    | R (>= 2.13.0)                                                | graphics, Matrix, methods, splines, stats, utils               | nil               | nil                                                           | nil                                                      | LGPL (>= 2)                 | nil             | nil                   | nil     | nil    | yes              | 3.5.1 |       |       |
| tibble                                                          | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         2.0.1 | nil            | R (>= 3.1.0)                                                 | cli (>= 1.0.1), crayon (>= 1.3.4), fansi (>= 0.4.0), methods,  |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| pillar (>= 1.3.1), pkgconfig (>= 2.0.2), rlang (>= 0.3.1),      |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| utils                                                           | nil                                                        |          bench (>= 1.0.1), covr (>= 3.2.1), dplyr (>= 0.7.8), |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| htmltools (>= 0.3.6), import (>= 1.1.0), knitr (>= 1.21), mockr |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| (>= 0.1), nycflights13 (>= 1.0.0), rmarkdown (>= 1.11),         |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| testthat (>= 2.0.1), withr (>= 2.1.2)                           | nil                                                        |                                            MIT + file LICENSE | nil            | nil                                                          | nil                                                            | nil               | yes                                                           | 3.5.1                                                    |                             |                 |                       |         |        |                  |       |       |       |
| tidyselect                                                      | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         0.2.5 | nil            | R (>= 3.1)                                                   | glue (>= 1.3.0), purrr, rlang (>= 0.2.2), Rcpp (>= 0.12.0)     | Rcpp (>= 0.12.0), | covr, dplyr, testthat                                         | nil                                                      | GPL-3                       | nil             | nil                   | nil     | nil    | yes              | 3.5.1 |       |       |
| tufte                                                           | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                           0.4 | nil            | nil                                                          | htmltools, xfun, knitr (>= 1.18), rmarkdown                    | nil               | nil                                                           | nil                                                      | GPL-3                       | nil             | nil                   | nil     | nil    | no               | 3.5.1 |       |       |
| viridis                                                         | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         0.5.1 | nil            | R (>= 2.10), viridisLite (>= 0.3.0)                          | stats, ggplot2 (>= 1.0.1), gridExtra                           | nil               | hexbin (>= 1.27.0), scales, MASS, knitr, dichromat,           |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| colorspace, rasterVis, httr, mapproj, vdiffr, svglite (>=       |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| 1.2.0), testthat, covr, rmarkdown, rgdal                        | nil                                                        |                                            MIT + file LICENSE | nil            | nil                                                          | nil                                                            | nil               | no                                                            | 3.5.1                                                    |                             |                 |                       |         |        |                  |       |       |       |
| whisker                                                         | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         0.3-2 | nil            | nil                                                          | nil                                                            | nil               | markdown                                                      | nil                                                      | GPL-3                       | nil             | nil                   | nil     | nil    | no               | 3.5.1 |       |       |
| xfun                                                            | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                           0.5 | nil            | nil                                                          | tools                                                          | nil               | testit, parallel, rstudioapi, tinytex, mime, markdown, knitr, |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| htmltools, base64enc, remotes, rmarkdown                        | nil                                                        |                                            MIT + file LICENSE | nil            | nil                                                          | nil                                                            | nil               | no                                                            | 3.5.1                                                    |                             |                 |                       |         |        |                  |       |       |       |
| xkcd                                                            | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         0.0.6 | nil            | ggplot2 (>= 3.0), extrafont                                  | Hmisc, stats                                                   | nil               | nil                                                           | nil                                                      | GPL-3                       | nil             | nil                   | nil     | nil    | no               | 3.5.1 |       |       |
| yaml                                                            | /home/alegrand/R/x86_64-pc-linux-gnu-library/3.5           |                                                         2.2.0 | nil            | nil                                                          | nil                                                            | nil               | RUnit                                                         | nil                                                      | BSD_3_clause + file LICENSE | nil             | nil                   | nil     | nil    | yes              | 3.5.1 |       |       |
| DBI                                                             | /usr/lib/R/site-library                                    |                                                         1.0.0 | nil            | R (>= 3.0.0), methods                                        | nil                                                            | nil               | blob, covr, hms, knitr, magrittr, rprojroot, rmarkdown,       |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| RSQLite (>= 1.1-2), testthat, xml2                              | nil                                                        |                                                   LGPL (>= 2) | nil            | nil                                                          | nil                                                            | nil               | no                                                            | 3.5.0                                                    |                             |                 |                       |         |        |                  |       |       |       |
| MatrixModels                                                    | /usr/lib/R/site-library                                    |                                                         0.4-1 | nil            | R (>= 3.0.1)                                                 | stats, methods, Matrix (>= 1.1-5)                              | nil               | nil                                                           | nil                                                      | GPL (>= 2)                  | nil             | nil                   | nil     | nil    | no               | 3.5.0 |       |       |
| R6                                                              | /usr/lib/R/site-library                                    |                                                         2.2.2 | nil            | R (>= 3.0)                                                   | nil                                                            | nil               | knitr, microbenchmark, pryr, testthat, ggplot2, scales        | nil                                                      | MIT + file LICENSE          | nil             | nil                   | nil     | nil    | no               | 3.5.0 |       |       |
| RColorBrewer                                                    | /usr/lib/R/site-library                                    |                                                         1.1-2 | nil            | R (>= 2.0.0)                                                 | nil                                                            | nil               | nil                                                           | nil                                                      | Apache License 2.0          | nil             | nil                   | nil     | nil    | no               | 3.5.0 |       |       |
| RUnit                                                           | /usr/lib/R/site-library                                    |                                                        0.4.32 | nil            | R (>= 2.5.0), utils (>= 2.5.0), methods (>= 2.5.0), graphics |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| (>= 2.5.0)                                                      | nil                                                        |                                                           nil | XML (>= 3.1.0) | nil                                                          | GPL-2                                                          | nil               | nil                                                           | nil                                                      | nil                         | no              | 3.5.0                 |         |        |                  |       |       |       |
| Rcpp                                                            | /usr/lib/R/site-library                                    |                                                       0.12.17 | nil            | R (>= 3.0.0)                                                 | methods, utils                                                 | nil               | RUnit, inline, rbenchmark, knitr, rmarkdown, pinp, pkgKitten  |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| (>= 0.1.2)                                                      | nil                                                        |                                                    GPL (>= 2) | nil            | nil                                                          | nil                                                            | nil               | yes                                                           | 3.5.0                                                    |                             |                 |                       |         |        |                  |       |       |       |
| RcppEigen                                                       | /usr/lib/R/site-library                                    |                                                     0.3.3.4.0 | nil            | R (>= 2.15.1)                                                | Matrix (>= 1.1-0), Rcpp (>= 0.11.0), stats, utils              | Rcpp              | inline, RUnit, pkgKitten                                      | nil                                                      | GPL (>= 2)                  | file LICENSE    | nil                   | nil     | nil    | nil              |   yes | 3.5.1 |       |
| SparseM                                                         | /usr/lib/R/site-library                                    |                                                          1.77 | nil            | R (>= 2.15), methods                                         | graphics, stats, utils                                         | nil               | nil                                                           | nil                                                      | GPL (>= 2)                  | nil             | nil                   | nil     | nil    | yes              | 3.5.1 |       |       |
| StanHeaders                                                     | /usr/lib/R/site-library                                    |                                                        2.18.0 | nil            | R (>= 3.4.0)                                                 | nil                                                            | nil               | Rcpp, RcppEigen, BH, knitr (>= 1.15.1), rmarkdown             | nil                                                      | BSD_3_clause + file LICENSE | nil             | nil                   | nil     | nil    | yes              | 3.5.1 |       |       |
| abind                                                           | /usr/lib/R/site-library                                    |                                                         1.4-5 | nil            | R (>= 1.5.0)                                                 | methods, utils                                                 | nil               | nil                                                           | nil                                                      | LGPL (>= 2)                 | nil             | nil                   | nil     | nil    | no               | 3.5.0 |       |       |
| assertthat                                                      | /usr/lib/R/site-library                                    |                                                         0.2.0 | nil            | nil                                                          | tools                                                          | nil               | testthat                                                      | nil                                                      | GPL-3                       | nil             | nil                   | nil     | nil    | no               | 3.5.0 |       |       |
| backports                                                       | /usr/lib/R/site-library                                    |                                                         1.1.2 | nil            | R (>= 3.0.0)                                                 | utils                                                          | nil               | nil                                                           | nil                                                      | GPL-2                       | nil             | nil                   | nil     | nil    | yes              | 3.5.0 |       |       |
| base64enc                                                       | /usr/lib/R/site-library                                    |                                                         0.1-3 | nil            | R (>= 2.9.0)                                                 | nil                                                            | nil               | nil                                                           | png                                                      | GPL-2                       | GPL-3           | nil                   | nil     | nil    | nil              |   yes | 3.5.0 |       |
| bindr                                                           | /usr/lib/R/site-library                                    |                                                         0.1.1 | nil            | nil                                                          | nil                                                            | nil               | testthat                                                      | nil                                                      | MIT + file LICENSE          | nil             | nil                   | nil     | nil    | no               | 3.5.0 |       |       |
| bindrcpp                                                        | /usr/lib/R/site-library                                    |                                                         0.2.2 | nil            | nil                                                          | bindr (>= 0.1.1), Rcpp (>= 0.12.16)                            | plogr, Rcpp       | testthat                                                      | nil                                                      | MIT + file LICENSE          | nil             | nil                   | nil     | nil    | yes              | 3.5.0 |       |       |
| bitops                                                          | /usr/lib/R/site-library                                    |                                                         1.0-6 | nil            | nil                                                          | nil                                                            | nil               | nil                                                           | nil                                                      | GPL (>= 2)                  | nil             | nil                   | nil     | nil    | yes              | 3.5.0 |       |       |
| broom                                                           | /usr/lib/R/site-library                                    |                                                         0.5.0 | nil            | R (>= 3.1)                                                   | backports, dplyr, methods, nlme, purrr, reshape2, stringr,     |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| tibble, tidyr                                                   | nil                                                        | AER, akima, AUC, bbmle, betareg, biglm, binGroup, boot, brms, |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| btergm, car, caret, coda, covr, e1071, emmeans, ergm, gam (>=   |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| 1.15), gamlss, gamlss.data, gamlss.dist, geepack, ggplot2,      |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| glmnet, gmm, Hmisc, irlba, joineRML, Kendall, knitr, ks,        |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| Lahman, lavaan, lfe, lme4, lmodel2, lmtest, lsmeans, maps,      |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| maptools, MASS, Matrix, mclust, mgcv, muhaz, multcomp, network, |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| nnet, orcutt (>= 2.2), ordinal, plm, plyr, poLCA, psych,        |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| quantreg, rgeos, rmarkdown, robust, rsample, rstan, rstanarm,   |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| sp, speedglm, statnet.common, survey, survival, testthat,       |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| tseries, xergm, zoo                                             | nil                                                        |                                            MIT + file LICENSE | nil            | nil                                                          | nil                                                            | nil               | no                                                            | 3.5.1                                                    |                             |                 |                       |         |        |                  |       |       |       |
| caTools                                                         | /usr/lib/R/site-library                                    |                                                      1.17.1.1 | nil            | R (>= 2.2.0)                                                 | bitops                                                         | nil               | MASS, rpart                                                   | nil                                                      | GPL-3                       | nil             | nil                   | nil     | nil    | yes              | 3.5.1 |       |       |
| callr                                                           | /usr/lib/R/site-library                                    |                                                         3.0.0 | nil            | nil                                                          | base64enc, processx (>= 3.2.0), R6, utils                      | nil               | covr, crayon, ps, testthat, withr                             | nil                                                      | MIT + file LICENSE          | nil             | nil                   | nil     | nil    | no               | 3.5.1 |       |       |
| car                                                             | /usr/lib/R/site-library                                    |                                                         3.0-2 | nil            | R (>= 3.2.0), carData (>= 3.0-0)                             | abind, MASS, mgcv, nnet, pbkrtest (>= 0.4-4), quantreg,        |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| grDevices, utils, stats, graphics, maptools, rio, lme4, nlme    | nil                                                        |   alr4, boot, coxme, leaps, lmtest, Matrix, MatrixModels, rgl |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| (>= 0.93.960), sandwich, SparseM, survival, survey              | nil                                                        |                                                    GPL (>= 2) | nil            | nil                                                          | nil                                                            | nil               | no                                                            | 3.5.1                                                    |                             |                 |                       |         |        |                  |       |       |       |
| carData                                                         | /usr/lib/R/site-library                                    |                                                         3.0-1 | nil            | R (>= 3.0)                                                   | nil                                                            | nil               | nil                                                           | nil                                                      | GPL (>= 2)                  | nil             | nil                   | nil     | nil    | no               | 3.5.0 |       |       |
| cellranger                                                      | /usr/lib/R/site-library                                    |                                                         1.1.0 | nil            | R (>= 3.0.0)                                                 | rematch, tibble                                                | nil               | covr, testthat (>= 1.0.0), knitr, rmarkdown                   | nil                                                      | MIT + file LICENSE          | nil             | nil                   | nil     | nil    | no               | 3.5.0 |       |       |
| cli                                                             | /usr/lib/R/site-library                                    |                                                         1.0.0 | nil            | R (>= 2.10)                                                  | assertthat, crayon, methods                                    | nil               | covr, mockery, testthat, withr                                | nil                                                      | MIT + file LICENSE          | nil             | nil                   | nil     | nil    | no               | 3.5.0 |       |       |
| clipr                                                           | /usr/lib/R/site-library                                    |                                                         0.4.1 | nil            | nil                                                          | utils                                                          | nil               | rstudioapi (>= 0.5), testthat, covr                           | nil                                                      | GPL-3                       | nil             | nil                   | nil     | nil    | no               | 3.5.1 |       |       |
| colorspace                                                      | /usr/lib/R/site-library                                    |                                                         1.3-2 | nil            | R (>= 2.13.0), methods                                       | graphics, grDevices                                            | nil               | datasets, stats, utils, KernSmooth, MASS, kernlab, mvtnorm,   |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| vcd, dichromat, tcltk, shiny, shinyjs                           | nil                                                        |                                   BSD_3_clause + file LICENSE | nil            | nil                                                          | nil                                                            | nil               | yes                                                           | 3.5.0                                                    |                             |                 |                       |         |        |                  |       |       |       |
| crayon                                                          | /usr/lib/R/site-library                                    |                                                         1.3.4 | nil            | nil                                                          | grDevices, methods, utils                                      | nil               | mockery, rstudioapi, testthat, withr                          | nil                                                      | MIT + file LICENSE          | nil             | nil                   | nil     | nil    | no               | 3.5.0 |       |       |
| curl                                                            | /usr/lib/R/site-library                                    |                                                           3.2 | nil            | R (>= 3.0.0)                                                 | nil                                                            | nil               | spelling, testthat (>= 1.0.0), knitr, jsonlite, rmarkdown,    |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| magrittr, httpuv, webutils                                      | nil                                                        |                                            MIT + file LICENSE | nil            | nil                                                          | nil                                                            | nil               | yes                                                           | 3.5.0                                                    |                             |                 |                       |         |        |                  |       |       |       |
| data.table                                                      | /usr/lib/R/site-library                                    |                                                        1.11.8 | nil            | R (>= 3.1.0)                                                 | methods                                                        | nil               | bit64, curl, R.utils, knitr, xts, nanotime, zoo               | nil                                                      | MPL-2.0                     | file LICENSE    | nil                   | nil     | nil    | nil              |   yes | 3.5.1 |       |
| dbplyr                                                          | /usr/lib/R/site-library                                    |                                                         1.2.2 | nil            | R (>= 3.2)                                                   | assertthat (>= 0.2.0), DBI (>= 0.7), dplyr (>= 0.7.4), glue    |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| (>= 1.2.0), methods, purrr (>= 0.2.4), R6 (>= 2.2.2), rlang (>= |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| 0.1.6), tibble (>= 1.4.1), tidyselect (>= 0.2.2), utils         | nil                                                        |       bit64, covr, knitr, Lahman (>= 5.0.0), nycflights13 (>= |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| 0.2.2), rmarkdown, RMariaDB (>= 1.0.2), RMySQL (>= 0.10.11),    |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| RPostgreSQL (>= 0.4.1), RSQLite (>= 2.0), testthat (>= 2.0.0),  |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| withr                                                           | nil                                                        |                                            MIT + file LICENSE | nil            | nil                                                          | nil                                                            | nil               | no                                                            | 3.5.1                                                    |                             |                 |                       |         |        |                  |       |       |       |
| desc                                                            | /usr/lib/R/site-library                                    |                                                         1.2.0 | nil            | R (>= 3.1.0)                                                 | assertthat, utils, R6, crayon, rprojroot                       | nil               | covr, testthat, whoami, withr                                 | nil                                                      | MIT + file LICENSE          | nil             | nil                   | nil     | nil    | no               | 3.5.0 |       |       |
| dichromat                                                       | /usr/lib/R/site-library                                    |                                                         2.0-0 | nil            | R (>= 2.10), stats                                           | nil                                                            | nil               | nil                                                           | nil                                                      | GPL-2                       | nil             | nil                   | nil     | nil    | nil              | 3.5.0 |       |       |
| digest                                                          | /usr/lib/R/site-library                                    |                                                        0.6.15 | nil            | R (>= 2.4.1)                                                 | nil                                                            | nil               | knitr, rmarkdown                                              | nil                                                      | GPL (>= 2)                  | nil             | nil                   | nil     | nil    | yes              | 3.5.0 |       |       |
| dplyr                                                           | /usr/lib/R/site-library                                    |                                                         0.7.6 | nil            | R (>= 3.1.2)                                                 | assertthat (>= 0.2.0), bindrcpp (>= 0.2.0.9000), glue (>=      |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| 1.1.1), magrittr (>= 1.5), methods, pkgconfig (>= 2.0.1), R6    |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| (>= 2.2.2), Rcpp (>= 0.12.15), rlang (>= 0.2.0), tibble (>=     |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| 1.3.1), tidyselect (>= 0.2.3), utils                            | BH (>= 1.58.0-1), bindrcpp (>= 0.2.0.9000), plogr (>=      |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| 0.1.10), Rcpp (>= 0.12.15)                                      | bit64 (>= 0.9.7), callr, covr (>= 3.0.1), DBI (>= 0.7.14), |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| dbplyr (>= 1.2.0), dtplyr (>= 0.0.2), ggplot2 (>= 2.2.1), hms   |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| (>= 0.4.1), knitr (>= 1.19), Lahman (>= 3.0-1), lubridate,      |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| MASS, mgcv (>= 1.8.23), microbenchmark (>= 1.4.4), nycflights13 |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| (>= 0.2.2), rmarkdown (>= 1.8), RMySQL (>= 0.10.13),            |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| RPostgreSQL (>= 0.6.2), RSQLite (>= 2.0), testthat (>= 2.0.0),  |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| withr (>= 2.1.1)                                                | nil                                                        |                                            MIT + file LICENSE | nil            | nil                                                          | nil                                                            | nil               | yes                                                           | 3.5.1                                                    |                             |                 |                       |         |        |                  |       |       |       |
| evaluate                                                        | /usr/lib/R/site-library                                    |                                                        0.10.1 | nil            | R (>= 3.0.2)                                                 | methods, stringr (>= 0.6.2)                                    | nil               | testthat, lattice, ggplot2                                    | nil                                                      | MIT + file LICENSE          | nil             | nil                   | nil     | nil    | no               | 3.5.0 |       |       |
| expm                                                            | /usr/lib/R/site-library                                    |                                                       0.999-3 | nil            | Matrix                                                       | methods                                                        | nil               | RColorBrewer, sfsmisc, Rmpfr                                  | nil                                                      | GPL (>= 2)                  | nil             | nil                   | nil     | nil    | yes              | 3.5.1 |       |       |
| filehash                                                        | /usr/lib/R/site-library                                    |                                                         2.4-1 | nil            | R (>= 3.0.0), methods                                        | nil                                                            | nil               | nil                                                           | nil                                                      | GPL (>= 2)                  | nil             | nil                   | nil     | nil    | yes              | 3.5.0 |       |       |
| forcats                                                         | /usr/lib/R/site-library                                    |                                                         0.3.0 | nil            | R (>= 3.1)                                                   | magrittr, rlang, tibble                                        | nil               | covr, ggplot2, testthat                                       | nil                                                      | GPL-3                       | nil             | nil                   | nil     | nil    | no               | 3.5.0 |       |       |
| fs                                                              | /usr/lib/R/site-library                                    |                                                         1.2.6 | nil            | R (>= 3.1)                                                   | methods, Rcpp                                                  | Rcpp              | testthat, covr, pillar (>= 1.0.0), crayon, withr              | nil                                                      | GPL-3                       | nil             | nil                   | nil     | nil    | yes              | 3.5.1 |       |       |
| gdata                                                           | /usr/lib/R/site-library                                    |                                                        2.18.0 | nil            | R (>= 2.3.0)                                                 | gtools, stats, methods, utils                                  | nil               | RUnit                                                         | nil                                                      | GPL-2                       | nil             | nil                   | nil     | nil    | no               | 3.5.0 |       |       |
| ggplot2                                                         | /usr/lib/R/site-library                                    |                                                         3.1.0 | nil            | R (>= 3.1)                                                   | digest, grid, gtable (>= 0.1.1), lazyeval, MASS, mgcv, plyr    |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| (>= 1.7.1), reshape2, rlang (>= 0.2.1), scales (>= 0.5.0),      |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| stats, tibble, viridisLite, withr (>= 2.0.0)                    | nil                                                        |  covr, dplyr, ggplot2movies, hexbin, Hmisc, lattice, mapproj, |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| maps, maptools, multcomp, munsell, nlme, testthat (>= 0.11.0),  |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| vdiffr, quantreg, knitr, rgeos, rpart, rmarkdown, sf (>=        |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| 0.3-4), svglite (>= 1.2.0.9001)                                 | sp                                                         |                                                         GPL-2 | file LICENSE   | nil                                                          | nil                                                            | nil               | nil                                                           | no                                                       | 3.5.1                       |                 |                       |         |        |                  |       |       |       |
| glue                                                            | /usr/lib/R/site-library                                    |                                                         1.2.0 | nil            | R (>= 3.1)                                                   | methods                                                        | nil               | testthat, covr, magrittr, crayon, knitr, rmarkdown, DBI,      |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| RSQLite, R.utils, forcats, microbenchmark, rprintf, stringr,    |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| ggplot2                                                         | nil                                                        |                                            MIT + file LICENSE | nil            | nil                                                          | nil                                                            | nil               | yes                                                           | 3.5.0                                                    |                             |                 |                       |         |        |                  |       |       |       |
| gmodels                                                         | /usr/lib/R/site-library                                    |                                                        2.18.1 | nil            | R (>= 1.9.0)                                                 | MASS, gdata                                                    | nil               | gplots, gtools, Matrix, nlme, lme4 (>= 0.999999-0)            | nil                                                      | GPL-2                       | nil             | nil                   | nil     | nil    | no               | 3.5.1 |       |       |
| gplots                                                          | /usr/lib/R/site-library                                    |                                                         3.0.1 | nil            | R (>= 3.0)                                                   | gtools, gdata, stats, caTools, KernSmooth                      | nil               | grid, MASS                                                    | nil                                                      | GPL-2                       | nil             | nil                   | nil     | nil    | no               | 3.5.0 |       |       |
| gridExtra                                                       | /usr/lib/R/site-library                                    |                                                           2.3 | nil            | nil                                                          | gtable, grid, grDevices, graphics, utils                       | nil               | ggplot2, egg, lattice, knitr, testthat                        | nil                                                      | GPL (>= 2)                  | nil             | nil                   | nil     | nil    | no               | 3.5.0 |       |       |
| gtable                                                          | /usr/lib/R/site-library                                    |                                                         0.2.0 | nil            | R (>= 2.14)                                                  | grid                                                           | nil               | testthat, covr                                                | nil                                                      | GPL-2                       | nil             | nil                   | nil     | nil    | no               | 3.5.0 |       |       |
| gtools                                                          | /usr/lib/R/site-library                                    |                                                         3.8.1 | nil            | methods, stats, utils                                        | nil                                                            | nil               | nil                                                           | nil                                                      | GPL-2                       | nil             | nil                   | nil     | nil    | yes              | 3.5.0 |       |       |
| haven                                                           | /usr/lib/R/site-library                                    |                                                         1.1.2 | nil            | R (>= 3.1)                                                   | forcats (>= 0.2.0), hms, Rcpp (>= 0.11.4), readr (>= 0.1.0),   |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| tibble                                                          | Rcpp                                                       |                          covr, fs, knitr, rmarkdown, testthat | nil            | MIT + file LICENSE                                           | nil                                                            | nil               | nil                                                           | nil                                                      | yes                         | 3.5.1           |                       |         |        |                  |       |       |       |
| highr                                                           | /usr/lib/R/site-library                                    |                                                           0.7 | nil            | R (>= 3.0.2)                                                 | nil                                                            | nil               | knitr, testit                                                 | nil                                                      | GPL                         | nil             | nil                   | nil     | nil    | no               | 3.5.0 |       |       |
| hms                                                             | /usr/lib/R/site-library                                    |                                                         0.4.2 | nil            | nil                                                          | methods, pkgconfig, rlang                                      | nil               | crayon, lubridate, pillar (>= 1.1.0), testthat                | nil                                                      | GPL-3                       | nil             | nil                   | nil     | nil    | no               | 3.5.0 |       |       |
| htmltools                                                       | /usr/lib/R/site-library                                    |                                                         0.3.6 | nil            | R (>= 2.14.1)                                                | utils, digest, Rcpp                                            | Rcpp              | markdown, testthat                                            | knitr                                                    | GPL (>= 2)                  | nil             | nil                   | nil     | nil    | yes              | 3.5.0 |       |       |
| httpuv                                                          | /usr/lib/R/site-library                                    |                                                         1.4.5 | nil            | R (>= 2.15.1), methods                                       | Rcpp (>= 0.11.0), utils, promises, later (>= 0.7.3)            | Rcpp, BH, later   | testthat, callr                                               | nil                                                      | GPL (>= 2)                  | file LICENSE    | nil                   | nil     | nil    | nil              |   yes | 3.5.1 |       |
| httr                                                            | /usr/lib/R/site-library                                    |                                                         1.3.1 | nil            | R (>= 3.0.0)                                                 | jsonlite, mime, curl (>= 0.9.1), openssl (>= 0.8), R6          | nil               | httpuv, jpeg, knitr, png, testthat (>= 0.8.0), readr, xml2,   |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| rmarkdown, covr                                                 | nil                                                        |                                            MIT + file LICENSE | nil            | nil                                                          | nil                                                            | nil               | no                                                            | 3.5.0                                                    |                             |                 |                       |         |        |                  |       |       |       |
| inline                                                          | /usr/lib/R/site-library                                    |                                                        0.3.15 | nil            | R (>= 2.4.0)                                                 | methods                                                        | nil               | Rcpp (>= 0.11.0)                                              | nil                                                      | LGPL                        | nil             | nil                   | nil     | nil    | no               | 3.5.0 |       |       |
| jsonlite                                                        | /usr/lib/R/site-library                                    |                                                           1.5 | nil            | methods                                                      | nil                                                            | nil               | httr, curl, plyr, testthat, knitr, rmarkdown, R.rsp, sp       | nil                                                      | MIT + file LICENSE          | nil             | nil                   | nil     | nil    | yes              | 3.5.0 |       |       |
| knitr                                                           | /usr/lib/R/site-library                                    |                                                           1.2 | nil            | R (>= 3.1.0)                                                 | evaluate (>= 0.10), highr, markdown, stringr (>= 0.6), yaml,   |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| methods, tools                                                  | nil                                                        |       formatR, testit, digest, rgl (>= 0.95.1201), codetools, |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| rmarkdown, htmlwidgets (>= 0.7), webshot, tikzDevice (>= 0.10), |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| tinytex, xfun, reticulate (>= 1.4), JuliaCall (>= 0.11.1), png, |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| jpeg, xml2, httr, DBI (>= 0.4-1), showtext, tibble              | nil                                                        |                                                           GPL | nil            | nil                                                          | nil                                                            | nil               | no                                                            | 3.5.0                                                    |                             |                 |                       |         |        |                  |       |       |       |
| labeling                                                        | /usr/lib/R/site-library                                    |                                                           0.3 | nil            | nil                                                          | nil                                                            | nil               | nil                                                           | nil                                                      | MIT + file LICENSE          | Unlimited       | nil                   | nil     | nil    | nil              |    no | 3.5.0 |       |
| later                                                           | /usr/lib/R/site-library                                    |                                                         0.7.5 | nil            | nil                                                          | Rcpp (>= 0.12.9), rlang                                        | Rcpp, BH          | knitr, rmarkdown, testthat                                    | nil                                                      | GPL (>= 2)                  | nil             | nil                   | nil     | nil    | yes              | 3.5.1 |       |       |
| lazyeval                                                        | /usr/lib/R/site-library                                    |                                                         0.2.1 | nil            | R (>= 3.1.0)                                                 | nil                                                            | nil               | knitr, rmarkdown (>= 0.2.65), testthat, covr                  | nil                                                      | GPL-3                       | nil             | nil                   | nil     | nil    | yes              | 3.5.0 |       |       |
| littler                                                         | /usr/lib/R/site-library                                    |                                                         0.3.3 | nil            | nil                                                          | nil                                                            | nil               | knitr, docopt, rcmdcheck                                      | nil                                                      | GPL (>= 2)                  | nil             | nil                   | unix    | nil    | yes              | 3.4.3 |       |       |
| lme4                                                            | /usr/lib/R/site-library                                    |                                                      1.1-18-1 | nil            | R (>= 3.2.0), Matrix (>= 1.2-1), methods, stats              | graphics, grid, splines, utils, parallel, MASS, lattice, nlme  |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| (>= 3.1-123), minqa (>= 1.1.15), nloptr (>= 1.0.4)              | Rcpp (>= 0.10.5), RcppEigen                                | knitr, boot, PKPDmodels, MEMSS, testthat (>= 0.8.1), ggplot2, |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| mlmRev, optimx (>= 2013.8.6), gamm4, pbkrtest, HSAUR2, numDeriv | nil                                                        |                                                    GPL (>= 2) | nil            | nil                                                          | nil                                                            | nil               | yes                                                           | 3.5.1                                                    |                             |                 |                       |         |        |                  |       |       |       |
| loo                                                             | /usr/lib/R/site-library                                    |                                                         2.0.0 | nil            | R (>= 3.1.2)                                                 | graphics, matrixStats (>= 0.52), parallel, stats               | nil               | bayesplot (>= 1.5.0), knitr, rmarkdown, rstan, rstanarm,      |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| rstantools, testthat                                            | nil                                                        |                                                    GPL (>= 3) | nil            | nil                                                          | nil                                                            | nil               | no                                                            | 3.5.0                                                    |                             |                 |                       |         |        |                  |       |       |       |
| lubridate                                                       | /usr/lib/R/site-library                                    |                                                         1.7.4 | nil            | methods, R (>= 3.0.0)                                        | stringr, Rcpp (>= 0.12.13),                                    | Rcpp,             | testthat, knitr, covr                                         | chron, fts, timeSeries, timeDate, tis, tseries, xts, zoo | GPL (>= 2)                  | nil             | nil                   | nil     | nil    | yes              | 3.5.1 |       |       |
| magrittr                                                        | /usr/lib/R/site-library                                    |                                                           1.5 | nil            | nil                                                          | nil                                                            | nil               | testthat, knitr                                               | nil                                                      | MIT + file LICENSE          | nil             | nil                   | nil     | nil    | no               | 3.5.0 |       |       |
| maptools                                                        | /usr/lib/R/site-library                                    |                                                         0.9-4 | nil            | R (>= 2.10), sp (>= 1.0-11)                                  | foreign (>= 0.8), methods, grid, lattice, stats, utils,        |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| grDevices                                                       | nil                                                        |       rgeos (>= 0.1-8), spatstat (>= 1.50), PBSmapping, maps, |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| RColorBrewer, raster, polyclip, spatstat.utils                  | gpclib, RArcInfo                                           |                                                    GPL (>= 2) | nil            | nil                                                          | nil                                                            | nil               | yes                                                           | 3.5.1                                                    |                             |                 |                       |         |        |                  |       |       |       |
| markdown                                                        | /usr/lib/R/site-library                                    |                                                           0.8 | nil            | R (>= 2.11.1)                                                | utils, mime (>= 0.3)                                           | nil               | knitr, RCurl                                                  | nil                                                      | GPL-2                       | nil             | nil                   | nil     | nil    | yes              | 3.5.0 |       |       |
| matrixStats                                                     | /usr/lib/R/site-library                                    |                                                        0.54.0 | nil            | R (>= 2.12.0)                                                | nil                                                            | nil               | base64enc, ggplot2, knitr, microbenchmark, R.devices, R.rsp   | nil                                                      | Artistic-2.0                | nil             | nil                   | nil     | nil    | yes              | 3.5.1 |       |       |
| mclust                                                          | /usr/lib/R/site-library                                    |                                                         5.4.1 | nil            | R (>= 3.0)                                                   | stats, utils, graphics, grDevices                              | nil               | knitr (>= 1.12), rmarkdown (>= 0.9), mix (>= 1.0), geometry   |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| (>= 0.3-6), MASS                                                | nil                                                        |                                                    GPL (>= 2) | nil            | nil                                                          | nil                                                            | nil               | yes                                                           | 3.5.1                                                    |                             |                 |                       |         |        |                  |       |       |       |
| mime                                                            | /usr/lib/R/site-library                                    |                                                           0.5 | nil            | nil                                                          | tools                                                          | nil               | nil                                                           | nil                                                      | GPL                         | nil             | nil                   | nil     | nil    | yes              | 3.5.0 |       |       |
| minqa                                                           | /usr/lib/R/site-library                                    |                                                         1.2.4 | nil            | nil                                                          | Rcpp (>= 0.9.10)                                               | Rcpp              | nil                                                           | nil                                                      | GPL-2                       | nil             | nil                   | nil     | nil    | yes              | 3.5.1 |       |       |
| modelr                                                          | /usr/lib/R/site-library                                    |                                                         0.1.2 | nil            | R (>= 3.1)                                                   | broom, dplyr, magrittr, purrr (>= 0.2.2), tibble, tidyr (>=    |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| 0.8.0), rlang (>= 0.2.0)                                        | nil                                                        |                             compiler, covr, ggplot2, testthat | nil            | GPL-3                                                        | nil                                                            | nil               | nil                                                           | nil                                                      | no                          | 3.5.1           |                       |         |        |                  |       |       |       |
| munsell                                                         | /usr/lib/R/site-library                                    |                                                         0.5.0 | nil            | nil                                                          | colorspace, methods                                            | nil               | ggplot2, testthat                                             | nil                                                      | MIT + file LICENSE          | nil             | nil                   | nil     | nil    | no               | 3.5.0 |       |       |
| nloptr                                                          | /usr/lib/R/site-library                                    |                                                         1.2.1 | nil            | nil                                                          | nil                                                            | nil               | testthat (>= 0.8.1), knitr, rmarkdown, inline (>= 0.3.14)     | nil                                                      | LGPL-3                      | nil             | nil                   | nil     | nil    | yes              | 3.5.1 |       |       |
| openssl                                                         | /usr/lib/R/site-library                                    |                                                           1.1 | nil            | nil                                                          | nil                                                            | nil               | testthat, digest, knitr, rmarkdown, jsonlite, jose            | nil                                                      | MIT + file LICENSE          | nil             | nil                   | nil     | nil    | yes              | 3.5.1 |       |       |
| openxlsx                                                        | /usr/lib/R/site-library                                    |                                                         4.1.0 | nil            | R (>= 3.3.0)                                                 | methods, Rcpp, grDevices, stats, utils, zip                    | Rcpp              | knitr, testthat                                               | nil                                                      | MIT + file LICENSE          | nil             | nil                   | nil     | nil    | yes              | 3.5.1 |       |       |
| pbkrtest                                                        | /usr/lib/R/site-library                                    |                                                         0.4-7 | nil            | R (>= 3.2.3), lme4 (>= 1.1-10)                               | Matrix (>= 1.2-3), parallel, MASS, methods                     | nil               | nil                                                           | nil                                                      | GPL (>= 2)                  | nil             | nil                   | nil     | nil    | no               | 3.5.0 |       |       |
| pillar                                                          | /usr/lib/R/site-library                                    |                                                         1.2.3 | nil            | nil                                                          | cli (>= 1.0.0), crayon (>= 1.3.4), methods, rlang (>= 0.2.0),  |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| utf8 (>= 1.1.3)                                                 | nil                                                        |        knitr (>= 1.19), lubridate, testthat (>= 2.0.0), withr | nil            | GPL-3                                                        | nil                                                            | nil               | nil                                                           | nil                                                      | no                          | 3.5.0           |                       |         |        |                  |       |       |       |
| pkgKitten                                                       | /usr/lib/R/site-library                                    |                                                         0.1.4 | nil            | nil                                                          | nil                                                            | nil               | whoami (>= 1.1.0)                                             | nil                                                      | GPL (>= 2)                  | nil             | nil                   | nil     | nil    | no               | 3.5.0 |       |       |
| pkgbuild                                                        | /usr/lib/R/site-library                                    |                                                         1.0.2 | nil            | R (>= 3.1)                                                   | callr (>= 2.0.0), cli, crayon, desc, prettyunits, R6,          |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| rprojroot, withr (>= 2.1.2)                                     | nil                                                        |                                          Rcpp, testthat, covr | nil            | GPL-3                                                        | nil                                                            | nil               | nil                                                           | nil                                                      | no                          | 3.5.1           |                       |         |        |                  |       |       |       |
| pkgconfig                                                       | /usr/lib/R/site-library                                    |                                                         2.0.1 | nil            | nil                                                          | utils                                                          | nil               | covr, testthat, disposables (>= 1.0.3)                        | nil                                                      | MIT + file LICENSE          | nil             | nil                   | nil     | nil    | no               | 3.5.0 |       |       |
| plyr                                                            | /usr/lib/R/site-library                                    |                                                         1.8.4 | nil            | R (>= 3.1.0)                                                 | Rcpp (>= 0.11.0)                                               | Rcpp              | abind, testthat, tcltk, foreach, doParallel, itertools,       |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| iterators, covr                                                 | nil                                                        |                                            MIT + file LICENSE | nil            | nil                                                          | nil                                                            | nil               | yes                                                           | 3.5.0                                                    |                             |                 |                       |         |        |                  |       |       |       |
| png                                                             | /usr/lib/R/site-library                                    |                                                         0.1-7 | nil            | R (>= 2.9.0)                                                 | nil                                                            | nil               | nil                                                           | nil                                                      | GPL-2                       | GPL-3           | nil                   | nil     | nil    | nil              |   yes | 3.5.0 |       |
| praise                                                          | /usr/lib/R/site-library                                    |                                                         1.0.0 | nil            | nil                                                          | nil                                                            | nil               | testthat                                                      | nil                                                      | MIT + file LICENSE          | nil             | nil                   | nil     | nil    | no               | 3.5.0 |       |       |
| prettyunits                                                     | /usr/lib/R/site-library                                    |                                                         1.0.2 | nil            | nil                                                          | magrittr, assertthat, methods                                  | nil               | testthat                                                      | nil                                                      | MIT + file LICENSE          | nil             | nil                   | nil     | nil    | no               | 3.5.0 |       |       |
| processx                                                        | /usr/lib/R/site-library                                    |                                                         3.2.0 | nil            | nil                                                          | assertthat, crayon, ps, R6, utils                              | nil               | callr, covr, debugme, parallel, testthat, withr               | nil                                                      | MIT + file LICENSE          | nil             | nil                   | nil     | nil    | yes              | 3.5.1 |       |       |
| promises                                                        | /usr/lib/R/site-library                                    |                                                         1.0.1 | nil            | nil                                                          | R6, Rcpp, later, rlang, stats, magrittr                        | later, Rcpp       | testthat, future, knitr, rmarkdown                            | nil                                                      | MIT + file LICENSE          | nil             | nil                   | nil     | nil    | yes              | 3.5.0 |       |       |
| ps                                                              | /usr/lib/R/site-library                                    |                                                         1.2.1 | nil            | R (>= 3.1)                                                   | utils                                                          | nil               | callr, covr, curl, pingr, processx (>= 3.1.0), R6, rlang,     |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| testthat, tibble                                                | nil                                                        |                                   BSD_3_clause + file LICENSE | nil            | nil                                                          | nil                                                            | nil               | yes                                                           | 3.5.1                                                    |                             |                 |                       |         |        |                  |       |       |       |
| purrr                                                           | /usr/lib/R/site-library                                    |                                                         0.2.5 | nil            | R (>= 3.1)                                                   | magrittr (>= 1.5), rlang (>= 0.1), tibble                      | nil               | covr, dplyr (>= 0.7.5), knitr, rmarkdown, testthat            | nil                                                      | GPL-3                       | file LICENSE    | nil                   | nil     | nil    | nil              |   yes | 3.5.0 |       |
| quantreg                                                        | /usr/lib/R/site-library                                    |                                                          5.36 | nil            | R (>= 2.6), stats, SparseM                                   | methods, graphics, Matrix, MatrixModels                        | nil               | tripack, akima, MASS, survival, rgl, logspline, nor1mix,      |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| Formula, zoo                                                    | nil                                                        |                                                    GPL (>= 2) | nil            | nil                                                          | nil                                                            | nil               | yes                                                           | 3.5.1                                                    |                             |                 |                       |         |        |                  |       |       |       |
| readr                                                           | /usr/lib/R/site-library                                    |                                                         1.1.1 | nil            | R (>= 3.0.2)                                                 | Rcpp (>= 0.12.0.5), tibble, hms, R6                            | Rcpp              | curl, testthat, knitr, rmarkdown, stringi, covr               | nil                                                      | GPL (>= 2)                  | file LICENSE    | nil                   | nil     | nil    | nil              |   yes | 3.5.0 |       |
| readxl                                                          | /usr/lib/R/site-library                                    |                                                         1.1.0 | nil            | nil                                                          | cellranger, Rcpp (>= 0.12.12), tibble (>= 1.1)                 | Rcpp              | covr, knitr, rmarkdown, rprojroot (>= 1.1), testthat          | nil                                                      | GPL-3                       | nil             | nil                   | nil     | nil    | yes              | 3.5.0 |       |       |
| rematch                                                         | /usr/lib/R/site-library                                    |                                                         1.0.1 | nil            | nil                                                          | nil                                                            | nil               | covr, testthat                                                | nil                                                      | MIT + file LICENSE          | nil             | nil                   | nil     | nil    | no               | 3.5.0 |       |       |
| repr                                                            | /usr/lib/R/site-library                                    |                                                        0.15.0 | nil            | R (>= 3.0.1)                                                 | utils, grDevices, htmltools, base64enc                         | nil               | methods, highr, Cairo, stringr, testthat                      | data.table, dplyr, htmlwidgets                           | GPL-3                       | nil             | nil                   | nil     | nil    | no               | 3.5.0 |       |       |
| reprex                                                          | /usr/lib/R/site-library                                    |                                                         0.2.1 | nil            | R (>= 3.1)                                                   | callr (>= 2.0.0), clipr (>= 0.4.0), fs, rlang, rmarkdown,      |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| tools, utils, whisker, withr                                    | nil                                                        |           covr, devtools, fortunes, knitr, miniUI, rprojroot, |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| rstudioapi, shiny, styler (>= 1.0.2), testthat (>= 2.0.0)       | nil                                                        |                                            MIT + file LICENSE | nil            | nil                                                          | nil                                                            | nil               | no                                                            | 3.5.1                                                    |                             |                 |                       |         |        |                  |       |       |       |
| reshape2                                                        | /usr/lib/R/site-library                                    |                                                         1.4.3 | nil            | R (>= 3.1)                                                   | plyr (>= 1.8.1), Rcpp, stringr                                 | Rcpp              | covr, lattice, testthat (>= 0.8.0)                            | nil                                                      | MIT + file LICENSE          | nil             | nil                   | nil     | nil    | yes              | 3.5.0 |       |       |
| rio                                                             | /usr/lib/R/site-library                                    |                                                        0.5.10 | nil            | R (>= 2.15.0)                                                | tools, stats, utils, foreign, haven (>= 1.1.0), curl (>= 0.6), |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| data.table (>= 1.9.8), readxl (>= 0.1.1), openxlsx, tibble      | nil                                                        |      datasets, bit64, testthat, knitr, magrittr, clipr, csvy, |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| feather, fst, jsonlite, readODS (>= 1.6.4), readr, rmatio, xml2 |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| (>= 1.2.0), yaml                                                | nil                                                        |                                                         GPL-2 | nil            | nil                                                          | nil                                                            | nil               | no                                                            | 3.5.0                                                    |                             |                 |                       |         |        |                  |       |       |       |
| rlang                                                           | /usr/lib/R/site-library                                    |                                                         0.2.1 | nil            | R (>= 3.1.0)                                                 | nil                                                            | nil               | crayon, knitr, methods, pillar, rmarkdown (>= 0.2.65),        |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| testthat, covr                                                  | nil                                                        |                                                         GPL-3 | nil            | nil                                                          | nil                                                            | nil               | yes                                                           | 3.5.0                                                    |                             |                 |                       |         |        |                  |       |       |       |
| rmarkdown                                                       | /usr/lib/R/site-library                                    |                                                           1.1 | nil            | R (>= 3.0)                                                   | tools, utils, knitr (>= 1.18), yaml (>= 2.1.5), htmltools (>=  |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| 0.3.5), evaluate (>= 0.8), base64enc, jsonlite, rprojroot,      |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| mime, tinytex (>= 0.3), methods, stringr (>= 1.2.0)             | nil                                                        |    shiny (>= 0.11), tufte, testthat, digest, dygraphs, tibble | nil            | GPL-3                                                        | nil                                                            | nil               | nil                                                           | nil                                                      | no                          | 3.5.1           |                       |         |        |                  |       |       |       |
| rprojroot                                                       | /usr/lib/R/site-library                                    |                                                         1.3-2 | nil            | R (>= 3.0.0)                                                 | backports                                                      | nil               | testthat, mockr, knitr, withr, rmarkdown                      | nil                                                      | GPL-3                       | nil             | nil                   | nil     | nil    | no               | 3.5.0 |       |       |
| rstan                                                           | /usr/lib/R/site-library                                    |                                                        2.18.1 | nil            | R (>= 3.4.0), ggplot2 (>= 2.0.0), StanHeaders (>= 2.18.0)    | methods, stats4, inline, gridExtra (>= 2.0.0), Rcpp (>=        |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| 0.12.0), loo (>= 2.0.0), pkgbuild                               | Rcpp (>= 0.12.0), RcppEigen (>= 0.3.3.3.0),                |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| StanHeaders (>= 2.18.0)                                         | RUnit, RcppEigen (>= 0.3.3.3.0), BH (>= 1.66), parallel,   |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| KernSmooth, shinystan (>= 2.3.0), bayesplot (>= 1.5.0),         |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| rmarkdown, rstantools, rstudioapi, Matrix, knitr (>= 1.15.1)    | nil                                                        |                                                    GPL (>= 3) | nil            | nil                                                          | nil                                                            | nil               | yes                                                           | 3.5.1                                                    |                             |                 |                       |         |        |                  |       |       |       |
| rstantools                                                      | /usr/lib/R/site-library                                    |                                                         1.5.1 | nil            | nil                                                          | stats, utils                                                   | nil               | bayesplot (>= 1.5.0), rstan (>= 2.17.2), rstanarm (>=         |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| 2.17.4), shinystan (>= 2.4.0), loo (>= 2.0.0), testthat, covr,  |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| knitr, devtools, roxygen2 (>= 6.0.1), rmarkdown, rstudioapi,    |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| usethis (>= 1.3.0)                                              | nil                                                        |                                                    GPL (>= 3) | nil            | nil                                                          | nil                                                            | nil               | no                                                            | 3.5.1                                                    |                             |                 |                       |         |        |                  |       |       |       |
| rstudioapi                                                      | /usr/lib/R/site-library                                    |                                                           0.8 | nil            | nil                                                          | nil                                                            | nil               | testthat, knitr, rmarkdown                                    | nil                                                      | MIT + file LICENSE          | nil             | nil                   | nil     | nil    | no               | 3.5.1 |       |       |
| rvest                                                           | /usr/lib/R/site-library                                    |                                                         0.3.2 | nil            | R (>= 3.0.1), xml2                                           | httr (>= 0.5), selectr, magrittr                               | nil               | testthat, knitr, png, stringi (>= 0.3.1), rmarkdown, covr     | nil                                                      | GPL-3                       | nil             | nil                   | nil     | nil    | no               | 3.5.1 |       |       |
| scales                                                          | /usr/lib/R/site-library                                    |                                                         0.5.0 | nil            | R (>= 2.13)                                                  | RColorBrewer, dichromat, plyr, munsell (>= 0.2), labeling,     |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| Rcpp, R6, viridisLite                                           | Rcpp                                                       |                           testthat (>= 0.8), bit64, covr, hms | nil            | MIT + file LICENSE                                           | nil                                                            | nil               | nil                                                           | nil                                                      | yes                         | 3.5.0           |                       |         |        |                  |       |       |       |
| selectr                                                         | /usr/lib/R/site-library                                    |                                                         0.4-1 | nil            | R (>= 3.0)                                                   | methods, stringr, R6                                           | nil               | testthat, XML, xml2                                           | nil                                                      | BSD_3_clause + file LICENCE | nil             | nil                   | nil     | nil    | no               | 3.5.1 |       |       |
| sendmailR                                                       | /usr/lib/R/site-library                                    |                                                         1.2-1 | nil            | R (>= 3.0.0)                                                 | base64enc                                                      | nil               | nil                                                           | nil                                                      | GPL-2                       | nil             | nil                   | nil     | nil    | no               | 3.5.0 |       |       |
| shiny                                                           | /usr/lib/R/site-library                                    |                                                         1.2.0 | nil            | R (>= 3.0.2), methods                                        | utils, grDevices, httpuv (>= 1.4.4), mime (>= 0.3), jsonlite   |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| (>= 0.9.16), xtable, digest, htmltools (>= 0.3.5), R6 (>= 2.0), |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| sourcetools, later (>= 0.7.2), promises (>= 1.0.1), tools,      |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| crayon, rlang                                                   | nil                                                        |         datasets, Cairo (>= 1.5-5), testthat, knitr (>= 1.6), |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| markdown, rmarkdown, ggplot2, magrittr                          | nil                                                        |                                                         GPL-3 | file LICENSE   | nil                                                          | nil                                                            | nil               | nil                                                           | no                                                       | 3.5.1                       |                 |                       |         |        |                  |       |       |       |
| sourcetools                                                     | /usr/lib/R/site-library                                    |                                                         0.1.7 | nil            | R (>= 3.0.2)                                                 | nil                                                            | nil               | testthat                                                      | nil                                                      | MIT + file LICENSE          | nil             | nil                   | nil     | nil    | yes              | 3.5.0 |       |       |
| sp                                                              | /usr/lib/R/site-library                                    |                                                         1.3-1 | nil            | R (>= 3.0.0), methods                                        | utils, stats, graphics, grDevices, lattice, grid               | nil               | RColorBrewer, rgdal (>= 0.8-7), rgeos (>= 0.3-13), gstat,     |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| maptools, deldir                                                | nil                                                        |                                                    GPL (>= 2) | nil            | nil                                                          | nil                                                            | nil               | yes                                                           | 3.5.0                                                    |                             |                 |                       |         |        |                  |       |       |       |
| stringi                                                         | /usr/lib/R/site-library                                    |                                                         1.2.3 | nil            | R (>= 2.14)                                                  | tools, utils, stats                                            | nil               | nil                                                           | nil                                                      | file LICENSE                | yes             | nil                   | nil     | nil    | yes              | 3.5.0 |       |       |
| stringr                                                         | /usr/lib/R/site-library                                    |                                                         1.3.1 | nil            | R (>= 3.1)                                                   | glue (>= 1.2.0), magrittr, stringi (>= 1.1.7)                  | nil               | covr, htmltools, htmlwidgets, knitr, rmarkdown, testthat      | nil                                                      | GPL-2                       | file LICENSE    | nil                   | nil     | nil    | nil              |    no | 3.5.0 |       |
| testit                                                          | /usr/lib/R/site-library                                    |                                                           0.8 | nil            | nil                                                          | nil                                                            | nil               | rstudioapi                                                    | nil                                                      | GPL                         | nil             | nil                   | nil     | nil    | no               | 3.5.0 |       |       |
| testthat                                                        | /usr/lib/R/site-library                                    |                                                         2.0.0 | nil            | R (>= 3.1)                                                   | cli, crayon, digest, magrittr, methods, praise, R6 (>= 2.2.0), |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| rlang, withr (>= 2.0.0)                                         | nil                                                        |                        covr, devtools, knitr, rmarkdown, xml2 | nil            | MIT + file LICENSE                                           | nil                                                            | nil               | nil                                                           | nil                                                      | yes                         | 3.5.0           |                       |         |        |                  |       |       |       |
| tibble                                                          | /usr/lib/R/site-library                                    |                                                         1.4.2 | nil            | R (>= 3.1.0)                                                 | cli, crayon, methods, pillar (>= 1.1.0), rlang, utils          | nil               | covr, dplyr, import, knitr (>= 1.5.32), microbenchmark,       |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| mockr, nycflights13, rmarkdown, testthat, withr                 | nil                                                        |                                            MIT + file LICENSE | nil            | nil                                                          | nil                                                            | nil               | yes                                                           | 3.5.0                                                    |                             |                 |                       |         |        |                  |       |       |       |
| tidyr                                                           | /usr/lib/R/site-library                                    |                                                         0.8.1 | nil            | R (>= 3.1)                                                   | dplyr (>= 0.7.0), glue, magrittr, purrr, Rcpp, rlang, stringi, |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| tibble, tidyselect                                              | Rcpp                                                       |                   covr, gapminder, knitr, rmarkdown, testthat | nil            | MIT + file LICENSE                                           | nil                                                            | nil               | nil                                                           | nil                                                      | yes                         | 3.5.0           |                       |         |        |                  |       |       |       |
| tidyselect                                                      | /usr/lib/R/site-library                                    |                                                         0.2.4 | nil            | R (>= 3.1)                                                   | glue, purrr, rlang (>= 0.2.0), Rcpp (>= 0.12.0)                | Rcpp (>= 0.12.0), | covr, dplyr, testthat                                         | nil                                                      | GPL-3                       | nil             | nil                   | nil     | nil    | yes              | 3.5.0 |       |       |
| tidyverse                                                       | /usr/lib/R/site-library                                    |                                                         1.2.1 | nil            | nil                                                          | broom (>= 0.4.2), cli (>= 1.0.0), crayon (>= 1.3.4), dplyr (>= |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| 0.7.4), dbplyr (>= 1.1.0), forcats (>= 0.2.0), ggplot2 (>=      |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| 2.2.1), haven (>= 1.1.0), hms (>= 0.3), httr (>= 1.3.1),        |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| jsonlite (>= 1.5), lubridate (>= 1.7.1), magrittr (>= 1.5),     |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| modelr (>= 0.1.1), purrr (>= 0.2.4), readr (>= 1.1.1), readxl   |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| (>= 1.0.0), reprex (>= 0.1.1), rlang (>= 0.1.4), rstudioapi (>= |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| 0.7), rvest (>= 0.3.2), stringr (>= 1.2.0), tibble (>= 1.3.4),  |                                                            |                                                               |                |                                                              |                                                                |                   |                                                               |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| tidyr (>= 0.7.2), xml2 (>= 1.1.1)                               | nil                                                        |     feather (>= 0.3.1), knitr (>= 1.17), rmarkdown (>= 1.7.4) | nil            | GPL-3                                                        | file LICENSE                                                   | nil               | nil                                                           | nil                                                      | nil                         | no              | 3.5.1                 |         |        |                  |       |       |       |
| tikzDevice                                                      | /usr/lib/R/site-library                                    |                                                          0.12 | nil            | R (>= 2.14.0)                                                | filehash (>= 2.3), png                                         | nil               | evaluate, formatR, ggplot2, knitr, lattice, maps, scales,     |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| stringr, testthat (>= 0.8.1), withr                             | nil                                                        |                                                    GPL (>= 2) | nil            | nil                                                          | nil                                                            | nil               | yes                                                           | 3.5.1                                                    |                             |                 |                       |         |        |                  |       |       |       |
| tinytex                                                         | /usr/lib/R/site-library                                    |                                                           0.5 | nil            | nil                                                          | nil                                                            | nil               | testit                                                        | nil                                                      | MIT + file LICENSE          | nil             | nil                   | nil     | nil    | no               | 3.5.0 |       |       |
| utf8                                                            | /usr/lib/R/site-library                                    |                                                         1.1.4 | nil            | R (>= 2.10)                                                  | nil                                                            | nil               | knitr, rmarkdown, testthat                                    | nil                                                      | Apache License (== 2.0)     | file LICENSE    | nil                   | nil     | nil    | nil              |   yes | 3.5.0 |       |
| viridisLite                                                     | /usr/lib/R/site-library                                    |                                                         0.3.0 | nil            | R (>= 2.10)                                                  | nil                                                            | nil               | hexbin (>= 1.27.0), ggplot2 (>= 1.0.1), testthat, covr        | nil                                                      | MIT + file LICENSE          | nil             | nil                   | nil     | nil    | no               | 3.5.0 |       |       |
| webutils                                                        | /usr/lib/R/site-library                                    |                                                           0.6 | nil            | nil                                                          | curl (>= 2.5), jsonlite                                        | nil               | httpuv, testthat                                              | nil                                                      | MIT + file LICENSE          | nil             | nil                   | nil     | nil    | yes              | 3.5.0 |       |       |
| whisker                                                         | /usr/lib/R/site-library                                    |                                                         0.3-2 | nil            | nil                                                          | nil                                                            | nil               | markdown                                                      | nil                                                      | GPL-3                       | nil             | nil                   | nil     | nil    | no               | 3.5.0 |       |       |
| withr                                                           | /usr/lib/R/site-library                                    |                                                         2.1.2 | nil            | R (>= 3.0.2)                                                 | stats, graphics, grDevices                                     | nil               | testthat, covr, lattice, DBI, RSQLite, methods, knitr,        |                                                          |                             |                 |                       |         |        |                  |       |       |       |
| rmarkdown                                                       | nil                                                        |                                                    GPL (>= 2) | nil            | nil                                                          | nil                                                            | nil               | no                                                            | 3.5.0                                                    |                             |                 |                       |         |        |                  |       |       |       |
| xml2                                                            | /usr/lib/R/site-library                                    |                                                         1.2.0 | nil            | R (>= 3.1.0)                                                 | Rcpp                                                           | Rcpp (>= 0.12.12) | testthat, curl, covr, knitr, rmarkdown, magrittr, httr        | nil                                                      | GPL (>= 2)                  | nil             | nil                   | nil     | nil    | yes              | 3.5.0 |       |       |
| xtable                                                          | /usr/lib/R/site-library                                    |                                                         1.8-3 | nil            | R (>= 2.10.0)                                                | stats, utils                                                   | nil               | knitr, spdep, splm, sphet, plm, zoo, survival                 | nil                                                      | GPL (>= 2)                  | nil             | nil                   | nil     | nil    | no               | 3.5.1 |       |       |
| yaml                                                            | /usr/lib/R/site-library                                    |                                                        2.1.19 | nil            | nil                                                          | nil                                                            | nil               | testthat                                                      | nil                                                      | BSD_3_clause + file LICENSE | nil             | nil                   | nil     | nil    | yes              | 3.5.0 |       |       |
| zip                                                             | /usr/lib/R/site-library                                    |                                                         1.0.0 | nil            | nil                                                          | nil                                                            | nil               | covr, testthat, withr                                         | nil                                                      | CC0                         | nil             | nil                   | nil     | nil    | yes              | 3.5.0 |       |       |
| KernSmooth                                                      | /usr/lib/R/library                                         |                                                       2.23-15 | recommended    | R (>= 2.5.0), stats                                          | nil                                                            | nil               | MASS                                                          | nil                                                      | Unlimited                   | nil             | nil                   | nil     | nil    | yes              | 3.5.0 |       |       |
| MASS                                                            | /usr/lib/R/library                                         |                                                        7.3-50 | recommended    | R (>= 3.1.0), grDevices, graphics, stats, utils              | methods                                                        | nil               | lattice, nlme, nnet, survival                                 | nil                                                      | GPL-2                       | GPL-3           | nil                   | nil     | nil    | nil              |   yes | 3.5.0 |       |
| Matrix                                                          | /usr/lib/R/library                                         |                                                        1.2-14 | recommended    | R (>= 3.2.0)                                                 | methods, graphics, grid, stats, utils, lattice                 | nil               | expm, MASS                                                    | MatrixModels, graph, SparseM, sfsmisc                    | GPL (>= 2)                  | file LICENCE    | nil                   | nil     | nil    | nil              |   yes | 3.4.4 |       |
| base                                                            | /usr/lib/R/library                                         |                                                         3.5.1 | base           | nil                                                          | nil                                                            | nil               | methods                                                       | nil                                                      | Part of R 3.5.1             | nil             | nil                   | nil     | nil    | nil              | 3.5.1 |       |       |
| boot                                                            | /usr/lib/R/library                                         |                                                        1.3-20 | recommended    | R (>= 3.0.0), graphics, stats                                | nil                                                            | nil               | MASS, survival                                                | nil                                                      | Unlimited                   | nil             | nil                   | nil     | nil    | no               | 3.5.0 |       |       |
| class                                                           | /usr/lib/R/library                                         |                                                        7.3-14 | recommended    | R (>= 3.0.0), stats, utils                                   | MASS                                                           | nil               | nil                                                           | nil                                                      | GPL-2                       | GPL-3           | nil                   | nil     | nil    | nil              |   yes | 3.5.0 |       |
| cluster                                                         | /usr/lib/R/library                                         |                                                       2.0.7-1 | recommended    | R (>= 3.2.0)                                                 | graphics, grDevices, stats, utils                              | nil               | MASS, Matrix                                                  | nil                                                      | GPL (>= 2)                  | nil             | nil                   | nil     | nil    | yes              | 3.4.4 |       |       |
| codetools                                                       | /usr/lib/R/library                                         |                                                        0.2-15 | recommended    | R (>= 2.1)                                                   | nil                                                            | nil               | nil                                                           | nil                                                      | GPL                         | nil             | nil                   | nil     | nil    | no               | 3.5.0 |       |       |
| compiler                                                        | /usr/lib/R/library                                         |                                                         3.5.1 | base           | nil                                                          | nil                                                            | nil               | nil                                                           | nil                                                      | Part of R 3.5.1             | nil             | nil                   | nil     | nil    | nil              | 3.5.1 |       |       |
| datasets                                                        | /usr/lib/R/library                                         |                                                         3.5.1 | base           | nil                                                          | nil                                                            | nil               | nil                                                           | nil                                                      | Part of R 3.5.1             | nil             | nil                   | nil     | nil    | nil              | 3.5.1 |       |       |
| foreign                                                         | /usr/lib/R/library                                         |                                                        0.8-70 | recommended    | R (>= 3.0.0)                                                 | methods, utils, stats                                          | nil               | nil                                                           | nil                                                      | GPL (>= 2)                  | nil             | nil                   | nil     | nil    | yes              | 3.4.4 |       |       |
| grDevices                                                       | /usr/lib/R/library                                         |                                                         3.5.1 | base           | nil                                                          | nil                                                            | nil               | KernSmooth                                                    | nil                                                      | Part of R 3.5.1             | nil             | nil                   | nil     | nil    | yes              | 3.5.1 |       |       |
| graphics                                                        | /usr/lib/R/library                                         |                                                         3.5.1 | base           | nil                                                          | grDevices                                                      | nil               | nil                                                           | nil                                                      | Part of R 3.5.1             | nil             | nil                   | nil     | nil    | yes              | 3.5.1 |       |       |
| grid                                                            | /usr/lib/R/library                                         |                                                         3.5.1 | base           | nil                                                          | grDevices, utils                                               | nil               | lattice                                                       | nil                                                      | Part of R 3.5.1             | nil             | nil                   | nil     | nil    | yes              | 3.5.1 |       |       |
| lattice                                                         | /usr/lib/R/library                                         |                                                       0.20-35 | recommended    | R (>= 3.0.0)                                                 | grid, grDevices, graphics, stats, utils                        | nil               | KernSmooth, MASS, latticeExtra                                | chron                                                    | GPL (>= 2)                  | nil             | nil                   | nil     | nil    | yes              | 3.5.0 |       |       |
| methods                                                         | /usr/lib/R/library                                         |                                                         3.5.1 | base           | nil                                                          | utils, stats                                                   | nil               | codetools                                                     | nil                                                      | Part of R 3.5.1             | nil             | nil                   | nil     | nil    | yes              | 3.5.1 |       |       |
| mgcv                                                            | /usr/lib/R/library                                         |                                                        1.8-24 | recommended    | R (>= 2.14.0), nlme (>= 3.1-64)                              | methods, stats, graphics, Matrix                               | nil               | splines, parallel, survival, MASS                             | nil                                                      | GPL (>= 2)                  | nil             | nil                   | nil     | nil    | yes              | 3.5.0 |       |       |
| nlme                                                            | /usr/lib/R/library                                         |                                                       3.1-137 | recommended    | R (>= 3.4.0)                                                 | graphics, stats, utils, lattice                                | nil               | Hmisc, MASS                                                   | nil                                                      | GPL (>= 2)                  | file LICENCE    | nil                   | nil     | nil    | nil              |   yes | 3.4.4 |       |
| nnet                                                            | /usr/lib/R/library                                         |                                                        7.3-12 | recommended    | R (>= 2.14.0), stats, utils                                  | nil                                                            | nil               | MASS                                                          | nil                                                      | GPL-2                       | GPL-3           | nil                   | nil     | nil    | nil              |   yes | 3.5.0 |       |
| parallel                                                        | /usr/lib/R/library                                         |                                                         3.5.1 | base           | nil                                                          | tools, compiler                                                | nil               | methods                                                       | snow, nws, Rmpi                                          | Part of R 3.5.1             | nil             | nil                   | nil     | nil    | yes              | 3.5.1 |       |       |
| rpart                                                           | /usr/lib/R/library                                         |                                                        4.1-13 | recommended    | R (>= 2.15.0), graphics, stats, grDevices                    | nil                                                            | nil               | survival                                                      | nil                                                      | GPL-2                       | GPL-3           | nil                   | nil     | nil    | nil              |   yes | 3.5.0 |       |
| spatial                                                         | /usr/lib/R/library                                         |                                                        7.3-11 | recommended    | R (>= 3.0.0), graphics, stats, utils                         | nil                                                            | nil               | MASS                                                          | nil                                                      | GPL-2                       | GPL-3           | nil                   | nil     | nil    | nil              |   yes | 3.5.0 |       |
| splines                                                         | /usr/lib/R/library                                         |                                                         3.5.1 | base           | nil                                                          | graphics, stats                                                | nil               | Matrix, methods                                               | nil                                                      | Part of R 3.5.1             | nil             | nil                   | nil     | nil    | yes              | 3.5.1 |       |       |
| stats                                                           | /usr/lib/R/library                                         |                                                         3.5.1 | base           | nil                                                          | utils, grDevices, graphics                                     | nil               | MASS, Matrix, SuppDists, methods, stats4                      | nil                                                      | Part of R 3.5.1             | nil             | nil                   | nil     | nil    | yes              | 3.5.1 |       |       |
| stats4                                                          | /usr/lib/R/library                                         |                                                         3.5.1 | base           | nil                                                          | graphics, methods, stats                                       | nil               | nil                                                           | nil                                                      | Part of R 3.5.1             | nil             | nil                   | nil     | nil    | nil              | 3.5.1 |       |       |
| survival                                                        | /usr/lib/R/library                                         |                                                        2.42-3 | recommended    | R (>= 2.13.0)                                                | graphics, Matrix, methods, splines, stats, utils               | nil               | nil                                                           | nil                                                      | LGPL (>= 2)                 | nil             | nil                   | nil     | nil    | yes              | 3.4.4 |       |       |
| tcltk                                                           | /usr/lib/R/library                                         |                                                         3.5.1 | base           | nil                                                          | utils                                                          | nil               | nil                                                           | nil                                                      | Part of R 3.5.1             | nil             | nil                   | nil     | nil    | yes              | 3.5.1 |       |       |
| tools                                                           | /usr/lib/R/library                                         |                                                         3.5.1 | base           | nil                                                          | nil                                                            | nil               | codetools, methods, xml2, curl                                | nil                                                      | Part of R 3.5.1             | nil             | nil                   | nil     | nil    | yes              | 3.5.1 |       |       |
| utils                                                           | /usr/lib/R/library                                         |                                                         3.5.1 | base           | nil                                                          | nil                                                            | nil               | methods, xml2, commonmark                                     | nil                                                      | Part of R 3.5.1             | nil             | nil                   | nil     | nil    | yes              | 3.5.1 |       |       |

** Python information
#+begin_src shell :results output :exports both
pip3 freeze
#+end_src

#+RESULTS:
#+begin_example
asn1crypto==0.24.0
attrs==19.1.0
backcall==0.1.0
bcrypt==3.1.4
beautifulsoup4==4.6.0
bleach==3.1.0
Brlapi==0.6.7
certifi==2018.1.18
chardet==3.0.4
chrome-gnome-shell==0.0.0
cryptography==2.1.4
cupshelpers==1.0
cvxopt==1.1.9
cycler==0.10.0
decorator==4.4.0
defusedxml==0.5.0
entrypoints==0.3
html5lib==0.999999999
httplib2==0.9.2
idna==2.6
ipykernel==5.1.0
ipython==7.4.0
ipython-genutils==0.2.0
ipywidgets==6.0.0
jedi==0.13.3
Jinja2==2.10
joblib==0.11
jsonschema==3.0.1
jupyter-client==5.2.4
jupyter-console==5.2.0
jupyter-core==4.4.0
jupyterlab==0.35.4
jupyterlab-server==0.2.0
kazam==1.4.5
keyring==12.2.1
keyrings.alt==3.0
kiwisolver==1.0.1
louis==3.5.0
lxml==4.2.5
Mako==1.0.7
MarkupSafe==1.1.1
matplotlib==2.2.2
meld==3.18.0
mistune==0.8.4
nbconvert==5.4.1
nbformat==4.4.0
notebook==5.7.8
numexpr==2.6.8
numpy==1.14.5
olefile==0.45.1
pandas==0.23.3
pandocfilters==1.4.2
paramiko==2.4.0
parso==0.3.4
patsy==0.4.1+dev
pexpect==4.6.0
pickleshare==0.7.5
Pillow==5.3.0
pluggy==0.6.0
prometheus-client==0.6.0
prompt-toolkit==2.0.9
ptyprocess==0.6.0
py==1.5.3
pyasn1==0.4.2
pycairo==1.16.2
pycrypto==2.6.1
pycups==1.9.73
pycurl==7.43.0.1
Pygments==2.3.1
PyGObject==3.30.4
PyNaCl==1.2.1
pyparsing==2.2.0
pyrsistent==0.14.11
pysmbc==1.0.15.6
pytest==3.3.2
python-apt==1.7.0
python-dateutil==2.8.0
python-debian==0.1.32
python-debianbts==2.7.2
pytz==2018.4
pyxdg==0.25
PyYAML==3.12
pyzmq==18.0.1
reportbug==7.1.10
reportlab==3.4.0
requests==2.18.4
rpy2==2.9.4
scipy==1.1.0
scour==0.36
seaborn==0.8.0
SecretStorage==2.3.1
Send2Trash==1.5.0
simplegeneric==0.8.1
simplejson==3.15.0
six==1.12.0
statsmodels==0.8.0
terminado==0.8.2
testpath==0.4.2
tornado==6.0.2
traitlets==4.3.2
tzlocal==1.5.1
urllib3==1.22
wcwidth==0.1.7
webencodings==0.5.1
#+end_example

#+begin_src python :results output :exports both
def print_imported_modules():
    import sys
    for name, val in sorted(sys.modules.items()):
        if(hasattr(val, '__version__')): 
            print(val.__name__, val.__version__)
        else:
            print(val.__name__, "(unknown version)")

print("**** Package list after loading pandas ****");
import pandas
print_imported_modules()
#+end_src

#+RESULTS:
#+begin_example
,**** Package list after loading pandas ****
__future__ (unknown version)
__main__ (unknown version)
_abc (unknown version)
_ast (unknown version)
_bisect (unknown version)
_blake2 (unknown version)
_bootlocale (unknown version)
_bz2 (unknown version)
_codecs (unknown version)
_collections (unknown version)
collections.abc (unknown version)
_compat_pickle (unknown version)
_compression (unknown version)
_csv 1.0
_ctypes 1.1.0
_cython_0_28_4 (unknown version)
_datetime (unknown version)
decimal 1.70
importlib._bootstrap (unknown version)
importlib._bootstrap_external (unknown version)
_functools (unknown version)
_hashlib (unknown version)
_heapq (unknown version)
_imp (unknown version)
io (unknown version)
_json (unknown version)
_locale (unknown version)
_lzma (unknown version)
_opcode (unknown version)
_operator (unknown version)
_pickle (unknown version)
_posixsubprocess (unknown version)
_random (unknown version)
_sha3 (unknown version)
_signal (unknown version)
_sitebuiltins (unknown version)
_socket (unknown version)
_sre (unknown version)
_ssl (unknown version)
_stat (unknown version)
_string (unknown version)
_struct (unknown version)
_thread (unknown version)
_warnings (unknown version)
_weakref (unknown version)
_weakrefset (unknown version)
abc (unknown version)
argparse 1.1
ast (unknown version)
atexit (unknown version)
base64 (unknown version)
binascii (unknown version)
bisect (unknown version)
builtins (unknown version)
bz2 (unknown version)
calendar (unknown version)
codecs (unknown version)
collections (unknown version)
collections.abc (unknown version)
contextlib (unknown version)
copy (unknown version)
copyreg (unknown version)
csv 1.0
ctypes 1.1.0
ctypes._endian (unknown version)
cycler 0.10.0
cython_runtime (unknown version)
datetime (unknown version)
dateutil 2.8.0
dateutil._common (unknown version)
dateutil._version (unknown version)
dateutil.easter (unknown version)
dateutil.parser (unknown version)
dateutil.parser._parser (unknown version)
dateutil.parser.isoparser (unknown version)
dateutil.relativedelta (unknown version)
dateutil.rrule (unknown version)
dateutil.tz (unknown version)
dateutil.tz._common (unknown version)
dateutil.tz._factories (unknown version)
dateutil.tz.tz (unknown version)
decimal 1.70
difflib (unknown version)
dis (unknown version)
distutils 3.7.2rc1
distutils.version (unknown version)
email (unknown version)
email._encoded_words (unknown version)
email._parseaddr (unknown version)
email._policybase (unknown version)
email.base64mime (unknown version)
email.charset (unknown version)
email.encoders (unknown version)
email.errors (unknown version)
email.feedparser (unknown version)
email.header (unknown version)
email.iterators (unknown version)
email.message (unknown version)
email.parser (unknown version)
email.quoprimime (unknown version)
email.utils (unknown version)
encodings (unknown version)
encodings.aliases (unknown version)
encodings.latin_1 (unknown version)
encodings.utf_8 (unknown version)
enum (unknown version)
errno (unknown version)
fnmatch (unknown version)
functools (unknown version)
gc (unknown version)
genericpath (unknown version)
gettext (unknown version)
glob (unknown version)
grp (unknown version)
gzip (unknown version)
hashlib (unknown version)
heapq (unknown version)
http (unknown version)
http.client (unknown version)
importlib (unknown version)
importlib._bootstrap (unknown version)
importlib._bootstrap_external (unknown version)
importlib.abc (unknown version)
importlib.machinery (unknown version)
importlib.util (unknown version)
inspect (unknown version)
io (unknown version)
itertools (unknown version)
json 2.0.9
json.decoder (unknown version)
json.encoder (unknown version)
json.scanner (unknown version)
keyword (unknown version)
linecache (unknown version)
locale (unknown version)
logging 0.5.1.2
lzma (unknown version)
marshal (unknown version)
math (unknown version)
matplotlib 2.2.2
matplotlib._color_data (unknown version)
matplotlib._path (unknown version)
matplotlib._version (unknown version)
matplotlib.cbook (unknown version)
matplotlib.cbook._backports (unknown version)
matplotlib.cbook.deprecation (unknown version)
matplotlib.colors (unknown version)
matplotlib.compat (unknown version)
matplotlib.compat.subprocess (unknown version)
matplotlib.dates (unknown version)
matplotlib.fontconfig_pattern (unknown version)
matplotlib.path (unknown version)
matplotlib.rcsetup (unknown version)
matplotlib.testing (unknown version)
matplotlib.ticker (unknown version)
matplotlib.transforms (unknown version)
matplotlib.units (unknown version)
mmap (unknown version)
mpl_toolkits (unknown version)
numpy.random.mtrand (unknown version)
ntpath (unknown version)
numbers (unknown version)
numpy 1.14.5
numpy.__config__ (unknown version)
numpy._distributor_init (unknown version)
numpy._globals (unknown version)
numpy._import_tools (unknown version)
numpy.add_newdocs (unknown version)
numpy.compat (unknown version)
numpy.compat._inspect (unknown version)
numpy.compat.py3k (unknown version)
numpy.core 1.14.5
numpy.core._internal (unknown version)
numpy.core._methods (unknown version)
numpy.core.arrayprint (unknown version)
numpy.core.defchararray (unknown version)
numpy.core.einsumfunc (unknown version)
numpy.core.fromnumeric (unknown version)
numpy.core.function_base (unknown version)
numpy.core.getlimits (unknown version)
numpy.core.info (unknown version)
numpy.core.machar (unknown version)
numpy.core.memmap (unknown version)
numpy.core.multiarray 3.1
numpy.core.numeric (unknown version)
numpy.core.numerictypes (unknown version)
numpy.core.records (unknown version)
numpy.core.shape_base (unknown version)
numpy.core.umath b'0.4.0'
numpy.ctypeslib (unknown version)
numpy.fft (unknown version)
numpy.fft.fftpack (unknown version)
numpy.fft.fftpack_lite (unknown version)
numpy.fft.helper (unknown version)
numpy.fft.info (unknown version)
numpy.lib 1.14.5
numpy.lib._datasource (unknown version)
numpy.lib._iotools (unknown version)
numpy.lib._version (unknown version)
numpy.lib.arraypad (unknown version)
numpy.lib.arraysetops (unknown version)
numpy.lib.arrayterator (unknown version)
numpy.lib.financial (unknown version)
numpy.lib.format (unknown version)
numpy.lib.function_base (unknown version)
numpy.lib.index_tricks (unknown version)
numpy.lib.info (unknown version)
numpy.lib.mixins (unknown version)
numpy.lib.nanfunctions (unknown version)
numpy.lib.npyio (unknown version)
numpy.lib.polynomial (unknown version)
numpy.lib.scimath (unknown version)
numpy.lib.shape_base (unknown version)
numpy.lib.stride_tricks (unknown version)
numpy.lib.twodim_base (unknown version)
numpy.lib.type_check (unknown version)
numpy.lib.ufunclike (unknown version)
numpy.lib.utils (unknown version)
numpy.linalg (unknown version)
numpy.linalg._umath_linalg b'0.1.5'
numpy.linalg.info (unknown version)
numpy.linalg.lapack_lite (unknown version)
numpy.linalg.linalg (unknown version)
numpy.ma (unknown version)
numpy.ma.core (unknown version)
numpy.ma.extras (unknown version)
numpy.matrixlib (unknown version)
numpy.matrixlib.defmatrix (unknown version)
numpy.polynomial (unknown version)
numpy.polynomial._polybase (unknown version)
numpy.polynomial.chebyshev (unknown version)
numpy.polynomial.hermite (unknown version)
numpy.polynomial.hermite_e (unknown version)
numpy.polynomial.laguerre (unknown version)
numpy.polynomial.legendre (unknown version)
numpy.polynomial.polynomial (unknown version)
numpy.polynomial.polyutils (unknown version)
numpy.random (unknown version)
numpy.random.info (unknown version)
numpy.random.mtrand (unknown version)
numpy.testing (unknown version)
numpy.testing.decorators (unknown version)
numpy.testing.nose_tools (unknown version)
numpy.testing.nose_tools.decorators (unknown version)
numpy.testing.nose_tools.nosetester (unknown version)
numpy.testing.nose_tools.utils (unknown version)
numpy.testing.nosetester (unknown version)
numpy.testing.utils (unknown version)
numpy.version (unknown version)
opcode (unknown version)
operator (unknown version)
os (unknown version)
posixpath (unknown version)
pandas 0.23.3
pandas.__version (unknown version)
pandas._libs (unknown version)
pandas._libs.algos (unknown version)
pandas._libs.groupby (unknown version)
pandas._libs.hashing (unknown version)
pandas._libs.hashtable (unknown version)
pandas._libs.index (unknown version)
pandas._libs.indexing (unknown version)
pandas._libs.internals (unknown version)
pandas._libs.interval (unknown version)
pandas._libs.join (unknown version)
_libjson 1.33
pandas._libs.lib (unknown version)
pandas._libs.missing (unknown version)
pandas._libs.ops (unknown version)
pandas._libs.parsers (unknown version)
pandas._libs.properties (unknown version)
pandas._libs.reduction (unknown version)
pandas._libs.reshape (unknown version)
pandas._libs.skiplist (unknown version)
pandas._libs.sparse (unknown version)
pandas._libs.testing (unknown version)
pandas._libs.tslib (unknown version)
pandas._libs.tslibs (unknown version)
pandas._libs.tslibs.ccalendar (unknown version)
pandas._libs.tslibs.conversion (unknown version)
pandas._libs.tslibs.fields (unknown version)
pandas._libs.tslibs.frequencies (unknown version)
pandas._libs.tslibs.nattype (unknown version)
pandas._libs.tslibs.np_datetime (unknown version)
pandas._libs.tslibs.offsets (unknown version)
pandas._libs.tslibs.parsing (unknown version)
pandas._libs.tslibs.period (unknown version)
pandas._libs.tslibs.resolution (unknown version)
pandas._libs.tslibs.strptime (unknown version)
pandas._libs.tslibs.timedeltas (unknown version)
pandas._libs.tslibs.timestamps (unknown version)
pandas._libs.tslibs.timezones (unknown version)
pandas._libs.window (unknown version)
pandas._libs.writers (unknown version)
pandas.api (unknown version)
pandas.api.extensions (unknown version)
pandas.api.types (unknown version)
pandas.compat (unknown version)
pandas.compat.chainmap (unknown version)
pandas.compat.numpy (unknown version)
pandas.compat.numpy.function (unknown version)
pandas.compat.pickle_compat (unknown version)
pandas.core (unknown version)
pandas.core.accessor (unknown version)
pandas.core.algorithms (unknown version)
pandas.core.api (unknown version)
pandas.core.arrays (unknown version)
pandas.core.arrays.base (unknown version)
pandas.core.arrays.categorical (unknown version)
pandas.core.base (unknown version)
pandas.core.common (unknown version)
pandas.core.computation (unknown version)
pandas.core.computation.align (unknown version)
pandas.core.computation.api (unknown version)
pandas.core.computation.common (unknown version)
pandas.core.computation.engines (unknown version)
pandas.core.computation.eval (unknown version)
pandas.core.computation.expr (unknown version)
pandas.core.computation.ops (unknown version)
pandas.core.computation.pytables (unknown version)
pandas.core.computation.scope (unknown version)
pandas.core.config (unknown version)
pandas.core.config_init (unknown version)
pandas.core.dtypes (unknown version)
pandas.core.dtypes.api (unknown version)
pandas.core.dtypes.base (unknown version)
pandas.core.dtypes.cast (unknown version)
pandas.core.dtypes.common (unknown version)
pandas.core.dtypes.concat (unknown version)
pandas.core.dtypes.dtypes (unknown version)
pandas.core.dtypes.generic (unknown version)
pandas.core.dtypes.inference (unknown version)
pandas.core.dtypes.missing (unknown version)
pandas.core.frame (unknown version)
pandas.core.generic (unknown version)
pandas.core.groupby (unknown version)
pandas.core.groupby.groupby (unknown version)
pandas.core.index (unknown version)
pandas.core.indexes (unknown version)
pandas.core.indexes.accessors (unknown version)
pandas.core.indexes.api (unknown version)
pandas.core.indexes.base (unknown version)
pandas.core.indexes.category (unknown version)
pandas.core.indexes.datetimelike (unknown version)
pandas.core.indexes.datetimes (unknown version)
pandas.core.indexes.frozen (unknown version)
pandas.core.indexes.interval (unknown version)
pandas.core.indexes.multi (unknown version)
pandas.core.indexes.numeric (unknown version)
pandas.core.indexes.period (unknown version)
pandas.core.indexes.range (unknown version)
pandas.core.indexes.timedeltas (unknown version)
pandas.core.indexing (unknown version)
pandas.core.internals (unknown version)
pandas.core.missing (unknown version)
pandas.core.nanops (unknown version)
pandas.core.ops (unknown version)
pandas.core.panel (unknown version)
pandas.core.reshape (unknown version)
pandas.core.reshape.api (unknown version)
pandas.core.reshape.concat (unknown version)
pandas.core.reshape.melt (unknown version)
pandas.core.reshape.merge (unknown version)
pandas.core.reshape.pivot (unknown version)
pandas.core.reshape.reshape (unknown version)
pandas.core.reshape.tile (unknown version)
pandas.core.reshape.util (unknown version)
pandas.core.series (unknown version)
pandas.core.sorting (unknown version)
pandas.core.sparse (unknown version)
pandas.core.sparse.api (unknown version)
pandas.core.sparse.array (unknown version)
pandas.core.sparse.frame (unknown version)
pandas.core.sparse.scipy_sparse (unknown version)
pandas.core.sparse.series (unknown version)
pandas.core.strings (unknown version)
pandas.core.tools (unknown version)
pandas.core.tools.datetimes (unknown version)
pandas.core.tools.numeric (unknown version)
pandas.core.tools.timedeltas (unknown version)
pandas.core.util (unknown version)
pandas.core.util.hashing (unknown version)
pandas.core.window (unknown version)
pandas.errors (unknown version)
pandas.io (unknown version)
pandas.io.api (unknown version)
pandas.io.clipboards (unknown version)
pandas.io.common (unknown version)
pandas.io.date_converters (unknown version)
pandas.io.excel (unknown version)
pandas.io.feather_format (unknown version)
pandas.io.formats (unknown version)
pandas.io.formats.console (unknown version)
pandas.io.formats.format (unknown version)
pandas.io.formats.printing (unknown version)
pandas.io.formats.terminal (unknown version)
pandas.io.gbq (unknown version)
pandas.io.html (unknown version)
pandas.io.json (unknown version)
pandas.io.json.json (unknown version)
pandas.io.json.normalize (unknown version)
pandas.io.json.table_schema (unknown version)
pandas.io.msgpack (unknown version)
pandas.io.msgpack._packer (unknown version)
pandas.io.msgpack._unpacker (unknown version)
pandas.io.msgpack._version (unknown version)
pandas.io.msgpack.exceptions (unknown version)
pandas.io.packers (unknown version)
pandas.io.parquet (unknown version)
pandas.io.parsers (unknown version)
pandas.io.pickle (unknown version)
pandas.io.pytables (unknown version)
pandas.io.sas (unknown version)
pandas.io.sas.sasreader (unknown version)
pandas.io.sql (unknown version)
pandas.io.stata (unknown version)
pandas.plotting (unknown version)
pandas.plotting._compat (unknown version)
pandas.plotting._converter (unknown version)
pandas.plotting._core (unknown version)
pandas.plotting._misc (unknown version)
pandas.plotting._style (unknown version)
pandas.plotting._tools (unknown version)
pandas.testing (unknown version)
pandas.tools (unknown version)
pandas.tools.plotting (unknown version)
pandas.tseries (unknown version)
pandas.tseries.api (unknown version)
pandas.tseries.frequencies (unknown version)
pandas.tseries.offsets (unknown version)
pandas.util (unknown version)
pandas.util._decorators (unknown version)
pandas.util._depr_module (unknown version)
pandas.util._move (unknown version)
pandas.util._print_versions (unknown version)
pandas.util._tester (unknown version)
pandas.util._validators (unknown version)
pandas.util.testing (unknown version)
pathlib (unknown version)
pickle (unknown version)
platform 1.0.8
posix (unknown version)
posixpath (unknown version)
pprint (unknown version)
pwd (unknown version)
pyparsing 2.2.0
pytz 2018.4
pytz.exceptions (unknown version)
pytz.lazy (unknown version)
pytz.tzfile (unknown version)
pytz.tzinfo (unknown version)
quopri (unknown version)
random (unknown version)
re 2.2.1
reprlib (unknown version)
select (unknown version)
selectors (unknown version)
shutil (unknown version)
signal (unknown version)
site (unknown version)
sitecustomize (unknown version)
six 1.12.0
six.moves (unknown version)
six.moves.urllib (unknown version)
six.moves.urllib.request (unknown version)
socket (unknown version)
sre_compile (unknown version)
sre_constants (unknown version)
sre_parse (unknown version)
ssl (unknown version)
stat (unknown version)
string (unknown version)
struct (unknown version)
subprocess (unknown version)
sys (unknown version)
tempfile (unknown version)
textwrap (unknown version)
threading (unknown version)
time (unknown version)
token (unknown version)
tokenize (unknown version)
traceback (unknown version)
types (unknown version)
typing (unknown version)
typing.io (unknown version)
typing.re (unknown version)
unicodedata (unknown version)
unittest (unknown version)
unittest.case (unknown version)
unittest.loader (unknown version)
unittest.main (unknown version)
unittest.result (unknown version)
unittest.runner (unknown version)
unittest.signals (unknown version)
unittest.suite (unknown version)
unittest.util (unknown version)
urllib (unknown version)
urllib.error (unknown version)
urllib.parse (unknown version)
urllib.request 3.7
urllib.response (unknown version)
uu (unknown version)
warnings (unknown version)
weakref (unknown version)
zipfile (unknown version)
zipimport (unknown version)
zlib 1.0
#+end_example

* LaTeX Preamble                                                     :ignore:
#+LATEX_HEADER: \usepackage{DejaVuSansMono}
#+LATEX_HEADER: \usepackage[T1]{fontenc}
#+LATEX_HEADER: \usepackage[utf8]{inputenc}
#+LATEX_HEADER: %\usepackage{fixltx2e}
#+LATEX_HEADER: \usepackage{ifthen,figlatex}
#+LATEX_HEADER: \usepackage{longtable}
#+LATEX_HEADER: \usepackage{float}
#+LATEX_HEADER: \usepackage{dblfloatfix}    % To enable figures at the bottom of page
#+LATEX_HEADER: \usepackage{wrapfig}
#+LATEX_HEADER: \usepackage{subfigure}
#+LATEX_HEADER: \usepackage{graphicx}
#+LATEX_HEADER: \usepackage{color,soul}
#+LATEX_HEADER: \usepackage[export]{adjustbox}
#+LATEX_HEADER: \usepackage{xspace}
#+LATEX_HEADER: \usepackage{amsmath,amssymb}
#+LATEX_HEADER: \usepackage[american]{babel}
#+LATEX_HEADER: \usepackage{relsize}
#+LATEX_HEADER: \AtBeginDocument{
#+LATEX_HEADER:   \definecolor{pdfurlcolor}{rgb}{0,0,0.6}
#+LATEX_HEADER:   \definecolor{pdfcitecolor}{rgb}{0,0.6,0}
#+LATEX_HEADER:   \definecolor{pdflinkcolor}{rgb}{0.6,0,0}
#+LATEX_HEADER:   \definecolor{light}{gray}{.85}
#+LATEX_HEADER:   \definecolor{vlight}{gray}{.95}
#+LATEX_HEADER: }
#+LATEX_HEADER: %\usepackage[paper=letterpaper,margin=1.61in]{geometry}
#+LATEX_HEADER: \usepackage{url} \urlstyle{sf}
#+LATEX_HEADER: \usepackage[normalem]{ulem}
#+LATEX_HEADER: \usepackage{todonotes}
#+LATEX_HEADER: \usepackage{fancyvrb}
#+LATEX_HEADER: %\usepackage[colorlinks=true,citecolor=pdfcitecolor,urlcolor=pdfurlcolor,linkcolor=pdflinkcolor,pdfborder={0 0 0}]{hyperref}
#+LATEX_HEADER: \usepackage{color,colortbl}
#+LATEX_HEADER: \definecolor{gray98}{rgb}{0.98,0.98,0.98}
#+LATEX_HEADER: \definecolor{gray20}{rgb}{0.20,0.20,0.20}
#+LATEX_HEADER: \definecolor{gray25}{rgb}{0.25,0.25,0.25}
#+LATEX_HEADER: \definecolor{gray16}{rgb}{0.161,0.161,0.161}
#+LATEX_HEADER: \definecolor{gray60}{rgb}{0.6,0.6,0.6}
#+LATEX_HEADER: \definecolor{gray30}{rgb}{0.3,0.3,0.3}
#+LATEX_HEADER: \definecolor{bgray}{RGB}{248, 248, 248}
#+LATEX_HEADER: \definecolor{amgreen}{RGB}{77, 175, 74}
#+LATEX_HEADER: \definecolor{amblu}{RGB}{55, 126, 184}
#+LATEX_HEADER: \definecolor{amred}{RGB}{228,26,28}
#+LATEX_HEADER: \definecolor{amdove}{RGB}{102,102,122}
#+LATEX_HEADER: \usepackage{xcolor}
#+LATEX_HEADER: \usepackage[procnames]{listings}
#+LATEX_HEADER: \lstset{ %
#+LATEX_HEADER:  backgroundcolor=\color{gray98},    % choose the background color; you must add \usepackage{color} or \usepackage{xcolor}
#+LATEX_HEADER:  basicstyle=\tt\scriptsize,        % the size of the fonts that are used for the code
#+LATEX_HEADER:  breakatwhitespace=false,          % sets if automatic breaks should only happen at whitespace
#+LATEX_HEADER:  breaklines=true,                  % sets automatic line breaking
#+LATEX_HEADER:  showlines=true,                   % sets automatic line breaking
#+LATEX_HEADER:  captionpos=b,                     % sets the caption-position to bottom
#+LATEX_HEADER:  commentstyle=\color{gray30},      % comment style
#+LATEX_HEADER:  extendedchars=true,               % lets you use non-ASCII characters; for 8-bits encodings only, does not work with UTF-8
#+LATEX_HEADER:  frame=single,                     % adds a frame around the code
#+LATEX_HEADER:  keepspaces=true,                  % keeps spaces in text, useful for keeping indentation of code (possibly needs columns=flexible)
#+LATEX_HEADER:  keywordstyle=\color{amblu},       % keyword style
#+LATEX_HEADER:  procnamestyle=\color{amred},      % procedures style
#+LATEX_HEADER:  language=[95]fortran,             % the language of the code
#+LATEX_HEADER:  numbers=left,                     % where to put the line-numbers; possible values are (none, left, right)
#+LATEX_HEADER:  numbersep=5pt,                    % how far the line-numbers are from the code
#+LATEX_HEADER:  numberstyle=\tiny\color{gray20},  % the style that is used for the line-numbers
#+LATEX_HEADER:  rulecolor=\color{gray20},         % if not set, the frame-color may be changed on line-breaks within not-black text (\eg comments (green here))
#+LATEX_HEADER:  showspaces=false,                 % show spaces everywhere adding particular underscores; it overrides 'showstringspaces'
#+LATEX_HEADER:  showstringspaces=false,           % underline spaces within strings only
#+LATEX_HEADER:  showtabs=false,                   % show tabs within strings adding particular underscores
#+LATEX_HEADER:  stepnumber=2,                     % the step between two line-numbers. If it's 1, each line will be numbered
#+LATEX_HEADER:  stringstyle=\color{amdove},       % string literal style
#+LATEX_HEADER:  tabsize=2,                        % sets default tabsize to 2 spaces
#+LATEX_HEADER:  % title=\lstname,                    % show the filename of files included with \lstinputlisting; also try caption instead of title
#+LATEX_HEADER:  procnamekeys={call}
#+LATEX_HEADER: }
#+LATEX_HEADER: \definecolor{colorfuncall}{rgb}{0.6,0,0}
#+LATEX_HEADER: \newcommand{\prettysmall}{\fontsize{6}{8}\selectfont}
#+LATEX_HEADER: \let\oldtexttt=\texttt
#+LATEX_HEADER: \renewcommand\texttt[1]{\oldtexttt{\smaller[1]{#1}}}
# #+LATEX_HEADER: \usepackage[round-precision=3,ground-mode=figures,scientific-notation=true]{siunitx}
#+LATEX_HEADER: \usepackage[binary-units,group-digits,group-separator={,}]{siunitx}
#+LATEX_HEADER: \DeclareSIUnit\flop{Flop}
#+LATEX_HEADER: \DeclareSIUnit\flops{\flop\per\second}
#+LATEX_HEADER: \newcommand{\Num}[1]{\num[group-separator={,}]{#1}\xspace}
#+LATEX_HEADER: \newcommand{\NSI}[2]{\SI[group-separator={,}]{#1}{#2}\xspace}
#+LATEX_HEADER:\usepackage{tikz}
#+LATEX_HEADER:\usetikzlibrary{arrows,shapes,positioning,shadows,trees,calc}
#+LATEX_HEADER:\usepackage{pgfplots}
#+LATEX_HEADER:\pgfplotsset{compat=1.13}

#+LATEX_HEADER: \usepackage{enumitem}
#+LATEX_HEADER: \setlist[itemize,1]{leftmargin=\dimexpr 26pt-.2in}
#+LATEX_HEADER: \usepackage[mode=buildnew]{standalone}
#+LATEX_HEADER: \usepackage[ruled,vlined,english]{algorithm2e}
#+LATEX_HEADER: \DontPrintSemicolon

#+LaTeX: \newcommand\myemph[1]{\color{colorfuncall}\textbf{#1}}%

#+LaTeX: \newcommand\labspace[1][-0cm]{\vspace{#1}}
#+LaTeX: \renewcommand\O{\ensuremath{\mathcal{O}}\xspace}%

#+BEGIN_EXPORT latex
\makeatletter
\newcommand{\removelatexerror}{\let\@latex@error\@gobble}
\makeatother
#+END_EXPORT

#+BEGIN_EXPORT latex
% Uggly hack to allow invisible title downscaling
\let\osubsection=\subsection
\def\subsection#1{\osubsection[]{#1}}
#+END_EXPORT

* ACM title and authors                                    :ignore:
#+BEGIN_EXPORT latex
\let\oldcite=\cite
\renewcommand\cite[2][]{~\ifthenelse{\equal{#1}{}}{\oldcite{#2}}{\oldcite[#1]{#2}}\xspace}
\let\oldref=\ref
\def\ref#1{~\oldref{#1}\xspace}
\def\eqref#1{~(\oldref{#1})\xspace}
\def\ie{i.e.,\xspace}
\def\eg{e.g.,\xspace}
\def\etal{~\textit{et al.\xspace}}
\newcommand{\AL}[2][inline]{\todo[caption={},color=green!50,#1]{\small\sf\textbf{AL:} #2}}
\newcommand{\TC}[2][inline]{\todo[caption={},color=blue!50,#1]{\small\sf\textbf{TOM:} #2}}
\newcommand{\CH}[2][inline]{\todo[color=red!30,#1]{\small\sf \textbf{CH:} #2}}
%\newcommand{\AL}[2][inline]{}
%\newcommand{\TC}[2][inline]{}
%\newcommand{\CH}[2][inline]{}

\title{Faitfhful and Efficient Simulation of High Performance Linpack}

% \author{Tom Cornebize, Franz C. Heinrich, Arnaud Legrand}
\author{Anonymous PhD Student, His Advisor, An Other PhD Student}
% \affiliation{%
%   \institution{Univ. Grenoble Alpes, CNRS, Inria, Grenoble INP, LIG}
%   \city{Grenoble}
%   \state{France}
%   \postcode{38000}
% }
\affiliation{%
  \institution{Univ. of Neverwhere}
%  \city{}
  \state{Wonderland}
%  \postcode{38000}
}
% \email{firstname.lastname@inria.fr}
\acmConference[SC19]{International Conference for High Performance Computing, Networking, Storage and Analysis}{19-21 Nov. 2019}{Denver, CO, USA}

% The default list of authors is too long for headers.
% \renewcommand{\shortauthors}{B. Trovato et al.}

%\title{Simulating the Energy Consumption of MPI~Applications}
% Predicting the Performance and the Power Consumption of MPI Applications With SimGrid
  %\titlerunning{Power-aware simulation for large-scale systems with SimGrid}
  %

#+END_EXPORT
* Abstract                                                           :ignore:
#+Latex:\begin{abstract}
With a power consumption of several MW per hour on a TOP500 machine,
running applications on supercomputers at scale solely to optimize
their performance is extremely expensive. High-Performance Linpack,
the benchmark used to rank supercomputers in the TOP500, requires a
careful tuning of many parameters (problem size, grid arrangement,
granularity, collective operation algorithms, etc.) and supports
exploration of the most fundamental performance issues and their
solutions. In this article, we explain how we both extended the
SimGrid's SMPI simulator and slightly modified the open-source version
of HPL to allow a fast emulation on a single commodity computer at the
scale of a supercomputer. We explain how to model the different
components (network, BLAS, ...) and show that a careful modeling of
both spatial and temporal node variability allows to obtain faithful
simulation predictions within a few percents of real experiments.
#+LaTeX: \end{abstract}

#+LaTeX: \maketitle              % typeset the title of the contribution
* Introduction
Today, machines with 100,000\nbsp{}cores and more are common and several
machines beyond the 1,000,000\nbsp{}cores mark are already in
production. This high density of computation units requires diligent
optimization of application parameters, such as problem size, process
organization or choice of algorithm, as these have a huge impact on
load distribution and network utilization. Scientific application
developers and users often spend considerable amount of time and
efforts running their application at different scales solely to tweak
parameters and optimize their performance. This duration, combined
with the power consumption that often reaches several MW for TOP500
machines, makes it financially expensive to test-run applications. A
large part of this tuning work could be simplified if a generic and
faithful performance prediction tool was available. This article
presents a decisive step in this direction.

The world's largest and fastest machines are ranked twice a year in
the TOP500 list using the High-Performance Linpack (HPL) benchmark. To
reach a good performance, a very large input is needed and it takes
typically several hours to run HPL on the list's number one
system. HPL implements several algorithmic optimizations that should
be carefully optimized and it is thus quite representative of many
other scientific applications in terms of potential performance issues
and their solutions. Although in the case of HPL, machine vendors know
how to estimate the performance using simple mathematical performance
models, these models provide trends but are not particularly accurate
as they underestimate the serious impact of the network
(\eg congestion or topology). Whenever actual
performance do not match expectations, it can be very difficult to
understand whether the mismatch originates from model imperfections or
from machine misconfiguration.

\TC{Au contraire, on a bien vu dans nos expriences que l'impact du rseau tait compltement ngligeable. C'est plutot la variabilit spatiale et temporelle qui pose problme et n'est pas prise en compte par les modles analytiques.}

# Yet, performance results of an already deployed, current-generation
# machine typically also play a role in the funding process for future
# machines. Results near the optimal performance for the current machine
# are hence considered critical for HPC centers and vendors. These
# entities would benefit from being able to tune parameters without
# actually running the benchmark for hours.
# This estimation can be done either via (mathematical) performance models (e.g., by
# estimating performance of specific functions) or by a simulation based approach.
# \CH{Furthermore, simulations can be used to validate/check that the execution went well (operated near the peak performance) but can also help to find the right parameters for the application, runtime and network.}

#+LaTeX: \AL[]{Clearly list contributions?}
# 1) Explain how to obtain Scalable simulation 2) Explain how to model
# resources 3) Detailed comparison with RL experiments that show the
# importance of carefully modeling spatial and temporal variability 4)
# Compare with a top 500 qualification run }

In this article, we explain how to predict the performance of HPL on a
supercomputer through simulation with the SimGrid/SMPI simulator. We
detail how we obtained faithful models for several functions (\eg
=dgemm= and =dtrsm=) and how we managed to reduce the memory consumption
from more than a hundred terabytes to several gigabytes, allowing us
to emulate HPL on a single commodity node. We evaluate the
effectiveness of our solution by simulating scenarios similar to the
run conducted on the Stampede cluster (TACC) in 2013 for the
TOP500. We manage to simulate such a scenario in details on a single
node in about two days. We are also able to predict the performance of
a controlled cluster (with a thousand of MPI processes) within a few
percents of reality.

This article is organized as follows: Section\ref{sec:con} presents
the main characteristics of the HPL application and provides detail on
the run that was conducted at TACC in 2013. Section\ref{sec:relwork}
discusses existing related work and explains why emulation (or /online
simulation/) is the only relevant approach when studying an application
as complex as HPL. In Section\ref{sec:smpi}, we briefly present the
simulator we used for this work, SimGrid/SMPI, followed by an
extensive discussion in Section\ref{sec:em} about the optimizations on
all levels (\ie simulator, application, system) that were necessary to
make a large-scale run tractable. The scalability of our approach is
evaluated in Section\ref{sec:scalabilityevol}. In
Section\ref{sec:modeling}, we explain how the different resources of
the supercomputer (network, BLAS kernels, ...) can be modeled to
account faithfully for the performance of HPL. In particular, we
discuss about the usefulness and relevance of different degrees of
modeling complexity. In Section\ref{sec:validation}, we compare
simulation results with real experiments and illustrate the importance
of modeling both spatial and temporal variability. Lastly,
Section\ref{sec:cl} concludes this article by discussing perspectives
and future work.
** Clearpage                                               :noexport:ignore:
\clearpage\setcounter{page}{2}
* Context
#+LaTeX: \label{sec:con}

# The HPLinpack benchmark consists of a set of rules: A set of linear
# equations, $Ax = b$, needs to be solved and it requires furthermore that the input matrix can be of
# arbitrary dimension =n= and that O(n) + O(n) operations be used
# (hence, Strassen's matrix multiplication is prohibited).

** High-Performance Linpack
\label{sec:hpl}
#+BEGIN_EXPORT latex
\begin{figure}
  \newcommand{\mykwfn}[1]{{\bf\textsf{#1}}}%
  \SetAlFnt{\sf}%
  \SetKwSty{mykwfn}%
  \SetKw{KwStep}{step}%
  \centering
  \begin{minipage}[m]{0.4\linewidth}
    % \vspace{0.3cm} % ugly, could not align the drawing with the algorithm with minipages or tabular...
    \begin{tikzpicture}[scale=0.23]
      \draw (0, 0) -- (0, 12) -- (12, 12) -- (12, 0) -- cycle;
      \foreach \i in {2}{
        \draw [fill=lightgray] (\i, 0) -- (\i, 12-\i) -- (12, 12-\i) -- (12, 0) -- cycle;
        \draw [fill=gray] (\i, 12-\i) -- (\i, 12-\i-1) -- (\i+1, 12-\i-1) -- (\i+1, 12-\i) -- cycle;
        \draw[very thick, -latex] (\i,12-\i) -- (\i+2,12-\i-2);
        \draw[<->] (\i, 12-\i+0.5) -- (\i+1, 12-\i+0.5) node [pos=0.5, yshift=+0.15cm] {\scalebox{.8}{\texttt{NB}}};
      }
      \foreach \i in {3}{
        \draw [fill=white] (\i, 0) -- (\i, 12-\i) -- (12, 12-\i) -- (12, 0) -- cycle;
        \draw (\i,12-\i) -- (\i,0);
        \draw[very thick, -latex] (\i,12-\i) -- (\i+2,12-\i-2);
      }
      \draw[dashed] (0, 12) -- (12, 0);
      \node(L) at (2, 2) {\ensuremath{\boldsymbol{L}}};
      \node(U) at (10, 10) {\ensuremath{\boldsymbol{U}}};
      \node(A) at (8, 4) {\ensuremath{\boldsymbol{A}}};
      \draw[<->] (0, -0.5) -- (12, -0.5) node [pos=0.5, yshift=-0.3cm] {$N$};

    \end{tikzpicture}
  \end{minipage}%
  \begin{minipage}[m]{0.6\linewidth}
    \removelatexerror
    \begin{algorithm}[H]
      allocate and initialize $A$\;
      \For{$k=N$ \KwTo $0$ \KwStep \texttt{NB}}{
        allocate the panel\;
        factor the panel\;
        broadcast the panel\;
        update the sub-matrix;
      }
    \end{algorithm}
    \vspace{1em}
  \end{minipage}
  \caption{Overview of High Performance Linpack}\vspace{-1em}
  \label{fig:hpl_overview}
\end{figure}
#+END_EXPORT

For this work, we use the freely-available reference-implementation of
the High-Performance Linpack benchmark\cite{HPL}, HPL, which is 
used to benchmark systems for the TOP500\cite{TOP500} list. HPL
requires MPI to be available and implements
a LU decomposition. HPL checks the correctness of this factorization by
solving a linear system$A\cdot{}x=b$, but only the factorization step is
benchmarked.  The factorization is based on a right-looking variant of
the LU factorization with row partial pivoting and allows multiple
look-ahead depths. The working principle of the factorization is depicted in
Figure\ref{fig:hpl_overview} and consists of a series of panel
factorizations followed by an update of the trailing sub-matrix.
HPL uses a two-dimensional block-cyclic data distribution of$A$ and implements several custom
collective communication algorithms to overlap efficiently communications 
with computations.
The main parameters of HPL are listed subsequently:
- $N$ is the order of the square matrix $A$.
- =NB= is the ``blocking factor'', \ie the granularity at
  which HPL operates when panels are distributed or worked on.
- $P$ and $Q$ denote the number of process rows and the
  number of process columns, respectively.
- =RFACT= determines the panel factorization algorithm. Possible values are Crout, left- or right-looking.
- =SWAP= specifies the swapping algorithm used while pivoting. Two
  algorithms are available: one based on /binary exchange/ (along a virtual tree topology) and the other one based on
  a /spread-and-roll/ (with a higher number of parallel communications). HPL
  also provides a panel-size threshold triggering a switch from one variant to the other.
- =BCAST= sets the algorithm used to broadcast the
  panel of columns to the other process columns. Legacy versions of
  the MPI standard only supported non-blocking point-to-point communications but did
  not support non-blocking collective communications, which is why HPL
  ships with in total 6 self-implemented variants to 
  overlap the time spent waiting for an incoming panel with updates to
  the trailing matrix: =ring=, =ring-modified=, =2-ring=, =2-ring-modified=,
  =long=, and =long-modified=. The =modified= versions guarantee that
  the process right after the root (\ie the process that will become the root
  in the next iteration) receives data first and does not participate
  further in the broadcast. This process can thereby start working on the
  panel as soon as possible. The =ring= and =2-ring= versions correspond
  to the name-giving two virtual topologies while the =long= version
  is a /spread and roll/ algorithm where messages are chopped into$Q$
  pieces. This generally leads to better bandwidth exploitation. The =ring= and
  =2-ring= variants rely on =MPI_Iprobe=, meaning they
  return control if no message has been fully received yet and hence
  facilitate partial overlapping of communication with computations. In HPL2.2 and 2.1, this capability
  has been deactivated for the =long= and =long-modified= algorithms. A comment in the source code states that some
  machines apparently get stuck when there are too many ongoing messages.
- =DEPTH= controls how many iterations of the outer loop can overlap with each other.

The sequential complexity of this factorization is 
$\mathrm{flop}(N) = \frac{2}{3}N^3 + 2N^2 + \O(N)$ where $N$ is the
order of the matrix to factorize. The time complexity can be
approximated by
$$T(N) \approx \frac{\left(\frac{2}{3}N^3 + 2N^2\right)}{P\cdot{}Q\cdot{}w} + \Theta((P+Q)\cdot{}N^2),$$ where
$w$ is the flop rate of a single node and 
the second term corresponds to the communication overhead which is
influenced by the network capacity and by the previously listed parameters (=RFACT=, =SWAP=, =BCAST=,
=DEPTH=,\ldots) and is very difficult to predict.
# After each run, HPL reports the overall flop
# rate $\mathrm{flop}(N)/T(N)$ (expressed in \si{\giga\flops}) for
# the given configuration. 
** Typical Runs on a Supercomputer
\label{sec:typical_run}

Although the TOP500 reports precise information about the core count,
the peak performance and the effective performance, it provides almost
no information on how (software versions, HPL parameters, etc.) this
performance was achieved. Some colleagues agreed to provide us with
the HPL configuration they used and the output they submitted for
ranking. In June 2013, the Stampede supercomputer at TACC was ranked
6th in the TOP500 by achieving \NSI{5168.1}{\tera\flops}. In November
2017, a performance of \NSI{5884.6}{\tera\flops} gave the 18th place to
the Theta supercomputer at ANL but required a 28 hours run on the
whole machine. Finally, we have personally performed
a run of HPL on a Grid5000 cluster named Dahu and on which we have a
full control. We report in figure\ref{fig:typical_run} the parameters
used for each of these runs. 

#+BEGIN_EXPORT latex
% \TC{Voir l'email de Swan du 30/01/2018  propos des rsultats de TACC. Il
% demandait de ne pas diffuser plus loin sans on accord, mais je ne sais pas s'il
% parlait du HPL.dat ou des rponses de son collgue.}
% \TC{Le run TOP500 de Theta a t refait plusieurs fois. Je ne sais pas auquel
% correspond le fichier HPL.dat que l'on a. J'ai report la perf de novembre
% 2017.}

\begin{figure}[t]
\scalebox{.9}{\begin{tabular}{l|lll}
\multicolumn{1}{l|}{} & Stampede@TACC & Theta@ANL & Dahu@G5K\\
\hline
\texttt{Rpeak}     & \NSI{8520.1}{\tera\flops} & \NSI{9627.2}{\tera\flops} & \NSI{62.26}{\tera\flops}              \\
$N$         & \Num{3875000}                & \Num{8360352}                & \Num{500000}            \\
\texttt{NB}        & \Num{1024}                    & 336                      & 128                \\
$P\times Q$             & 77$\times$78                  & 32$\times$101                 & 32$\times$32            \\
\texttt{RFACT}     & Crout                    & Left                     & Right              \\
\texttt{SWAP}      & Binary-exch.             & Binary-exch.             & Binary-exch.       \\
\texttt{BCAST}     & Long modified            & 2 Ring modified          & 2 Ring             \\
\texttt{DEPTH}     & 0                        & 0                        & 1                  \\
\hline
\texttt{Rmax}      & \NSI{5168.1}{\tera\flops} & \NSI{5884.6}{\tera\flops} & \NSI{24.55}{\tera\flops}              \\
Duration   & 2 hours                  & 28 hours                 & 1 hour             \\
Memory    & \NSI{120}{\tera\byte}     & \NSI{559}{\tera\byte}     & \NSI{2}{\tera\byte} \\
MPI ranks & 1/node                & 1/node                   & 1/core             \\
\end{tabular}}\vspace{-1em}
\caption{Typical runs of HPL}\vspace{-1em}
\label{fig:typical_run}
\end{figure}
#+END_EXPORT

*** Hidden information about the Stampede execution              :noexport:
TOP500: https://www.TOP500.org/system/177931

#+BEGIN_SRC C :exports none :tangle fullrun_hpl.txt
================================================================================
HPLinpack 2.1  --  High-Performance Linpack benchmark  --   October 26, 2012
Written by A. Petitet and R. Clint Whaley,  Innovative Computing Laboratory, UTK
Modified by Piotr Luszczek, Innovative Computing Laboratory, UTK
Modified by Julien Langou, University of Colorado Denver
================================================================================

The following parameter values will be used:

\myemph{N}        : \myemph{3875000}
\myemph{NB}       :   \myemph{1024}
PMAP     : Column-major process mapping
\myemph{P}        :      \myemph{77}
\myemph{Q}        :      \myemph{78}
PFACT    :   Right 
NBMIN    :       4 
NDIV     :       2 
RFACT    :   Crout 
BCAST    :  BlongM 
DEPTH    :       0 
SWAP     : Binary-exchange
L1       : no-transposed form
U        : no-transposed form
EQUIL    : no
ALIGN    :    8 double precision words

--------------------------------------------------------------------------------


[...]


Peak Performance = 5172687.23 GFlops /   861.25 GFlops per node
================================================================================
T/V                N    NB     P     Q               Time                 Gflops
--------------------------------------------------------------------------------
WC05C2R4     3875000  1024    77    78            7505.72            \myemph{5.16811e+06}
HPL_pdgesv() start time Sun Jun  2 13:04:59 2013

HPL_pdgesv() end time   Sun Jun  2 15:10:04 2013

--------------------------------------------------------------------------------
||Ax-b||_oo/(eps*(||A||_oo*||x||_oo+||b||_oo)*N)=        0.0007822 ...... PASSED
#+END_SRC

*** Hidden information about the Theta execution                 :noexport:
TOP500: https://www.TOP500.org/system/178926
Remarks:
- they report a Nmax of 7,680,000, which is smaller that what we have in the HPL.dat
- none of the 3 "total cores" values is a multiple of P*Q=32*101

HPL.dat:
#+BEGIN_EXAMPLE
HPLinpack benchmark input file
Innovative Computing Laboratory, University of Tennessee
HPL.out      output file name (if any)
6            device out (6=stdout,7=stderr,file)
1            # of problems sizes (N)
8360352       Ns
1            # of NBs
336          NBs
1            PMAP process mapping (0=Row-,1=Column-major)
1            # of process grids (P x Q)
32           Ps
101           Qs
16.0         threshold
1            # of panel fact
2            PFACTs (0=left, 1=Crout, 2=Right)
1            # of recursive stopping criterium
2            NBMINs (>= 1)
1            # of panels in recursion
2            NDIVs
1            # of recursive panel fact.
0            RFACTs (0=left, 1=Crout, 2=Right)
1            # of broadcast
3            BCASTs (0=1rg,1=1rM,2=2rg,3=2rM,4=Lng,5=LnM,6=Psh,7=Psh2)
1            # of lookahead depth
0            DEPTHs (>=0)
0            SWAP (0=bin-exch,1=long,2=mix)
1           swapping threshold
1            L1 in (0=transposed,1=no-transposed) form
1            U  in (0=transposed,1=no-transposed) form
0            Equilibration (0=no,1=yes)
8            memory alignment in double (> 0)
#+END_EXAMPLE

*** Hidden information about the Dahu execution                  :noexport:
Code to retrieve the output, using [[https://github.com/Ezibenroc/mpi_calibration/blob/master/dahu/hpl/grenoble_2018-10-10_1811847.zip][this archive]]:
#+begin_src python :results output :session *python* :exports both
import json
import zipfile
hist = json.loads(zipfile.ZipFile('grenoble_2018-10-10_1811847.zip').read('history.json'))
mpiruns = [c for c in hist if 'mpirun' in c['command']]
large_run = mpiruns[3]
print(large_run['stdout'])
#+end_src

HPL output (pruned):
#+BEGIN_EXAMPLE
N      :  500000
NB     :     128
PMAP   : Row-major process mapping
P      :      32
Q      :      32
PFACT  :Wed Oct 10 15:11:45 2018<stdout>:   Crout
NBMIN  :       2
NDIV   :       2
RFACT  :   Right
BCAST  :   2ring
DEPTH  :       1
SWAP   : Binary-exchange
L1     : transposed form
U      : transposed form
EQUIL  : yes
ALIGN  : 8 double precision words

================================================================================
T/V                N    NB     P     Q               Time                 Gflops
--------------------------------------------------------------------------------
WR12R2C2      500000   128    32    32            3394.20              2.455e+04
HPL_pdgesv() start time Wed Oct 10 15:11:51 2018

HPL_pdgesv() end time   Wed Oct 10 16:08:26 2018

--------------------------------------------------------------------------------
||Ax-b||_oo/(eps*(||A||_oo*||x||_oo+||b||_oo)*N)=        0.0005583 ...... PASSED
================================================================================
#+END_EXAMPLE
** Performance Evaluation Challenges                                :ignore:
:LOGBOOK:
- State "TODO"       from              [2017-11-15 mer. 16:26]
:END:
#+LaTeX: \label{sec:con:diff}

The performance typically achieved by supercomputers (=Rmax=) needs to
be compared to the much larger peak performance (=Rpeak=). This difference may be attributed to the node
usage, to the MPI library, to the network topology that
may be unable to deal with the very intensive communication workload, to
load imbalance among nodes because some node happens to be slower for some
reason (defect, system noise, \ldots), to the algorithmic structure of
HPL, etc. All these factors make it difficult to know precisely what
performance to expect without running the application at scale.
It is clear that due to the level of complexity of both HPL and
the underlying hardware, simple performance models (analytic expressions based
on $N, P, Q$ and estimations of platform characteristics as presented in
Section\ref{sec:hpl}) may be able to provide trends but can by no means
accurately predict the performance for each configuration (\ie consider the
exact effect of HPL's 6 different broadcast algorithms on network
contention). Additionally, these expressions do not allow
engineers to improve the performance through actively identifying performance bottlenecks.
For complex optimizations such as partially non-blocking
collective communication algorithms intertwined with computations,
very faithful modeling of both the application and the platform is
required. Our goal in this article is to simulate
systems at the scale of Stampede. Given the scale of this scenario
(3,785\nbsp{}steps on 6,006nodes in two hours), detailed
simulations quickly become intractable without significant effort.
* Related Work
#+LaTeX: \label{sec:relwork}
# HPL may be a benchmark, it presents complex and optimized collective
# communication patterns that are entangled with the computing logic of
# the application to offer the best possible overlap of communications
# with computations. Its adaptive behavior is thus particularly
# challenging to simulate and representative of what can be found in
# many MPI applications.
Performance prediction of MPI application through simulation has been
widely studied over the last decades but two approaches can be
distinguished in the literature: offline and online simulation.

With the most common approach, /offline simulation/, a time-independent
trace of the application is first obtained on a real platform. This
trace comprises sequences of MPI operations and CPU bursts and is
given as an input to a simulator that implements performance models
for the CPUs and the network to derive predictions. Researchers
interested in finding out how their application reacts to changes to
the underlying platform can replay the trace on commodity hardware at
will with different platform models.
Most HPC simulators available today, notably BigSim\cite{bigsim_04},
Dimemas\cite{dimemas} and CODES\cite{CODES}, rely on this approach.
The main limitation of this approach comes from the trace
acquisition requirement. Not only a large machine is required but the
compressed trace of a few iterations (out of several thousands)
of HPL typically weights a few hundreds of MB, which quickly becomes 
impractical\cite{suter}. Even worse, tracing an application provides
only information about
its behavior at the time of the run. Even light modifications 
(\eg to communication patterns) may make the trace inaccurate. For
simple applications (\eg =stencil=) it is
possible to extrapolate behavior from small-scale
traces\cite{scalaextrap,pmac_lspp13} but this fails if the execution is
non-deterministic, \ie whenever the application relies on
non-blocking communication patterns, which is unfortunately the
case for HPL.

The second approach discussed in literature is /online simulation/.
Here, the application is executed (emulated) on top of a simulator
that is responsible for determining when each process
is run. This approach allows researchers
to study directly the behavior of MPI applications but only a few
recent simulators such as SST Macro\cite{sstmacro},
SimGrid/SMPI\cite{simgrid} 
and the closed-source extreme-scale simulator xSim\cite{xsim} support
it. To the best of our knowledge, only SST Macro and
SimGrid/SMPI are mature enough to emulate faithfully 
HPL. For our work, we decided to rely on SimGrid as 
its performance models and its emulation capabilities seemed quite solid but 
the developments we propose would a priori also be possible with SST.
* SimGrid/SMPI in a Nutshell
#+LATEX: \label{sec:smpi}

SimGrid\cite{simgrid} is a flexible and open-source simulation
framework that was originally designed in 2000 to study scheduling
heuristics tailored to heterogeneous grid computing environments but
has later been extended to study cloud and HPC infrastructures. The
main development goal for SimGrid has been to provide validated
performance models particularly for scenarios leveraging the network.
Such a validation usually consists in comparing simulation
predictions with results from real experiments to confirm or debunk
network and application models.

SMPI, a simulator based on SimGrid, has been developed
and used to simulate unmodified MPI applications written in
C/C++ or FORTRAN\cite{smpi}. 
The complex network optimizations done in real MPI implementations
need to be considered when predicting performance of MPI applications.
For instance, the protocol used, such as ``eager'' or ``rendez-vous''
are selected based on the message size, with each protocol having its
own synchronization semantics, which stronly impact performance.
To deal with this, SMPI relies on a generalization of the LogGPS.
Modeling network topologies and contention is also difficult.  SMPI
relies on SimGrid's communication models where each ongoing
communication is represented as a whole (as opposed to single packets)
by a /flow/. Assuming steady-state, contention between active
communications can be modeled as a bandwidth sharing problem that
accounts for non-trivial phenomena (\eg cross-traffic interference or network
heterogeneity\cite{Velho_TOMACS13}). Communications that start or end
trigger re-computation of the bandwidth sharing if needed.  In this
model, the time to simulate a message passing through the network is
independent of its size, which is advantageous for large-scale
applications frequently sending large messages.  SimGrid does not
model transient phenomena incurred by the network protocol but
accounts for network topology and heterogeneity. Special attention to
the modeling of collective communication algorithms has also been
taken in SMPI, but this is of little significance in this article as HPL
ships with its own implementation of collective operations.

SMPI maps every MPI process
of the application onto a lightweight simulation thread, which
are then run one at a time, \ie in mutual exclusion.  Every time a
thread enters an MPI call, SMPI takes control and the time that was
spent computing (isolated from the other threads) since the previous
MPI call is injected into the simulator as a virtual delay.  This
time may be scaled up or down depending on the simulated machine with
respect to the simulation machine.
Recent results report consistent predictions within a
few percent of both performance and energy consumption for standard
benchmarks on small-scale clusters (up to $12\times12$cores
in\cite{heinrich:hal-01523608} and up to $128\times1$cores
in\cite{smpi}). In this article, we validate this approach at a much
larger scale with HPL, whose emulation comes with at least two challenges:
- The time-complexity of the
  algorithm is $\Theta(N^3)$ and $\Theta(N^2)$ communications are performed, with $N$ being very
  large. The execution on the Stampede cluster took roughly two hours
  on 6,006\nbsp{}compute nodes. Using only a single node, a naive
  emulation of HPL at the scale of the Stampede run would take about
  500days if perfect scaling was reached. 
  # Although the emulation could
  # be done in parallel, we want to use as little computing resources as possible.
- The tremendous memory consumption and amount of memory accesses need
  to be drastically reduced.

# Real execution:
# - Matrix of order 3,875,000
# - Using 6,006 MPI processes
# - About 2 hours
# Requirement for the emulation of Stampede's execution:
# - $\ge 3, 875, 000 2 \times 8$ bytes \approx 120 terabytes of memory
# - $\ge 6, 006 \times 2$ hours \approx 500 days (very optimistic)
** Clearpage                                               :noexport:ignore:
\clearpage\setcounter{page}{4}
* Emulating HPL at Large Scale
#+LaTeX: \label{sec:em}

We now present the changes to SimGrid and HPL that were required for a
scalable simulation. We provide only a brief presentation of our
modifications and refer the reader interested in details
to\cite{cornebize:hal-01544827}\AL[]{Anonymize}

For our experiments in this section, we used a single core from nodes
of the Nova cluster provided by the Grid'5000 testbed\cite{grid5000} with
\NSI{32}{\giga\byte} RAM, two 8-core Intel Xeon E5-2620v4
CPUs processors and Debian Stretch (Linux4.9). 
# with \NSI{2.1}{\GHz}
** Speeding Up the Emulation
*** Kernel Modeling
Given its complexity, a faithful prediction of HPL requires emulation,
\ie to execute the code.  HPL relies heavily
on BLAS kernels such as =dgemm= (for matrix-matrix multiplication) or
=dtrsm= (for solving an equation of the form $Ax=b$). An analysis of an
HPL simulation with $64$ processes and a very small matrix of order
$30,000$ showed that roughly \NSI{96}{\percent} of the time is spent in
these two kernels. Since
these kernels do not influence the control flow, simulation time can
be reduced by substituting =dgemm= and =dtrsm= function calls with a
performance model for the respective kernel. 
Skipping kernels renders the content of some variables invalid but in
simulation, only the behavior of the application and not the
correctness of computation results are of concern.
Figure\ref{fig:macro_simple} shows an example of this macro-based
mechanism that allows us to keep HPL code modifications to an absolute
minimum. The =(1.029e-11)= value represents the inverse of the flop rate
for this computation kernel and was obtained through calibration. The
estimated time for the real kernel is calculated based on the
parameters and eventually passed on to =smpi_execute_benched= that
advances the clock of the executing rank by this estimate.
The effect on simulation time for a small scenario is
depicted in Figure\ref{fig:kernel_sampling}. This
modification speeds up the simulation by orders of magnitude. The precision of
the simulation will be investigated in more details in the next sections
but it can already be observed that this kernel model leads to an accurate,
albeit slightly more optimistic, estimation of the performance.

#+BEGIN_EXPORT latex
\begin{figure}%[!htb]
%  \null\vspace{-1cm}
  \centering
  \subfigure[Non-intrusive macro replacement with a very simple computation model.\label{fig:macro_simple}]{
    \begin{minipage}[b]{\linewidth}
      \lstset{frame=bt,language=C,numbers=none,escapechar=|}\lstinputlisting{HPL_dgemm_macro_simple.c}
    \end{minipage}}
  \subfigure[Gain in term of simulation time.\label{fig:kernel_sampling}]{
    \begin{minipage}[b]{\linewidth} 
      \includegraphics[width=\linewidth,page=2]{figures/validation_kernel_modeling.pdf}
    \end{minipage}}
  \caption{Replacing the calls to computationally expensive functions by a model allows to emulate HPL at a larger scale.}\vspace{-1em}
\end{figure}
#+END_EXPORT

**** Hidden section with estimation of the quality/speed of the simulation :noexport:
Inspire from the entry of [[file:~/Work/Journals/tom_cornebize/m2_internship_journal/journal.org::*2017-11-15%20Wednesday][Tom's journal]] ([[https://github.com/Ezibenroc/m2_internship_journal/tree/master/journal.org][Github version]]) "2017-11-15 Wednesday":
Regenerating the validation plot for smpi_execute".

#+begin_src R :results output :session *R* :exports both
library(ggplot2)
library(gridExtra)
library(grid)
old <- read.csv("/home/alegrand/Work/Journals/tom_cornebize/m2_internship_journal/validation/result_size_L0.csv")
new <- read.csv("/home/alegrand/Work/Journals/tom_cornebize/m2_internship_journal/validation/result_size_L1.csv")
old$kernel_sampling = FALSE
new$kernel_sampling =  TRUE
results = rbind(old, new)
generic_do_plot <- function(plot, fixed_shape=TRUE) {
#   For xrange, see https://stackoverflow.com/questions/7705345/how-can-i-extract-plot-axes-ranges-for-a-ggplot2-object
#   old version for xrange (broken)
#   xrange = ggplot_build(plot)$panel$ranges[[1]]$x.range
#   new version for xrange (may break in the next ggplot update...)
    xrange = p$layout$panel_scales_x[[1]]$range$range # ggplot_build(plot)$layout$panel_ranges[[1]]$x.range
    xwidth = xrange[2] - xrange[1]
    if(fixed_shape) {
        point = stat_summary(fun.y = mean, geom="point", shape=21)
    }
    else {
        point = stat_summary(fun.y = mean, geom="point")
    }
    return(plot +
        stat_summary(fun.data = mean_se, geom = "errorbar", width=xwidth/20)+
        stat_summary(fun.y = mean, geom="line")+
        point+
        theme_bw()+ scale_color_brewer(palette="Set1") + 
        expand_limits(x=0, y=0))
}

# From https://stackoverflow.com/a/38420690/4110059
grid_arrange_shared_legend <- function(..., nrow = 1, ncol = length(list(...)), position = c("bottom", "top", "right")) {

  plots <- list(...)
  position <- match.arg(position)
  g <- ggplotGrob(plots[[1]] + theme(legend.position = position))$grobs
  legend <- g[[which(sapply(g, function(x) x$name) == "guide-box")]]
  lheight <- sum(legend$height)
  lwidth <- sum(legend$width)
  gl <- lapply(plots, function(x) x + theme(legend.position = "none"))
  gl <- c(gl, nrow = nrow, ncol = ncol)

  combined <- switch(position,
                     "bottom" = arrangeGrob(do.call(arrangeGrob, gl),
                                            legend,
                                            ncol = 1,
                                            heights = unit.c(unit(1, "npc") - lheight, lheight)),
                     "top" = arrangeGrob(legend, do.call(arrangeGrob,gl),
                                            ncol = 1,
                                            heights = unit.c(lheight, unit(1, "npc") - lheight)),
                     "right" = arrangeGrob(do.call(arrangeGrob, gl),
                                           legend,
                                           ncol = 2,
                                           widths = unit.c(unit(1, "npc") - lwidth, lwidth)))
  grid.newpage()
  grid.draw(combined)

}
#+end_src

#+RESULTS:

#+begin_src R :file figures/validation_kernel_modeling.pdf :results value graphics :results output :session *R* :exports both :width 8 :height 3.5
plot1 = generic_do_plot(ggplot(results, aes(x=size, y=Gflops, color=kernel_sampling, linetype=kernel_sampling))) +
    labs(colour="Kernel modeling") +
    labs(linetype="Kernel modeling") +
    xlab('Matrix order') +
    ylab('Performance [Gflop/s]') +
    ggtitle("Performance estimation\n(P=Q=8, i.e., 64 MPI process)")
plot2 = generic_do_plot(ggplot(results, aes(x=size, y=simulation_time, color=kernel_sampling, linetype=kernel_sampling))) +
    labs(colour="Kernel modeling") +
    labs(linetype="Kernel modeling") +
    xlab('Matrix order') +
    ylab('Time [seconds]') +
    ggtitle("Simulation time\n(P=Q=8, i.e., 64 MPI process)")

grid_arrange_shared_legend(plot2, plot1, ncol=2, position="top")
#+end_src

#+RESULTS:
[[file:figures/validation_kernel_modeling.pdf]]

**** Hidden section with macro code                             :noexport:
#+BEGIN_SRC C :exports none :tangle HPL_dtrsm_macro_real.c
#define |\color{colorfuncall}HPL\_dtrsm|(layout, Side, Uplo, TransA, Diag, M, N, alpha, A, lda, B, ldb) ({ \
    double expected_time;                                                           \
    double coefficient, intercept;                                                  \
    if((M) > 512 && (N) > 512) {                                                    \
        coefficient = (double)SMPI_DTRSM_PHI_COEFFICIENT;                           \
        intercept = (double)SMPI_DTRSM_PHI_INTERCEPT;                               \
    } else {                                                                        \
        coefficient = (double)SMPI_DTRSM_CPU_COEFFICIENT;                           \
        intercept = (double)SMPI_DTRSM_CPU_INTERCEPT;                               \
    }                                                                               \
    if((Side) == HplLeft) {                                                         \
        expected_time = coefficient*((double)(M))*((double)(M))*((double)(N));      \
    } else {                                                                        \
        expected_time = coefficient*((double)(M))*((double)(N))*((double)(N));      \
    }                                                                               \
    expected_time += intercept                                                      \
    if(expected_time > 0)                                                           \
        |\color{colorfuncall}smpi\_execute\_benched|(expected_time);                                        \
})
#+END_SRC

#+BEGIN_SRC C :exports none :tangle HPL_dtrsm_macro_simple_old.c
#define |\color{colorfuncall}HPL\_dtrsm|(layout, Side, Uplo, TransA, Diag, M, N, alpha, A, lda, B, ldb) ({      \
    double expected_time = (9.882e-12)*((double)M)*((double)M)*((double)N) + 4.329e-02;   \
    if(expected_time > 0)                                                                 \
        |\color{colorfuncall}smpi\_execute\_benched|(expected_time);                      \
})
#+END_SRC

#+BEGIN_SRC C :exports none :tangle HPL_dtrsm_macro_simple.c
#define |\color{colorfuncall}HPL\_dtrsm|(layout, Side, Uplo, TransA, Diag,      \ 
        M, N, alpha, A, lda, B, ldb) ({                  \
    double expected_time = (9.882e-12)*((double)M)*      \
                   ((double)M)*((double)N) + 4.329e-02;  \
    if(expected_time > 0)                                \
        |\color{colorfuncall}smpi\_execute\_benched|(expected_time);             \
})
#+END_SRC

#+BEGIN_SRC C :exports none :tangle HPL_dgemm_macro_simple.c
#define |\color{colorfuncall}HPL\_dgemm|(layout, TransA, TransB,                       \
        M, N, K, alpha, A, lda, B, ldb, beta, C, ldc) ({        \
    double expected_time = (1.029e-11)*((double)M)*             \
                   ((double)N)*((double)K) + 1.981e-12;         \
    if(expected_time > 0)  |\color{colorfuncall}smpi\_execute\_benched|(expected_time); \
})
#+END_SRC
*** Specific Adjustments of HPL
#+LaTeX: \label{sec:hplchanges}

HPL uses pseudo-randomly generated
matrices that need to be setup every time HPL is executed. The time
spent on this just as the validation of the computed result is
not considered in the reported performance.
Since both
phases do not have an impact on the reported performance, we can safely
skip them.

In addition to the main computation kernels =dgemm= and =dtrsm=, 
we identified seven other BLAS functions through
profiling as computationally expensive enough to justify a specific
handling: =dgemv=, =dswap=, =daxpy=,
=dscal=, =dtrsv=, =dger= and =idamax=. Similarly, a significant amount of time was
spent in fifteen functions implemented in HPL: 
=HPL_dlaswp*N=, =HPL_dlaswp*T=, =HPL_dlacpy= and =HPL_dlatcpy=.
All of these functions are called during the
LU factorization and hence impact the performance measured by HPL; however, because of
the removal of the =dgemm= and =dtrsm= computations, they all operate on
bogus data and hence also produce bogus data. To study their impact on
overal performance, we handled them in the same was as =dgemm= and
=dtrsm= through performance models and macro substitution.

Last, note that HPL
implements an LU factorization with partial pivoting and a special
treatment of the =idamax= function that returns the index of the first
element equaling the maximum absolute value. Although we ignored the
cost of this function as well, we set its return value to an random (but controlled)
value to make the simulation unbiased (but fully deterministic).
We confirmed that this modification is harmless in terms of performance prediction while it
speeds up the simulation by an additional factor of $\approx3$ to $4$
on small ($N=30,000$) and even more on large scenarios.
** Scaling Down Memory Consumption
*** Figure                                                         :ignore:
#+BEGIN_EXPORT latex
\tikzset{draw half paths/.style 2 args={%
  % From https://tex.stackexchange.com/a/292108/71579
  decoration={show path construction,
    lineto code={
      \draw [#1] (\tikzinputsegmentfirst) --
         ($(\tikzinputsegmentfirst)!0.5!(\tikzinputsegmentlast)$);
      \draw [#2] ($(\tikzinputsegmentfirst)!0.5!(\tikzinputsegmentlast)$)
        -- (\tikzinputsegmentlast);
    }
  }, decorate
}}
\tikzstyle{switch}=[draw, circle, minimum width=1cm, minimum height = 1cm]
\tikzstyle{compute}=[draw, rectangle, minimum width=0.5cm, minimum height = 0.5cm, node distance=0.5cm]
\tikzstyle{base}=[ellipse, minimum width=2cm, minimum height = 0.5cm, node distance = 0.5cm]
\tikzstyle{bigswitch}=[base, draw]
\begin{figure}%[b]%[htbp]
  \centering
  \begin{tikzpicture}[yscale=0.5, scale=0.7]
    \pgfmathtruncatemacro{\size}{4}
    \pgfmathtruncatemacro{\width}{2}
    \pgfmathtruncatemacro{\sizem}{\size-1}
    \pgfmathtruncatemacro{\smallbasex}{4}
    \pgfmathtruncatemacro{\smallbasey}{\size/2}
    \pgfmathtruncatemacro{\smallstopx}{\smallbasex+\width}
    \pgfmathtruncatemacro{\smallstopy}{\smallbasey+1}
    \foreach \i in {0,\sizem}{
	    \pgfmathtruncatemacro{\j}{\i+1}
	    \draw (0, \i) -- (0, \j);
	    \draw (\width, \i) -- (\width, \j);
	    \draw[dotted] (0, \i) -- (\width, \i);
	    \draw[dotted] (0, \j) -- (\width, \j);
	}
	\draw[dashed] (0, 1) -- (0, \sizem);
	\draw[dashed] (\width, 1) -- (\width, \sizem);
	\draw (0, 0)     -- (\width, 0);
	\draw (0, \size) -- (\width, \size);
    \draw (\smallbasex,\smallbasey) -- (\smallstopx,\smallbasey) -- (\smallstopx,\smallstopy) -- (\smallbasex,\smallstopy) -- cycle;
    \foreach \i in {0,\sizem}{
	    \pgfmathtruncatemacro{\j}{\i+1}
	    \draw[dotted] (\width, \i) -- (\smallbasex, \smallbasey);
	    \draw[dotted] (\width, \j) -- (\smallbasex, \smallstopy);
	    \pgfmathsetmacro{\xleft}{\width}
	    \pgfmathsetmacro{\xright}{\smallbasex}%{\width/2.0+\smallbasex/2.0}
	    \pgfmathsetmacro{\yleft}{\i + 0.5}
	    \pgfmathsetmacro{\yright}{\smallbasey + 0.5}
	    \path [draw half paths={solid, -latex}{draw=none}]  (\xleft, \yleft) -- (\xright, \yright);
	}
	\draw[decorate,line width=1pt,decoration={brace,raise=0.2cm}] (0, 0) -- (0, \size) node [pos=0.5, xshift=-1cm] {virtual};
	\draw[decorate,line width=1pt,decoration={brace,mirror,raise=0.2cm}] (\smallstopx, \smallbasey) -- (\smallstopx, \smallstopy) node [pos=0.5, xshift=1.2cm] {physical};
  \end{tikzpicture}
  \caption{\label{fig:global_shared_malloc}SMPI shared malloc mechanism: large area of virtual memory are mapped onto the same physical pages.}
% \end{figure}
% \begin{figure}%[htbp]
%  \centering

  {\begin{minipage}{1.0\linewidth}
  \subfigure[Structure of the panel in HPL.\label{fig:panel_structure}]{\small
    \begin{minipage}[b]{\linewidth}\centering
      \begin{tikzpicture}[yscale=.6,scale=0.8]
        \draw [fill=gray] (3, 2) -- (6, 2) -- (6, 3) -- (3, 3) -- cycle;
        \draw (0, 2) -- (9, 2) -- (9, 3) -- (0, 3) -- cycle;
        \draw[dashed] (3, 2) -- (3, 3);
        \draw[dashed] (6, 2) -- (6, 3);
        \node(1) at (1.5, 2.5) {matrix parts};
        \node(2) at (4.5, 2.5) {indices};
        \node(3) at (7.5, 2.5) {matrix parts};
        \draw[decorate,line width=1pt,decoration={brace,raise=0.2cm}] (0.2, 3) -- (2.8, 3) node [pos=0.5, yshift=0.5cm] {can be shared};
        \draw[decorate,line width=1pt,decoration={brace,raise=0.2cm}] (6.2, 3) -- (8.8, 3) node [pos=0.5, yshift=0.5cm] {can be shared};
        \draw[decorate,line width=1pt,decoration={brace,raise=0.2cm}] (3.2, 3) -- (5.8, 3) node [pos=0.5, yshift=+0.5cm] {must not be shared};
      \end{tikzpicture}
    \end{minipage}}
  \subfigure[Reusing panel allocation from an iteration to another.\label{fig:panel_reuse}]{\small
    \begin{minipage}[b]{\linewidth}\centering
      \begin{tikzpicture}[yscale=.5]
        \draw [fill=gray] (2, 1) -- (4, 1) -- (4, 1.5) -- (2, 1.5) --cycle;
        \draw (0, 1) -- (6, 1) -- (6, 1.5) -- (0, 1.5) -- cycle;
        \draw[dashed] (2, 1) -- (2, 1.5);
        \draw[dashed] (4, 1) -- (4, 1.5);

        \draw [fill=gray] (2, 0) -- (3, 0) -- (3, .5) -- (2, .5) --cycle;
        \draw (1, 0) -- (4, 0) -- (4, .5) -- (1, .5) -- cycle;
        \draw[dashed] (2, 0) -- (2, .5);
        \draw[dashed] (3, 0) -- (3, .5);

        \draw[-latex] (2, 1) -- (2, .5);
        \draw[decorate,line width=1pt,decoration={brace,raise=0.2cm}] (0, 1.5) -- (6, 1.5) node [pos=0.5, yshift=0.5cm] {initial buffer};
        \draw[decorate,line width=1pt,decoration={brace,raise=0.2cm, mirror}] (1, 0) -- (4, 0) node [pos=0.5, yshift=-0.5cm] {current buffer};
      \end{tikzpicture}
    \end{minipage}
  }    
  \end{minipage}}
  \caption{Panel structure and allocation strategy.\label{fig:panel}}\vspace{-1em}
\end{figure}
#+END_EXPORT

*** Text                                                           :ignore:
The largest two allocated data structures in HPL are the input matrix =A=
(with a size of typically several \si{\giga\byte} per process) and the =panel= which contains
information about the sub-matrix currently being factorized. This sub-matrix 
typically occupies a few hundred \si{\mega\byte} per process.
Unfortunately, when emulating an application with SMPI, all MPI processes are run
within the same simulation process on a single node and the memory
consumption of the simulation can therefore quickly reach several
\si{\tera\byte} of RAM.  Yet, as we no longer operate on real data,
storing the whole input matrix $A$ is needless. However, since only a
minimal portion of the code was modified, some functions may still
read or write some parts of the matrix.  It is thus not possible to
simply remove the memory allocations of large data structures. SMPI
provides the =SMPI_SHARED_MALLOC= (=SMPI_SHARED_FREE=) macro to replace
calls to =malloc= (=free=). They indicate that some data structures can
safely be shared between processes and that the data they contain is
not critical for the execution (\eg an input matrix) and that it may
even be overwritten. =SMPI_SHARED_MALLOC= works as follows (see
Figure\ref{fig:global_shared_malloc}): a single block of physical
memory (of default size \NSI{1}{\mega\byte}) for the whole execution
is allocated and shared by all MPI processes.  A range of virtual
addresses corresponding to a specified size is reserved and cyclically
mapped onto the previously obtained physical address.  This mechanism
allows most applications to obtain a nearly constant memory footprint,
regardless of the size of the actual allocations.
# Instead, SMPI's =SHARED_MALLOC= mechanism can be used
# to share unimportant data structures between all ranks, minimizing the memory footprint.

Although using the default =SHARED_MALLOC= mechanism works flawlessly
for =A=, a more careful strategy needs to be used for the
=panel=. The =panel= is an intricate data structure with both \texttt{int}s
(accounting for matrix indices, error codes, MPI tags, and pivoting information)
and \texttt{double}s (corresponding to a copy of a sub-matrix of =A=). To
optimize data transfers, HPL flattens this structure into a single
allocation of \texttt{double}s (see
Figure\ref{fig:panel_structure}). Using a fully shared memory
allocation for the =panel= therefore leads to index corruption that results in
classic invalid memory accesses. Since \texttt{int}s and \texttt{double}s are stored in
non-contiguous parts of this flat allocation, it is therefore
essential to have a mechanism that preserves the process-specific
content. We have thus introduced the 
=SMPI_PARTIAL_SHARED_MALLOC= macro that allows to specify which ranges of the
allocation should be preserved (\ie private to each process) and
which ones may be corrupted (\ie shared between process). 

We also leveraged the information on which memory area is private, shared or
partially shared to improve the overall performance. 
By making SMPI internally aware of the memory's
visibility, it can now avoid calling =memcopy= when large messages
containing shared segments are sent from one MPI rank to another.
For fully private or partially shared segments, SMPI
identifies and copies only those parts that are process-dependent
(private) into the corresponding buffers on the receiver side.
HPL simulation times and memory consumption were considerably improved
in our experiments because the =panel= as the most frequently
transferred datastructure is partially shared with only a small part
being private. For a matrix of order $40,000$ and $64$ MPI processes,
the memory consumption decreased from about \NSI{13.5}{\giga\byte} to
less than \NSI{40}{\mega\byte}.

HPL \texttt{malloc}s/\texttt{free}s panels in each
iteration, with the size of the panel strictly decreasing from
iteration to iteration. As we explained above, the partial sharing of
panels requires many calls to =mmap= and introduces an overhead that
makes these repeated allocations / frees become a bottleneck. Since
the very first allocation can fit all subsequent panels, we modified
this allocation mechanism to allocate only the first panels and reuse
them as much as possible for subsequent iterations (see
Figure\ref{fig:panel_reuse}). For a very small matrix of order
$40,000$ and $64$ MPI processes, the simulation time decreases by four
seconds, from \NSI{20.5}{\sec} to \NSI{16.5}{\sec}. Responsible for this
is a reduction of system time, namely from \NSI{5.9}{\sec} to
\NSI{1.7}{\sec}. The number of page faults decreased from $2$ million
to $0.2$ million, confirming the devastating effect these
allocations/deallocations would have at scale.

Finally, for larger matrix orders (\ie $N$ larger than a few hundred
thousand), the performance of the simulation quickly deteriorates as
the memory consumption rises rapidly. Indeed, folding the memory
allows to reduce the /physical/ memory usage. The /virtual/ memory, on the
other hand, is still allocated for every process since the allocation
calls are still executed.  Without a reduction of allocated virtual
addresses, the page table rapidly becomes too large to fit in a single
node. Thankfully, the x86-64 architecture supports several
page sizes, known as /huge pages/ in Linux. Typically, these pages
are around \NSI{2}{\mebi\byte} (instead of \NSI{4}{\kibi\byte}), which
reduces drastically the page table size. For example, for a matrix of
order $N=4,000,000$, it shrinks from \NSI{250}{\giga\byte} to
\NSI{0.488}{\giga\byte}.
# Changing the page size requires administrator (root) privileges as the
# Linux kernel support for /hugepages/ needs to be activated and a
# =hugetlbfs= file system must be mounted. After at least one huge
# page has been allocated, the path of the allocated file system can then be
# passed on to SimGrid.
** Scalability Evaluation
#+LaTeX: \label{sec:scalabilityevol}

#+BEGIN_EXPORT latex
\begin{figure}[t]
  \centering
  \includegraphics[width=\linewidth,page=2]{./figures/scalability_plot_size.pdf}
%  \includegraphics[width=\linewidth,page=2]{./figures/scalability_plot_nbproc.pdf}
  \caption{Time complexity and memory consumption are linear in the number of processes but remain mildly quadratic with matrix rank.}\vspace{-1em}
  \label{fig:hpl_scalability}
  \labspace
\end{figure}
#+END_EXPORT

The main goal of the previous optimizations is to reduce the
complexity from $\Theta(N^3) + \Theta(N^2\cdot{}P\cdot{}Q)$ to something more reasonable.
The $\Theta(N^3)$ was removed through skipping most computations. 
Ideally, since there are $N/NB$ iterations (steps), 
the complexity of simulating one step should be decreased to something independent of
$N$. SimGrid's fluid models, used to simulate communications, do not
depend on $N$. Therefore, the time to simulate a step of HPL should mostly depend on $P$ and
$Q$. Yet, some memory operations on the panel that are related to pivoting
are intertwined in HPL with collective communications, meaning that it
is impossible to get rid of the $\O(N)$ complexity without
modifying HPL more profoundly. 

To evaluate the efficiency of our proposal, we conduct a first
evaluation on a non-existing, albeit similar to Stampede, platform
comprising 4,096 8-core nodes interconnected through a
$\langle2;16,32;1,16;1,1\rangle$ fat-tree topology built on ideal network links
with a bandwidth of \NSI{50}{\giga\byte\per\sec} and a latency of
\NSI{5}{\micro\sec}. We run simulations with $512$; $1,024$; $2,048$ or
$4,096$ MPI processes and with matrices of orders \Num{5e5},
\Num{1e6}, \Num{2e6} or \Num{4e6}. All other HPL parameters are
similar to the ones of the Stampede scenario.  The impact of the
matrix order on total makespan and memory is illustrated in
Figure\ref{fig:hpl_scalability}.  With all previously described
optimizations enabled, the longest simulation took
close to $47$ hours and consumed \NSI{16}{\giga\byte} of memory
whereas the shortest one took $20$ minutes and \NSI{282}{\mega\byte}
of memory.
\AL[]{This section should end on page 5.}
*** Hidden section                                               :noexport:
Got data and code from the "2017-06-05 Monday: Plots for scalability
test" section of Tom's journal:

#+begin_src R :results output :session *R* :exports both
library(ggplot2)
library(ggrepel)
library(reshape2)
library(gridExtra)
results = rbind(
    read.csv('/home/alegrand/Work/SimGrid/tom/m2_internship_journal/scalability/result_500000_512.csv'),
    read.csv('/home/alegrand/Work/SimGrid/tom/m2_internship_journal/scalability/result_500000_1024.csv'),
    read.csv('/home/alegrand/Work/SimGrid/tom/m2_internship_journal/scalability/result_500000_2048.csv'),
    read.csv('/home/alegrand/Work/SimGrid/tom/m2_internship_journal/scalability/result_500000_4096.csv'),
    read.csv('/home/alegrand/Work/SimGrid/tom/m2_internship_journal/scalability/result_1000000_512.csv'),
    read.csv('/home/alegrand/Work/SimGrid/tom/m2_internship_journal/scalability/result_1000000_1024.csv'),
    read.csv('/home/alegrand/Work/SimGrid/tom/m2_internship_journal/scalability/result_1000000_2048.csv'),
    read.csv('/home/alegrand/Work/SimGrid/tom/m2_internship_journal/scalability/result_1000000_4096.csv'),
    read.csv('/home/alegrand/Work/SimGrid/tom/m2_internship_journal/scalability/result_2000000_512.csv'),
    read.csv('/home/alegrand/Work/SimGrid/tom/m2_internship_journal/scalability/result_2000000_1024.csv'),
    read.csv('/home/alegrand/Work/SimGrid/tom/m2_internship_journal/scalability/result_2000000_2048.csv'),
    read.csv('/home/alegrand/Work/SimGrid/tom/m2_internship_journal/scalability/result_2000000_4096.csv'),
    read.csv('/home/alegrand/Work/SimGrid/tom/m2_internship_journal/scalability/result_4000000_512.csv'),
    read.csv('/home/alegrand/Work/SimGrid/tom/m2_internship_journal/scalability/result_4000000_1024.csv'),
    read.csv('/home/alegrand/Work/SimGrid/tom/m2_internship_journal/scalability/result_4000000_2048.csv'),
    read.csv('/home/alegrand/Work/SimGrid/tom/m2_internship_journal/scalability/result_4000000_4096.csv')
)
results$simulation_time = results$simulation_time/3600
results$memory_size = results$memory_size * 1e-9
number_verb <- function(n) {
    return(format(n,big.mark=",",scientific=FALSE))
}
results$size_verb = factor(unlist(lapply(results$size, number_verb)), levels = c('500,000','1,000,000','2,000,000','4,000,000'))
results$nb_proc_verb = factor(unlist(lapply(results$nb_proc, number_verb)), levels = c('512', '1,024', '2,048', '4,096'))
results
#+end_src

#+RESULTS:
#+begin_example
             topology nb_roots nb_proc    size  full_time        time Gflops
1  2;16,32;1,16;1,1;8       16     512  500000    91246.1    91246.02  913.3
2  2;16,32;1,16;1,1;8       16    1024  500000    46990.1    46990.02 1773.0
3  2;16,32;1,16;1,1;8       16    2048  500000    24795.5    24795.50 3361.0
4  2;16,32;1,16;1,1;8       16    4096  500000    13561.0    13561.01 6145.0
5    2;16,32;1,16;1,1       16     512 1000000   716521.0   716521.00  930.4
6    2;16,32;1,16;1,1       16    1024 1000000   363201.0   363201.04 1836.0
7    2;16,32;1,16;1,1       16    2048 1000000   186496.0   186495.70 3575.0
8  2;16,32;1,16;1,1;8       16    4096 1000000    97836.6    97836.54 6814.0
9    2;16,32;1,16;1,1       16     512 2000000  5685080.0  5685077.72  938.1
10   2;16,32;1,16;1,1       16    1024 2000000  2861010.0  2861012.55 1864.0
11   2;16,32;1,16;1,1       16    2048 2000000  1448900.0  1448899.09 3681.0
12 2;16,32;1,16;1,1;8       16    4096 2000000   742691.0   742690.59 7181.0
13 2;16,32;1,16;1,1;8       16     512 4000000 45305100.0 45305083.56  941.8
14 2;16,32;1,16;1,1;8       16    1024 4000000 22723800.0 22723820.45 1878.0
15 2;16,32;1,16;1,1;8       16    2048 4000000 11432900.0 11432938.62 3732.0
16 2;16,32;1,16;1,1;8       16    4096 4000000  5787160.0  5787164.09 7373.0
   simulation_time application_time user_time system_time major_page_fault
1        0.3311083          204.992   1098.25       93.12                0
2        0.6895222          441.897   2296.51      184.70                0
3        1.4144361          872.425   4741.26      349.79                0
4        3.1448889         1947.320  10640.63      679.53                0
5        0.7319722          500.970   2367.19      259.91                0
6        1.6771917         1036.960   5515.36      515.05                0
7        3.4421944         2092.950  11389.36      995.39                0
8        7.2368056         4362.660  24082.38     1966.10                0
9        1.9263500         1169.660   6193.80      683.73                0
10       4.2217500         2551.100  13714.01     1430.93                0
11       8.9621111         5236.560  29357.92     2844.89                0
12      18.0156389        10643.600  59444.40     5402.24                0
13       4.8156944         3030.400  15090.31     1945.23                0
14      10.6613611         6435.870  34249.71     3827.36                0
15      23.2042222        13080.500  75523.95     7684.52                0
16      47.1275000        26745.400 154314.76    15085.08                0
   minor_page_fault cpu_utilization        uss         rss page_table_size
1            960072            0.99  155148288  2055086080        10604000
2           1054062            0.99  369696768  4383203328        21240000
3           1282294            0.99 1012477952  9367576576        42912000
4           1852119            0.99 3103875072 15318568960        87740000
5           1916208            0.99  153665536  2317279232        10600000
6           2002989            0.99  369676288  4837175296        21252000
7           2154982            0.99 1010696192  7774138368        42908000
8           2768705            0.99 3103895552 16934834176        87748000
9           3801905            0.99  150765568  2758770688        10604000
10          3872820            0.99  365555712  5273034752        21220000
11          4038099            0.99 1009606656  7415914496        42884000
12          4704339            0.99 3102445568 19464646656        87748000
13          7663911            0.98  151576576  2056916992        10604000
14          7725625            0.99  369872896  4120702976        21212000
15          7917525            0.99 1012191232  9221050368        42880000
16          8550745            0.99 3113381888 20408209408        87808000
   memory_size size_verb nb_proc_verb
1    0.2825585   500,000          512
2    0.4299489   500,000        1,024
3    0.9628262   500,000        2,048
4    2.8140421   500,000        4,096
5    0.8944435 1,000,000          512
6    1.0553098 1,000,000        1,024
7    1.5811707 1,000,000        2,048
8    3.4254070 1,000,000        4,096
9    3.3384202 2,000,000          512
10   3.4971116 2,000,000        1,024
11   4.0274084 2,000,000        2,048
12   5.9101348 2,000,000        4,096
13  13.0790605 4,000,000          512
14  13.2755579 4,000,000        1,024
15  13.8251837 4,000,000        2,048
16  15.7636690 4,000,000        4,096
#+end_example

#+begin_src R :results output :session *R* :exports both
  library(ggplot2)
  library(gridExtra)
  library(grid)

  generic_do_plot <- function(plot, fixed_shape=TRUE) {
  #   For xrange, see https://stackoverflow.com/questions/7705345/how-can-i-extract-plot-axes-ranges-for-a-ggplot2-object
  #   old version for xrange (broken)
  #   xrange = ggplot_build(plot)$panel$ranges[[1]]$x.range
  #   new version for xrange (may break in the next ggplot update...)
      xrange = ggplot_build(plot)$layout$panel_ranges[[1]]$x.range
      xwidth = xrange[2] - xrange[1]
      if(fixed_shape) {
          point = stat_summary(fun.y = mean, geom="point", shape=21)
      }
      else {
          point = stat_summary(fun.y = mean, geom="point")
      }
      return(plot +
          stat_summary(fun.data = mean_se, geom = "errorbar", width=xwidth/20)+
          stat_summary(fun.y = mean, geom="line")+
          point+
          theme_bw()+
          expand_limits(x=0, y=0))
  }
  do_plot <- function(df, x, y, color, color_title, fixed_val, other_fixed_val=-1) {
      if(y == "simulation_time") {
          y_title = "Simulation time (seconds)"
          title = "Simulation time"
      }
      else if(y == "memory_size") {
          y_title = "Memory consumption (bytes)"
          title = "Memory consumption"
      }
      else {
          stopifnot(y == "Gflops")
          y_title = "Performance estimation (Gflops)"
          title = "Performance estimation"
      }
      if(x == "size") {
          fixed_arg = "nb_proc"
          x_title = "Matrix size"
          title = paste(title, "for different matrix sizes\nUsing", fixed_val, "MPI processes")
      }
      else {
          stopifnot(x == "nb_proc")
          fixed_arg = "size"
          x_title = "Number of processes"
          title = paste(title, "for different number of processes\nUsing a matrix size of", format(fixed_val,big.mark=",",scientific=FALSE))
      }
      sub_df = df[df[fixed_arg] == fixed_val,]
      p = generic_do_plot(ggplot(sub_df, aes_string(x=x, y=y, linetype=color, color=color, group=color))) +
          ggtitle(title)+
          xlab(x_title)+
          ylab(y_title)+
          labs(colour=color_title)+
          labs(linetype=color_title)
      if(other_fixed_val != -1) {
          rect <- data.frame(xmin=-Inf, xmax=Inf, ymin=-Inf, ymax=Inf)
          my_xmin = other_fixed_val * 0.9
          my_xmax = other_fixed_val * 1.1
          my_ymax = max(sub_df[sub_df[x] == other_fixed_val,][y])
          y_delta = my_ymax * 0.1
          my_ymax = my_ymax + y_delta
          my_ymin = min(sub_df[sub_df[x] == other_fixed_val,][y]) - y_delta
          p = p + geom_rect(data=rect, aes(xmin=my_xmin, xmax=my_xmax, ymin=my_ymin, ymax=my_ymax),color="grey20", alpha=0.1, inherit.aes=FALSE)
      }
      return(p)
  }

  # From https://stackoverflow.com/a/38420690/4110059
  grid_arrange_shared_legend <- function(..., nrow = 1, ncol = length(list(...)), position = c("bottom", "right")) {

    plots <- list(...)
    position <- match.arg(position)
    g <- ggplotGrob(plots[[1]] + theme(legend.position = position))$grobs
    legend <- g[[which(sapply(g, function(x) x$name) == "guide-box")]]
    lheight <- sum(legend$height)
    lwidth <- sum(legend$width)
    gl <- lapply(plots, function(x) x + theme(legend.position = "none"))
    gl <- c(gl, nrow = nrow, ncol = ncol)

    combined <- switch(position,
                       "bottom" = arrangeGrob(do.call(arrangeGrob, gl),
                                              legend,
                                              ncol = 1,
                                              heights = unit.c(unit(1, "npc") - lheight, lheight)),
                       "right" = arrangeGrob(do.call(arrangeGrob, gl),
                                             legend,
                                             ncol = 2,
                                             widths = unit.c(unit(1, "npc") - lwidth, lwidth)))
    grid.newpage()
    grid.draw(combined)

  }

  do_multiple_plot <- function(df, x1, x2, y, color, color_title, fixed_x1, fixed_x2) {
      my_ymax = max(df[y])
      return(
          grid_arrange_shared_legend(
              do_plot(df, x1, y, color, color_title, fixed_x1, fixed_x2) + expand_limits(x=0, y=my_ymax),
              do_plot(df, x2, y, color, color_title, fixed_x2, fixed_x1) + expand_limits(x=0, y=my_ymax),
              nrow=1, ncol=2
          ))
  }

  do_four_plot <- function(df, x1, x2, y1, y2, color, color_title, fixed_x1, fixed_x2) {
      my_y1max = max(df[y1])
      my_y2max = max(df[y2])
      return(
          grid_arrange_shared_legend(
              do_plot(df, x1, y1, color, color_title, fixed_x1, fixed_x2) + expand_limits(x=0, y=my_y1max),
              do_plot(df, x2, y1, color, color_title, fixed_x2, fixed_x1) + expand_limits(x=0, y=my_y1max),
              do_plot(df, x1, y2, color, color_title, fixed_x1, fixed_x2) + expand_limits(x=0, y=my_y2max),
              do_plot(df, x2, y2, color, color_title, fixed_x2, fixed_x1) + expand_limits(x=0, y=my_y2max),
              nrow=2, ncol=2
          ))
  }
#+end_src

#+RESULTS:

#+begin_src R :file figures/scalability_2.pdf :results value graphics :results output :session *R* :exports both :width 4 :height 2.5
nbproc_time = generic_do_plot(ggplot(results, aes(x=nb_proc, y=simulation_time, color=size_verb))) +
    xlab("Number of processes") +
    ylab("Simulation time (hours)") +
    labs(colour="Matrix size")+
    ggtitle("Simulation time for different number of processes")+
    theme(legend.position = "none")+
    geom_text_repel(
        data = subset(results, nb_proc == max(nb_proc)),
        aes(label = size_verb),
        nudge_x = 45,
        segment.color = NA,
        show.legend = FALSE
      )
nbproc_time
#+end_src

#+RESULTS:
[[file:figures/scalability_2.pdf]]

#+begin_src R :file figures/scalability_4.pdf :results value graphics :results output :session *R* :exports both :width 4 :height 2.5
nbproc_mem = generic_do_plot(ggplot(results, aes(x=nb_proc, y=memory_size, color=size_verb))) +
    xlab("Number of processes") +
    ylab("Memory consumption (gigabytes)") +
    labs(colour="Matrix size")+
    ggtitle("Memory consumption for different number of processes")+
    theme(legend.position = "none")+
    geom_text_repel(
        data = subset(results, nb_proc == max(nb_proc)),
        aes(label = size_verb),
        nudge_x = 45,
        segment.color = NA,
        show.legend = FALSE
    )
nbproc_mem
#+end_src

#+RESULTS:
[[file:figures/scalability_4.pdf]]


#+begin_src R :file figures/scalability_1.pdf :results value graphics :results output :session *R* :exports both :width 4 :height 2.5
size_time = generic_do_plot(ggplot(results, aes(x=size, y=simulation_time, color=nb_proc_verb))) +
    xlab("Matrix rank") +
    ylab("Simulation time (hours)") +
    labs(colour="Number of processes")+ scale_color_brewer(palette="Set1")+
#    ggtitle("Simulation time for different matrix sizes")+
    theme(legend.position = "none")+
    geom_text_repel(
        data = subset(results, size == max(size)),
        aes(label = nb_proc_verb),
        nudge_x = 45,
        segment.color = NA,
        show.legend = FALSE
      )
size_time
#+end_src

#+RESULTS:
[[file:figures/scalability_1.pdf]]

#+begin_src R :file figures/scalability_3.pdf :results value graphics :results output :session *R* :exports both :width 4 :height 2.5
size_mem = generic_do_plot(ggplot(results, aes(x=size, y=memory_size, color=nb_proc_verb))) +
    xlab("Matrix rank") +
    ylab("Memory consumption (gigabytes)") +
    labs(colour="Number of processes")+
#    ggtitle("Memory consumption for different matrix sizes")+
    theme(legend.position = "none")+scale_color_brewer(palette="Set1")+
    geom_text_repel(
        data = subset(results, size == max(size)),
        aes(label = nb_proc_verb),
        nudge_x = 45,
        segment.color = NA,
        show.legend = FALSE
      )
size_mem
#+end_src

#+RESULTS:
[[file:figures/scalability_3.pdf]]

#+begin_src R :file figures/scalability_plot_size.pdf :results value graphics :results output :session *R* :exports both :width 7 :height 4
grid_arrange_shared_legend(size_time, size_mem, nrow=1, ncol=2)
#+end_src

#+RESULTS:
[[file:figures/scalability_plot_size.pdf]]

#+begin_src R :file figures/scalability_plot_nbproc.pdf :results value graphics :results output :session *R* :exports both :width 8 :height 3.5
grid_arrange_shared_legend(nbproc_time, nbproc_mem, nrow=1, ncol=2)
#+end_src

#+RESULTS:
[[file:figures/scalability_plot_nbproc.pdf]]


#+begin_src R :results output :session *R* :exports both
fit_sim = lm(data=results, simulation_time ~ nb_proc*(size+I(size^2)))
summary(fit_sim)
#+end_src

#+RESULTS:
#+begin_example

Call:
lm(formula = simulation_time ~ nb_proc * (size + I(size^2)), 
    data = results)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.192256 -0.050079 -0.004809  0.045721  0.231054 

Coefficients:
                    Estimate Std. Error t value Pr(>|t|)    
(Intercept)       -1.522e-01  1.866e-01  -0.815   0.4339    
nb_proc           -1.162e-04  7.907e-05  -1.469   0.1725    
size               6.919e-08  2.214e-07   0.313   0.7610    
I(size^2)         -8.691e-14  4.689e-14  -1.853   0.0935 .  
nb_proc:size       1.608e-09  9.379e-11  17.142 9.64e-09 ***
nb_proc:I(size^2)  3.450e-16  1.987e-17  17.366 8.49e-09 ***
---
Signif. codes:  0 *** 0.001 ** 0.01 * 0.05 . 0.1   1

Residual standard error: 0.1343 on 10 degrees of freedom
Multiple R-squared:  0.9999,	Adjusted R-squared:  0.9999 
F-statistic: 2.46e+04 on 5 and 10 DF,  p-value: < 2.2e-16
#+end_example

#+begin_src R :results output :session *R* :exports both
grid.lines = 26
x.pred <- seq(min(results$nb_proc), max(results$nb_proc), length.out = grid.lines)
y.pred <- seq(min(results$size), max(results$size), length.out = grid.lines)
xy <- expand.grid( nb_proc = x.pred, size = y.pred)
z.pred <- matrix(predict(fit_sim, newdata = xy), 
                 nrow = grid.lines, ncol = grid.lines)
# fitted points for droplines to surface
fitpoints <- predict(fit_sim)
#+end_src

#+RESULTS:

#+begin_src R :results output graphics :file (org-babel-temp-file "figure" ".png") :exports both :width 600 :height 400 :session *R* 
library("plot3D")
scatter3D(
   results$nb_proc, results$size, results$simulation_time, ticktype = "detailed", phi = 20, theta = -50, bty ="g",
    pch = 20, cex = 2, type="l", r=10,
    surf = list(x = x.pred, y = y.pred, z = z.pred,  
    facets = NA, fit = fitpoints),colvar=NULL)
#+end_src

#+RESULTS:
[[file:/tmp/babel-23284Iao/figure23284S2p.png]]

#+begin_src R :results output graphics :file (org-babel-temp-file "figure" ".png") :exports both :width 600 :height 400 :session *R* 
library("plot3D")
scatter3D(results$nb_proc, results$size, results$simulation_time, ticktype = "detailed", phi = 0, theta = -50, bty ="g",
           surf = list(x = unique(results$nb_proc), y = unique(results$size), z =  matrix(results$simulation_time, nrow=length(unique(results$nb_proc))),  facets = NA))
#+end_src

#+RESULTS:
[[file:/tmp/babel-23284Iao/figure23284QCE.png]]



#+begin_src R :results output :session *R* :exports both
fit_sim = lm(data=results,  memory_size ~ (nb_proc + I(nb_proc^2)) + I(size^2))
summary(fit_sim)
#+end_src

#+RESULTS:
#+begin_example

Call:
lm(formula = memory_size ~ (nb_proc + I(nb_proc^2)) + I(size^2), 
    data = results)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.046408 -0.005840  0.001738  0.011710  0.058452 

Coefficients:
               Estimate Std. Error t value Pr(>|t|)    
(Intercept)  -3.785e-02  2.247e-02  -1.685   0.1179    
nb_proc       1.264e-04  2.519e-05   5.019   0.0003 ***
I(nb_proc^2)  1.288e-07  5.211e-09  24.712 1.17e-11 ***
I(size^2)     8.166e-13  1.063e-15 767.967  < 2e-16 ***
---
Signif. codes:  0 *** 0.001 ** 0.01 * 0.05 . 0.1   1

Residual standard error: 0.02691 on 12 degrees of freedom
Multiple R-squared:      1,	Adjusted R-squared:      1 
F-statistic: 2.043e+05 on 3 and 12 DF,  p-value: < 2.2e-16
#+end_example

#+begin_src R :results output :session *R* :exports both
grid.lines = 26
x.pred <- seq(min(results$nb_proc), max(results$nb_proc), length.out = grid.lines)
y.pred <- seq(min(results$size), max(results$size), length.out = grid.lines)
xy <- expand.grid( nb_proc = x.pred, size = y.pred)
z.pred <- matrix(predict(fit_sim, newdata = xy), 
                 nrow = grid.lines, ncol = grid.lines)
# fitted points for droplines to surface
fitpoints <- predict(fit_sim)
#+end_src

#+RESULTS:

#+begin_src R :results output graphics :file (org-babel-temp-file "figure" ".png") :exports both :width 600 :height 400 :session *R* 
library("plot3D")
scatter3D(
   results$nb_proc, results$size, results$memory_size, ticktype = "detailed", phi = -10, theta = -50, bty ="g",
    pch = 18, cex = 2, 
    surf = list(x = x.pred, y = y.pred, z = z.pred,  
    facets = NA, fit = fitpoints),colvar=NULL)
#+end_src

#+RESULTS:
[[file:/tmp/babel-23284Iao/figure23284e_o.png]]

*** Clearpage                                             :noexport:ignore:
\clearpage\setcounter{page}{6}
* Modeling HPL Kernels and Communications
#+LaTeX: \label{sec:modeling}
As we have explained in Section\ref{sec:em}, most of HPL computation
time is spent in a dozen of specific functions for which a performance
model has to be designed. Most computation kernels have several
parameters from which a very simple model can generally easily be
identified (e.g., proportional to the product of the parameters) but
refinements including the contribution of each parameter individually
as well as the spatial and temporal variability of the operation are
also possible. Likewise, communications between two nodes are mostly
linear with message size but the actual performance can wildly vary
depending on the range of the message size as MPI switches from a
protocol to another whenever needed. In this section we first
introduce some notations to describe the complexity of the models we
have investigated. Then we briefly compare the prediction of these
models with individual measurements of both computation and
communications to illustrate the importance of the model
complexity. The consequence of using simpler modeling options will be
illustrated on HPL as a whole in Section\ref{sec:validation}.
** Modeling Notations
#+LaTeX: \newcommand{\model}[2][]{\ensuremath{\mathcal{M}_{#1}\ifthenelse{\equal{#2}{}}{}{\!-\!}{#2}}\xspace}
#+LaTeX: \newcommand{\modelp}[2][]{\ensuremath{\mathcal{M'}_{#1}\!\ifthenelse{\equal{#2}{}}{}{\!-\!}{#2}}\xspace}
#+LaTeX: \newcommand{\noise}[2][]{\ensuremath{\mathcal{N}_{#1}\ifthenelse{\equal{#2}{}}{}{\!-\!}{#2}}\xspace}
#+LaTeX: \newcommand{\noisep}[2][]{\ensuremath{\mathcal{N'}_{#1}\!\ifthenelse{\equal{#2}{}}{}{\!-\!}{#2}}\xspace}
#+LaTeX: \newcommand{\norm}{\ensuremath{N}\xspace}
#+LaTeX: \newcommand{\mcdots}{\ensuremath{\!\cdot\!\cdot\!\cdot\!}\xspace}
We denote as $T$ the duration of an operation whose parameters are
$M$, $N$, $K$, \dots In the case of the =dgemm= (matrix-matrix product)
operation, these parameters describe the geometry of the input
matrices. We first consider the three following modeling options:
- Modeling option \model{0}: For simple and stable
  computation kernels, the duration can be modeled as a constant
  duration independent of the input parameters, \ie $T \sim \alpha$, where
  $\alpha$ is estimated through the sample average of the duration of the
  operation. 
- Modeling option \model{1}: A simple combination of the parameters
  (e.g., $S=M.N.K$) may be the primary factor driving the performance of
  the operation. Then $T \sim \alpha.S ~(+ \beta)$ and $\alpha$ and $\beta$ can be
  estimated through a classical least-square linear regression.
- Modeling option \model{2}: When the behavior of the operation is complex
  or requires a faithful modeling over the full range of input
  parameters, a full polynomial model is required, \ie $T \sim
  \alpha.M.N.K + \beta.M.N + \gamma.N.P + \dots$ Again, the $\alpha,\beta,\gamma,\dots$ can be
  estimated through a classical least-square linear regression.
There are two situations where more elaborate variations need to be
considered:
- The platform may be slightly heterogeneous (spatial variability) and
  the previous models should then be built for each host
  individually. We denote this modeling option as \model[H]{}.
- The behavior of the operation may be mosly linear but solely on
  particular parameter ranges. This is for example the case for
  networking operations or for computing nodes on Stampede where the
  MKL will use the Xeon Phi accelerator only when the input is large
  enough to compensate for the data transfer. In such situations, the
  models considered will be piece-wise linear, e.g.,
  #+BEGIN_EXPORT latex
  $T \sim \begin{cases} 
      \text{if } M<\theta_1 & \alpha_1.M+\beta_1 \\
      \text{else if } M<\theta_2 & \alpha_2.M+\beta_2 \\
      ... \end{cases},$
  #+END_EXPORT
  where the $\theta, \alpha, \beta$ should all be estimated. We denote this kind of
  model as \modelp{}.
All previous models can be fit with relatively simple linear
regressions or maximum likelihood learning methods. However, an
important hypothesis underlying all these methods is the
homoscedasticity, \ie that the variability is independent on the
parameters. 

#+BEGIN_EXPORT latex
\begin{figure*}[!b]
  \begin{minipage}[t]{.6\linewidth}\null\vspace{-.75em}
    \subfigure[\texttt{dgemm} heterogeneity\label{fig:dgemm_het}]{\includegraphics[width=.45\linewidth]{figures/kernels/dgemm_heterogeneity_calib.png}}%
    \subfigure[\texttt{dgemm} model\label{fig:dgemm_poly}]{\includegraphics[width=.45\linewidth]{figures/kernels/dgemm_model_calib.png}}
    \caption{Illustrating the realism of modeling for BLAS functions.}
    \label{fig:blas_var}
  \end{minipage}\hfill%
  \begin{minipage}[t]{.39\linewidth}
    \subfigure[\texttt{HPL\_dlatcpy} model]{\includegraphics[width=\linewidth]{figures/kernels/dlatcpy_model.png}}
    \caption{Illustrating the realism of modeling for HPL functions.}
    \label{fig:HPL_var}
  \end{minipage}
\end{figure*}
#+END_EXPORT
The residual (temporal) variability may be an important phenomenon to
account for, as "system noise" is known to be detrimental to overall
performance of parallel applications like HPL. We therefore consider
different modeling options for this temporal variability.
- Noise option \noise{0} (no noise): The simplest option consists in simply
  injecting the value predicted by the model, \ie $T \sim \model{}(M,N,K) + 0$.
- Noise option \noise{1} (homoscedastic): The simplest probability family to model
  variability is the normal distribution, hence $T \sim \model{}(M,N,K) +
  \norm(0,\sigma^2)$, where $\sigma^2$ is the sample variance of the model
  residuals.
- Noise option \noise{2} (heteroscedastic): The residuals (\ie the previous $\sigma^2$ term)
  is modeled by polynomial function of the input parameters.
  # ($M,N,K$).
Finally, even sophisticated normal distribution from \noise{2} may be
too simple to describe the noise observed on real platforms where it
may be common for a same parameter set to have a few operations being
one order of magnitude slower than all the other ones. In this case, a
reasonable option consists in modeling noise with a mixture of normal
distribution whose parameters $\pi_1 , \dots, \pi_k$, should be estimated. We
denote this kind of model as \noisep{}. Likewise the per-host
estimations are denoted by \noise[H]{}.

 # |    | N0                | N1                | N2                    | N3                                       |
 # |----+-------------------+-------------------+-----------------------+------------------------------------------|
 # | M0 | mean              | mean, sd          | -                     | sample histogram or estimate half-normal |
 # | M1 | linear regression | linear regression | normalize by size, sd | normalize by size + \uparrow                    |
 # | M2 | linear regression | linear regression | Bayesian sampling     | Bayesian sampling                        |
Linear regression is a standard tool in R\cite{R} or in
python/statsmodels\cite{statsmodels} and models \model[H]{0\mcdots2} are
thus easy to fit assuming \noise{1}. Model \modelp{0} assuming
\noise{1} (piece-wise constant) can easily be fit using the
=cubist=\cite{cubist} library. We could not find any implementation
allowing to fit \modelp{1} (piece-wise linear, possibly discontinuous)
assuming \noise{1} so we implemented the method of Hastie
\etal\cite{hastie_book} in a python library (=pytree=). When the noise
is heteroscedastic (\noise{2}), it is sometimes possible to fall back
to the previous methods if a careful sampling method is employed (by
sampling more on highly variable areas and fitting the
average). Finally, for even more complex noise modeling options
(\noisep), some custom Expectation Maximization algorithms are
available (e.g., clustering with =mclust=\cite{mclust} for
\model{0}\noisep{1} or with =flexmix=\cite{flexmix}for
\model{1}\noisep{1}). Ideally, a full and unified
Bayesian estimation could be made with frameworks like
STAN\cite{stan}. Such effort is underway but the previous libraries
were sufficient for our needs.
#+BEGIN_EXPORT latex
\begin{figure}[!h]
  \centering \subfigure[Stampede]{\includegraphics[width=.47\linewidth]{./figures/network/stampede.png}}\hfill
  \subfigure[Dahu]{\includegraphics[width=.47\linewidth]{./figures/network/dahu.png}}
  \caption{Illustrating piecewise linearity and temporal variability of high-speed communications on two systems.}
  \label{fig:nw_var}
\end{figure}
#+END_EXPORT

** Modeling MPI communications
Prior to this work, the standard way of accounting for protocol
changes in SMPI was to estimate breakpoints visually and to
conduct a linear regression for each range. The expected duration was
then used directly in the simulation with no particular effort with
respect to the temporal variability (\modelp{1}\noise{0}). Yet, as illustrated 
on Figure\ref{fig:nw_var}, the variability of high speed networks 
quite particular. We
therefore took care of correctly estimating all the parameters for
\modelp{1}\noisep{1}, where each message size range is automatically estimated with
=pytree=, as well as of the 2 to 4 modes of the Gaussian mixture for each
range. Such temporal variability could explain some (overall bad)
performance since they generally get amplified by broadcast and
pipelined communication patterns.


# - SimGrid priori this work: M1' + N0. Breakpoint estimation was manual.
# - Proposal: M1' + N1' (pytree + flexmix)
# - Future work: M1' + N3' (pytree + flexmix + STAN)
** Modeling =dgemm=
=dgemm= is the computation kernel in which HPL spends most of the
time. Therefore, we evaluated the previous modeling alternatives:
#+LaTeX: \model{\{1,2\}}\noise{\{0,1,2\}} and \model[H]{\{1,2\}}\noise[H]{\{0,1,2\}}. 
The \modelp{} and \noisep{} families were not investigated as nothing
in our observations called for such complexity on classical multi-core
machines. Figure\ref{fig:blas_var} illustrates various models and
their respective quality for the =dgemm= function. In these figures, the
performance of =dgemm= is evaluated by calling =dgemm= with randomized
sizes over the whole node (to reproduce experimental conditions
similar to the one of HPL). The first observation
(Figure\ref{fig:dgemm_het}) is that a few nodes exhibit quite a
different behavior (each color and each regression line under model
\model[H]{1} corresponds to a different cpu, whereas the black dotted
line correspond to model \model{1} over all the nodes). These nodes
will systematically be slightly slower than other nodes and accounting
for this spatial heterogeneity is likely to be rather important for
HPL. Likewise, it is also common that the cores of two CPUs of the
same node have a significantly different performance. Second, the
range of values for $M$, $N$, and $K$ is uniform over ??? and it is
interesting to note that $M.N.K$ is not sufficient to describe correctly
the performance of =dgemm=. Indeed, for $M.N.K \approx \num{4.5E9}$ some
duration are systematically quite slow regardless of the node. This
happens for some particular (e.g., tall and skinny) matrix geometries,
which calls using the full polynomial
model. Figure\ref{fig:dgemm_poly} depicts the performance (red dots)
of a given node as well as the prediction using a simple linear model
(\model[H]{1}, black line), a full polynomial model (\model[H]{2},
blue dots) and a full polynomial model with heroscedastic noise
(\model[H]{2}\noise{2}, orange dots). A close inspection reveals that
all experimental variability is actually very well explained by both the
polynomial model (better fit for particular combinations of
parameters) and some temporal variability.
# Full modeling of DGEMM (Modeling option 2 + Noise option 4) is
#   - T \sim \alpha.M.N.K + \beta.M.N + ... +  |N(0,\alpha'.MNK + ....) |
#   - T \sim \alpha (M.N.K + |N(0,\sigma^2)|) but part of the noise can be explained
#     by M, N, and K.
#   - T \sim \alpha.M.N.K
# The consequence of using simpler options are already visible but will
# be illustrated later.
** Modeling Other BLAS and HPL Kernels
Four other BLAS kernels and a few other very small HPL computation
kernels (often related to memory management) are deeply intertwined
with collective operations to allow HPL to be as efficient as
possible. Although the total duration of these kernels is extremely
small compared to the total execution time, they may perturb
collective communication by introducing late sends and receives. The
behavior of one of these kernels is illustrated in
Figure\ref{fig:HPL_var}. This kind of data can only be obtained by
running HPL for a small input matrix over each node
individually. Again, for all these kernels a single parameter
combination explains most of the performance and there some
variability from a node to an other (one blue regression lines per
CPU) but it remains quite limited (black dotted line for the platform
as a whole), especially since these kernels are very short and
infrequently called compared to =dgemm=. Last, since variability clearly
increases with input parameters, a \noise{2} is clearly required. The
blue dots in Figure\ref{fig:HPL_var} therefore represent the outcome
of a \model{1}\noise{2} model and are hardly distinguishable from the
real behavior. It turns out that for all these kernels similar
results could be obtained with such kind of model.
** Clearpage                                               :noexport:ignore:
\clearpage\setcounter{page}{8}
** Network plots                                                  :noexport:
*** Downloading the CSV
#+begin_src sh :results output :exports both
mkdir -p data/network_calibration/
cd data/network_calibration/
mkdir -p stampede && cd stampede
wget -c https://gitlab.inria.fr/simgrid/platform-calibration/raw/master/data/stampede_17_06_01-17:14/calibration/testplatform_PingPong.csv -O pingpong.csv
wget -c https://gitlab.inria.fr/simgrid/platform-calibration/raw/master/data/stampede_17_06_01-17:14/calibration/testplatform_Recv.csv -O recv.csv
cd ..
mkdir -p dahu && cd dahu
wget -c https://github.com/Ezibenroc/mpi_calibration/raw/master/dahu/mpi/grenoble_2018-08-29_1808878.zip -O archive.zip
unzip -p archive.zip exp/exp_PingPong.csv > pingpong.csv
unzip -p archive.zip exp/exp_Recv.csv > recv.csv
#+end_src
*** Drawing the regression plots
#+begin_src R :results output :session *R* :exports both
library(ggplot2)
library(dplyr)
library(gridExtra)

read_csv <- function(filename) {
    df = read.csv(filename, header=F)
    colnames(df) = c('func', 'msg_size', 'start', 'duration')
#    df = df[sample(nrow(df), 1000), ]  # take only some points, for quick prototyping of the plot
    return(df)
}

draw_reg <- function(df, breakpoints) {
    i = 1
    df$group = 0
    for(bp in breakpoints) {
        df[df$msg_size > bp,]$group = i
        i = i+1
    }
    df$group = as.factor(df$group)
    func = unique(df$func)
    plot = ggplot(df, aes(x=msg_size, y=duration, color=group)) + geom_point(size=.5, alpha=0.1)
    plot = plot + scale_x_log10() + scale_y_log10() + theme_bw() + scale_color_discrete(guide=F)
    plot = plot + xlab('Message size (bytes)')  + ylab('duration\n (seconds)') # + ylab(paste(unique(df$func), 'duration\n (seconds)'))
    plot = plot + annotate(geom='text', label=func, size=5, x=50, y=5e-5)
    plot = plot + expand_limits(y=0.00022)  # to get the same scale on all plots
    plot = plot + expand_limits(y=1e-07)
    for(grp in unique(df$group)) {
        tmp = df[df$group == grp,]
        reg = lm(duration~msg_size, tmp)
        tmp$pred = predict(reg, tmp)
        plot = plot + geom_line(aes(y=pred), data=tmp, color='black')
    }
    for(bp in breakpoints) {
        plot = plot + geom_vline(xintercept=bp, linetype='dashed')
    }
    return(plot)
}

draw_mpi_reg <- function(platform, breakpoints) {
    pingpong_file = paste('data/network_calibration', platform, 'pingpong.csv', sep='/')
    recv_file     = paste('data/network_calibration', platform, 'recv.csv',     sep='/')
    df_pingpong = read_csv(pingpong_file)
    df_send = df_pingpong %>% filter(func == 'MPI_Send')
    df_recv = read_csv(recv_file)
    plot_send = draw_reg(df_send, breakpoints)
    plot_recv = draw_reg(df_recv, breakpoints)
    return(grid.arrange(plot_send, plot_recv, nrow=2))
}
#+end_src

#+RESULTS:

#+begin_src R :results output graphics :file (org-babel-temp-file "figure" ".png") :exports both :width 300 :height 400 :session *R*
plot = draw_mpi_reg('dahu', c(8133, 15831, 33956, 64000))
ggsave(filename='figures/network/dahu.png', plot=plot, width=3,height=4, dpi=200)
plot
#+end_src

#+RESULTS:
[[file:/tmp/babel-19053_Jy/figure19053CHC.png]]

#+begin_src R :results output graphics :file (org-babel-temp-file "figure" ".png") :exports both :width 300 :height 400 :session *R*
plot = draw_mpi_reg('stampede', c(150, 5000, 17420, 110000))
ggsave(filename='figures/network/stampede.png', plot=plot, width=3,height=4, dpi=200)
plot
#+end_src

#+RESULTS:
[[file:/tmp/babel-19053_Jy/figure19053PRI.png]]

** Kernels plots                                                  :noexport:
*** Downloading the CSV
The file trace_functions.csv has been generated with this [[https://github.com/Ezibenroc/mpi_calibration/blob/74870b0d26497cf623c47a747e2f089eedb62857/dahu/hpl/hpl_trace_simple.ipynb][notebook]] (the dump to
the CSV file happens in cells 25-26). The notebook uses this [[https://github.com/Ezibenroc/mpi_calibration/blob/74870b0d26497cf623c47a747e2f089eedb62857/dahu/smpi_hpl/grenoble_2019-04-03_1858209.zip][ZIP archive]].

The file dgemm_calibration.csv has been generated with this [[https://github.com/Ezibenroc/mpi_calibration/blob/df5a957901fac35a3df0bd466acea7d6199a9426/dahu/blas/dgemm_heterogeneous_model.ipynb][notebook]] (the dump
to the CSV file happens in cell 38). The notebook uses these [[https://github.com/Ezibenroc/mpi_calibration/tree/26fdfbb565e1eb5b9f1015a47ddd8fe9aaa424e5/dahu/blas/heterogeneity_exp/7][ZIP archives]].

#+begin_src sh :results output :exports both
mkdir -p data/kernel_calibration/
cd data/kernel_calibration/
wget -c https://github.com/Ezibenroc/mpi_calibration/raw/master/dahu/smpi_hpl/paper_sc19/traces/2/trace_functions.csv
sed 's/function/func/g' -i trace_functions.csv  # cannot have a column named "function" in R...
wget -c https://github.com/Ezibenroc/mpi_calibration/raw/master/dahu/blas/dgemm_calibration.csv
sed 's/function/func/g' -i dgemm_calibration.csv  # cannot have a column named "function" in R...
#+end_src

#+RESULTS:

*** Drawing the regression plots
There are several interesting functions in the CSV file. For each function,
there are real observations *and* predictions, the column "mode" can be used to
distinguish them.

**** DGEMM from a calibration

#+begin_src R :results output :session *R* :exports both
library(ggplot2)
options(crayon.enabled = FALSE)
df = read.csv('data/kernel_calibration/dgemm_calibration.csv')
str(df)
#+end_src

#+RESULTS:
#+begin_example
'data.frame':	5004288 obs. of  14 variables:
 $ func        : Factor w/ 1 level "dgemm": 1 1 1 1 1 1 1 1 1 1 ...
 $ m           : int  378 378 378 9441 9441 9441 1041 1041 1041 1248 ...
 $ n           : int  7640 7640 7640 640 640 640 2183 2183 2183 1343 ...
 $ k           : int  2427 2427 2427 1160 1160 1160 735 735 735 1991 ...
 $ timestamp   : num  3473 3474 3474 3475 3475 ...
 $ duration    : num  0.486 0.486 0.487 0.455 0.454 ...
 $ prediction  : num  0.522 0.522 0.522 0.485 0.485 ...
 $ noise       : num  0.000512 -0.004775 0.001385 -0.001869 0.004448 ...
 $ pred_noise  : num  0.522 0.517 0.523 0.483 0.489 ...
 $ node        : int  10 10 10 10 10 10 10 10 10 10 ...
 $ core        : int  0 0 0 0 0 0 0 0 0 0 ...
 $ cpu         : int  20 20 20 20 20 20 20 20 20 20 ...
 $ index       : int  0 1 2 3 4 5 6 7 8 9 ...
 $ index_in_seq: int  0 1 2 0 1 2 0 1 2 0 ...
#+end_example

#+begin_src R :results output :session *R* :exports both
## df$node = 1 + df$rank %/% 32
## df$cpu = 2*df$node + df$rank %% 2
df$m = as.numeric(df$m)
df$n = as.numeric(df$n)
df$k = as.numeric(df$k)
## df$mnk = df$m * df$n * df$k
## df$mn = df$m * df$n
## df$mk = df$m * df$k
## df$nk = df$n * df$k
str(df)
head(df)
#+end_src

#+RESULTS:
#+begin_example
'data.frame':	5004288 obs. of  14 variables:
 $ func        : Factor w/ 1 level "dgemm": 1 1 1 1 1 1 1 1 1 1 ...
 $ m           : num  378 378 378 9441 9441 ...
 $ n           : num  7640 7640 7640 640 640 ...
 $ k           : num  2427 2427 2427 1160 1160 ...
 $ timestamp   : num  3473 3474 3474 3475 3475 ...
 $ duration    : num  0.486 0.486 0.487 0.455 0.454 ...
 $ prediction  : num  0.522 0.522 0.522 0.485 0.485 ...
 $ noise       : num  0.000512 -0.004775 0.001385 -0.001869 0.004448 ...
 $ pred_noise  : num  0.522 0.517 0.523 0.483 0.489 ...
 $ node        : int  10 10 10 10 10 10 10 10 10 10 ...
 $ core        : int  0 0 0 0 0 0 0 0 0 0 ...
 $ cpu         : int  20 20 20 20 20 20 20 20 20 20 ...
 $ index       : int  0 1 2 3 4 5 6 7 8 9 ...
 $ index_in_seq: int  0 1 2 0 1 2 0 1 2 0 ...
   func    m    n    k timestamp  duration prediction         noise pred_noise
1 dgemm  378 7640 2427  3473.428 0.4859466  0.5217815  0.0005118576  0.5222933
2 dgemm  378 7640 2427  3473.914 0.4861293  0.5217815 -0.0047750420  0.5170064
3 dgemm  378 7640 2427  3474.401 0.4868529  0.5217815  0.0013853568  0.5231668
4 dgemm 9441  640 1160  3474.887 0.4551385  0.4845474 -0.0018686303  0.4826788
5 dgemm 9441  640 1160  3475.343 0.4535278  0.4845474  0.0044477582  0.4889952
6 dgemm 9441  640 1160  3475.796 0.4544535  0.4845474  0.0007154680  0.4852629
  node core cpu index index_in_seq
1   10    0  20     0            0
2   10    0  20     1            1
3   10    0  20     2            2
4   10    0  20     3            0
5   10    0  20     4            1
6   10    0  20     5            2
#+end_example

#+begin_src R :results output :session *R* :exports both
unique(df$node)
unique(df$cpu)
#+end_src

#+RESULTS:
:  [1] 10 26 31  3 13 18  6  7 29  8  2 20 16  9 23 15 32 22 14 19 12 25 30 17 24
: [26] 11  1  5  4 28 21 27
:  [1] 20 21 52 53 62 63  6  7 26 27 36 37 12 13 14 15 58 59 16 17  4  5 40 41 32
: [26] 33 18 19 46 47 30 31 64 65 44 45 28 29 38 39 24 25 50 51 60 61 34 35 48 49
: [51] 22 23  2  3 10 11  8  9 56 57 42 43 54 55

#+begin_src R :results output :session *R* :exports both
set.seed(42)
dgemm = df[sample(nrow(df), 100000), ] # This is too large to be plotted
dgemm = dgemm[dgemm$m*dgemm$n*dgemm$k<1.2E10,]
summary(lm(data=dgemm, duration ~ I(m*n*k):factor(cpu)))
#+end_src

#+RESULTS:
#+begin_example

Call:
lm(formula = duration ~ I(m * n * k):factor(cpu), data = dgemm)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.11522 -0.01048 -0.00429  0.00465  0.40312 

Coefficients:
                            Estimate Std. Error t value Pr(>|t|)    
(Intercept)                7.286e-03  1.895e-04   38.45   <2e-16 ***
I(m * n * k):factor(cpu)2  6.791e-11  1.309e-13  518.72   <2e-16 ***
I(m * n * k):factor(cpu)3  6.598e-11  1.255e-13  525.83   <2e-16 ***
I(m * n * k):factor(cpu)4  6.678e-11  1.285e-13  519.57   <2e-16 ***
I(m * n * k):factor(cpu)5  6.562e-11  1.285e-13  510.70   <2e-16 ***
I(m * n * k):factor(cpu)6  6.639e-11  1.297e-13  511.93   <2e-16 ***
I(m * n * k):factor(cpu)7  6.564e-11  1.290e-13  508.83   <2e-16 ***
I(m * n * k):factor(cpu)8  6.571e-11  1.257e-13  522.58   <2e-16 ***
I(m * n * k):factor(cpu)9  6.578e-11  1.315e-13  500.38   <2e-16 ***
I(m * n * k):factor(cpu)10 6.640e-11  1.296e-13  512.53   <2e-16 ***
I(m * n * k):factor(cpu)11 6.498e-11  1.314e-13  494.67   <2e-16 ***
I(m * n * k):factor(cpu)12 6.800e-11  1.293e-13  525.83   <2e-16 ***
I(m * n * k):factor(cpu)13 6.524e-11  1.305e-13  499.99   <2e-16 ***
I(m * n * k):factor(cpu)14 6.575e-11  1.319e-13  498.29   <2e-16 ***
I(m * n * k):factor(cpu)15 6.493e-11  1.288e-13  504.21   <2e-16 ***
I(m * n * k):factor(cpu)16 6.704e-11  1.304e-13  513.99   <2e-16 ***
I(m * n * k):factor(cpu)17 6.549e-11  1.335e-13  490.44   <2e-16 ***
I(m * n * k):factor(cpu)18 6.561e-11  1.289e-13  509.12   <2e-16 ***
I(m * n * k):factor(cpu)19 6.562e-11  1.316e-13  498.71   <2e-16 ***
I(m * n * k):factor(cpu)20 6.563e-11  1.287e-13  509.88   <2e-16 ***
I(m * n * k):factor(cpu)21 6.552e-11  1.279e-13  512.35   <2e-16 ***
I(m * n * k):factor(cpu)22 6.553e-11  1.292e-13  507.31   <2e-16 ***
I(m * n * k):factor(cpu)23 6.616e-11  1.301e-13  508.46   <2e-16 ***
I(m * n * k):factor(cpu)24 6.574e-11  1.326e-13  495.87   <2e-16 ***
I(m * n * k):factor(cpu)25 6.524e-11  1.317e-13  495.54   <2e-16 ***
I(m * n * k):factor(cpu)26 8.713e-11  1.268e-13  687.18   <2e-16 ***
I(m * n * k):factor(cpu)27 7.167e-11  1.276e-13  561.80   <2e-16 ***
I(m * n * k):factor(cpu)28 7.355e-11  1.237e-13  594.39   <2e-16 ***
I(m * n * k):factor(cpu)29 7.314e-11  1.307e-13  559.58   <2e-16 ***
I(m * n * k):factor(cpu)30 8.033e-11  1.277e-13  628.82   <2e-16 ***
I(m * n * k):factor(cpu)31 7.971e-11  1.248e-13  638.52   <2e-16 ***
I(m * n * k):factor(cpu)32 7.550e-11  1.243e-13  607.29   <2e-16 ***
I(m * n * k):factor(cpu)33 7.458e-11  1.242e-13  600.67   <2e-16 ***
I(m * n * k):factor(cpu)34 7.008e-11  1.287e-13  544.54   <2e-16 ***
I(m * n * k):factor(cpu)35 6.590e-11  1.299e-13  507.49   <2e-16 ***
I(m * n * k):factor(cpu)36 6.932e-11  1.261e-13  549.80   <2e-16 ***
I(m * n * k):factor(cpu)37 6.562e-11  1.302e-13  503.95   <2e-16 ***
I(m * n * k):factor(cpu)38 6.577e-11  1.314e-13  500.63   <2e-16 ***
I(m * n * k):factor(cpu)39 6.561e-11  1.299e-13  505.01   <2e-16 ***
I(m * n * k):factor(cpu)40 6.609e-11  1.265e-13  522.63   <2e-16 ***
I(m * n * k):factor(cpu)41 6.571e-11  1.315e-13  499.61   <2e-16 ***
I(m * n * k):factor(cpu)42 6.594e-11  1.264e-13  521.55   <2e-16 ***
I(m * n * k):factor(cpu)43 6.556e-11  1.302e-13  503.67   <2e-16 ***
I(m * n * k):factor(cpu)44 6.540e-11  1.271e-13  514.54   <2e-16 ***
I(m * n * k):factor(cpu)45 6.583e-11  1.269e-13  518.93   <2e-16 ***
I(m * n * k):factor(cpu)46 6.576e-11  1.264e-13  520.27   <2e-16 ***
I(m * n * k):factor(cpu)47 6.485e-11  1.299e-13  499.12   <2e-16 ***
I(m * n * k):factor(cpu)48 6.571e-11  1.277e-13  514.57   <2e-16 ***
I(m * n * k):factor(cpu)49 6.536e-11  1.287e-13  507.92   <2e-16 ***
I(m * n * k):factor(cpu)50 6.991e-11  1.316e-13  531.20   <2e-16 ***
I(m * n * k):factor(cpu)51 6.498e-11  1.287e-13  504.95   <2e-16 ***
I(m * n * k):factor(cpu)52 6.571e-11  1.295e-13  507.31   <2e-16 ***
I(m * n * k):factor(cpu)53 6.618e-11  1.290e-13  512.99   <2e-16 ***
I(m * n * k):factor(cpu)54 6.580e-11  1.264e-13  520.51   <2e-16 ***
I(m * n * k):factor(cpu)55 6.613e-11  1.288e-13  513.36   <2e-16 ***
I(m * n * k):factor(cpu)56 6.727e-11  1.291e-13  521.17   <2e-16 ***
I(m * n * k):factor(cpu)57 6.565e-11  1.274e-13  515.47   <2e-16 ***
I(m * n * k):factor(cpu)58 6.585e-11  1.287e-13  511.46   <2e-16 ***
I(m * n * k):factor(cpu)59 6.561e-11  1.270e-13  516.45   <2e-16 ***
I(m * n * k):factor(cpu)60 6.611e-11  1.292e-13  511.65   <2e-16 ***
I(m * n * k):factor(cpu)61 6.549e-11  1.282e-13  510.93   <2e-16 ***
I(m * n * k):factor(cpu)62 6.552e-11  1.288e-13  508.73   <2e-16 ***
I(m * n * k):factor(cpu)63 6.565e-11  1.315e-13  499.12   <2e-16 ***
I(m * n * k):factor(cpu)64 6.543e-11  1.297e-13  504.30   <2e-16 ***
I(m * n * k):factor(cpu)65 6.557e-11  1.267e-13  517.44   <2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.02932 on 99772 degrees of freedom
Multiple R-squared:  0.9783,	Adjusted R-squared:  0.9783 
F-statistic: 7.027e+04 on 64 and 99772 DF,  p-value: < 2.2e-16
#+end_example

Regression lines, to show the heterogeneity.
#+begin_src R :results output graphics :file (org-babel-temp-file "figure" ".png") :exports both :width 400 :height 400 :session *R* 
plot = ggplot(dgemm, aes(x=m*n*k, y=duration, color=factor(cpu%%9))) +
    geom_point(alpha=.1,size=.5) + 
    geom_smooth(data=dgemm, aes(group=factor(cpu)), method='lm', se=F, fullrange=T, size=.5) +
    geom_smooth(data=dgemm, color="black", method='lm', se=F, fullrange=T, linetype=4) +
    scale_color_brewer(palette="Set1", guide=F)
plot = plot + theme_bw() + ylab('Duration (s)') + 
    scale_x_continuous(name = 'M.N.K', breaks = (0:4)*3E9, limits=c(0,1.2E10)) + 
    labs(color='CPU') 
ggsave(filename='figures/kernels/dgemm_heterogeneity_calib.png', plot=plot, width=3.4,height=4, dpi=200)
## ggsave(filename="figures/kernels/dgemm_heterogeneity.pdf", plot=plot, width=4,height=4)
plot
#+end_src

#+RESULTS:
[[file:/tmp/babel-19053_Jy/figure19053gme.png]]


#+begin_src R :results output :session *R* :exports both
library(tidyr)
library(forcats)

dgemm2 = dgemm[(dgemm$cpu ==2),]
dgemm2 %>% select(func,m,n,k,duration,prediction,pred_noise,node,core,cpu) %>%
    gather(duration,prediction,pred_noise,key=type,value=duration) -> dgemm2
fake_dgemm = dgemm2[1,] # This is just to add a black legend for geom_smooth
fake_dgemm$m = 0
fake_dgemm$n = 0
fake_dgemm$k = 0
fake_dgemm$type = "fake"
fake_dgemm$duration = 0
dgemm2 = rbind(fake_dgemm, dgemm2)
dgemm2 %>%
    mutate(type = fct_recode(
               fct_relevel(type, "duration", "fake", "prediction", "pred_noise"),
               "Reality"="duration", 
               "M1 (linear)"="fake", 
               "M2 (polynomial)"="prediction",
               "M3 (polynomial + noise)"="pred_noise")) -> dgemm2
dgemm2 %>% mutate(mnk=m*n*k) %>% mutate(type_num = as.numeric(type)) %>%
    group_by(type) %>% 
    mutate(mnk= mnk + type_num*.7E8,
           duration = ifelse(type_num==1,duration,duration/1.05)) %>% # This is because this prediction uses the HPL correction
    ungroup() -> dgemm2
dgemm2 %>% tail(n=10)
dgemm2 %>% str()
#+end_src

#+RESULTS:
#+begin_example
# A tibble: 10 x 11
   func      m     n     k  node  core   cpu type       duration    mnk type_num
   <fct> <dbl> <dbl> <dbl> <int> <int> <int> <fct>         <dbl>  <dbl>    <dbl>
 1 dgemm   900   879  7582     1    28     2 M3 (poly~   4.09e-1 6.28e9        4
 2 dgemm  3136  9602   321     1     8     2 M3 (poly~   6.29e-1 9.95e9        4
 3 dgemm  4272   483  2258     1     8     2 M3 (poly~   3.30e-1 4.94e9        4
 4 dgemm   646 13690  1056     1    16     2 M3 (poly~   6.47e-1 9.62e9        4
 5 dgemm 10411   257   498     1    20     2 M3 (poly~   9.95e-2 1.61e9        4
 6 dgemm     1     1     1     1     8     2 M3 (poly~   7.39e-7 2.80e8        4
 7 dgemm  1623   619  5316     1     8     2 M3 (poly~   3.82e-1 5.62e9        4
 8 dgemm  1241  1033  5196     1    30     2 M3 (poly~   4.63e-1 6.94e9        4
 9 dgemm  4287   416  1304     1    20     2 M3 (poly~   1.60e-1 2.61e9        4
10 dgemm  1475   917  1719     1     8     2 M3 (poly~   1.62e-1 2.61e9        4
Classes 'tbl_df', 'tbl' and 'data.frame':	4627 obs. of  11 variables:
 $ func    : Factor w/ 1 level "dgemm": 1 1 1 1 1 1 1 1 1 1 ...
 $ m       : num  0 11141 7359 3434 518 ...
 $ n       : num  0 591 311 1891 4523 ...
 $ k       : num  0 1115 441 1231 3700 ...
 $ node    : int  1 1 1 1 1 1 1 1 1 1 ...
 $ core    : int  18 18 24 20 16 24 16 4 12 26 ...
 $ cpu     : int  2 2 2 2 2 2 2 2 2 2 ...
 $ type    : Factor w/ 4 levels "Reality","M1 (linear)",..: 2 1 1 1 1 1 1 1 1 1 ...
 $ duration: num  0 0.4987 0.0737 0.5331 0.618 ...
 $ mnk     : num  1.40e+08 7.41e+09 1.08e+09 8.06e+09 8.74e+09 ...
 $ type_num: num  2 1 1 1 1 1 1 1 1 1 ...
#+end_example

#+begin_src R :results output graphics :file (org-babel-temp-file "figure" ".png") :exports both :width 300 :height 400 :session *R*
MSet1 <- c("#E41A1C", "#000000", "#377EB8", "#FF7F00", 
           "#FFFF33", "#A65628", "#F781BF", "#999999");
plot = ggplot(dgemm2, aes(x=mnk, y=duration,color=type)) + 
    geom_point(alpha=0.3,size=.3) + xlim(0,1.2E10)
    ## geom_point(aes(x=m*n*k+.5E8, y=prediction/1.05),alpha=0.3, color="blue") +
    ## geom_point(aes(x=m*n*k+1E8, y=pred_noise/1.05),alpha=0.3, color="green")
plot = plot + theme_bw() + ylab('Duration (s)') + 
        scale_x_continuous(name = 'M.N.K', breaks = (0:4)*3E9, limits=c(0,1.2E10)) 
plot = plot + scale_color_manual(values=MSet1, guide=F) + labs(color='Mode') + #    scale_color_brewer(palette="Set1")
    theme(legend.position = c(0.67,0.17), legend.title=element_blank()) +
    geom_smooth(data=dgemm2[dgemm2$type=="Reality",], size=.2,
                color="black", method='lm', se=F, fullrange=T) +
    guides(colour = guide_legend(override.aes = list(alpha = 1)))
ggsave(filename="figures/kernels/dgemm_model_calib.png", plot=plot, width=3.4,height=4, dpi=200)
plot
#+end_src

#+RESULTS:
[[file:/tmp/babel-19053_Jy/figure19053TcY.png]]
**** DGEMM from HPL  (DEPRECATED, DO NOT RUN)                   :noexport:
#+begin_src R :results output :session *R* :exports both
dgemm = df[(df$func == 'dgemm') & (df$mode == 'reality'),]
summary(lm(data=dgemm, duration ~ I(m*n*k):factor(cpu)))
#+end_src

#+RESULTS:
#+begin_example

Call:
lm(formula = duration ~ I(m * n * k):factor(cpu), data = dgemm)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.41411 -0.00186 -0.00139  0.00104  0.42966 

Coefficients:
                            Estimate Std. Error t value Pr(>|t|)    
(Intercept)                2.020e-03  8.787e-05   22.98   <2e-16 ***
I(m * n * k):factor(cpu)2  6.790e-11  3.322e-14 2043.67   <2e-16 ***
I(m * n * k):factor(cpu)3  6.825e-11  3.290e-14 2074.40   <2e-16 ***
I(m * n * k):factor(cpu)4  6.799e-11  3.335e-14 2038.54   <2e-16 ***
I(m * n * k):factor(cpu)5  6.767e-11  3.292e-14 2055.37   <2e-16 ***
I(m * n * k):factor(cpu)6  6.679e-11  3.348e-14 1995.27   <2e-16 ***
I(m * n * k):factor(cpu)7  6.701e-11  3.306e-14 2027.08   <2e-16 ***
I(m * n * k):factor(cpu)8  6.593e-11  3.309e-14 1992.18   <2e-16 ***
I(m * n * k):factor(cpu)9  6.571e-11  3.270e-14 2009.51   <2e-16 ***
I(m * n * k):factor(cpu)10 6.774e-11  3.340e-14 2028.37   <2e-16 ***
I(m * n * k):factor(cpu)11 6.820e-11  3.300e-14 2066.43   <2e-16 ***
I(m * n * k):factor(cpu)12 6.665e-11  3.357e-14 1985.21   <2e-16 ***
I(m * n * k):factor(cpu)13 6.862e-11  3.309e-14 2073.58   <2e-16 ***
I(m * n * k):factor(cpu)14 6.564e-11  3.329e-14 1971.86   <2e-16 ***
I(m * n * k):factor(cpu)15 6.554e-11  3.286e-14 1994.85   <2e-16 ***
I(m * n * k):factor(cpu)16 6.829e-11  3.368e-14 2027.41   <2e-16 ***
I(m * n * k):factor(cpu)17 6.781e-11  3.324e-14 2039.94   <2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.0225 on 68061 degrees of freedom
Multiple R-squared:  0.9989,	Adjusted R-squared:  0.9989 
F-statistic: 3.966e+06 on 16 and 68061 DF,  p-value: < 2.2e-16
#+end_example

# I(m * n * k):factor(cpu)15 6.554e-11  3.286e-14 1994.85   <2e-16 ***
# I(m * n * k):factor(cpu)7  6.701e-11  3.306e-14 2027.08   <2e-16 ***
# I(m * n * k):factor(cpu)13 6.862e-11  3.309e-14 2073.58   <2e-16 ***

Regression lines, to show the heterogeneity.
#+begin_src R :results output graphics :file (org-babel-temp-file "figure" ".png") :exports both :width 600 :height 400 :session *R* 
cpu_sel1 = c(7,8,12,13,4,15);
cpu_sel2 = c(cpu_sel1,16,17); # 2,5,9,12,
dgemm = df[(df$func == 'dgemm') & (df$mode == 'reality'),];
dgemm_sel1 = dgemm[dgemm$cpu %in% cpu_sel1,];
dgemm_sel2 = dgemm[dgemm$cpu %in% cpu_sel2,];
MSet1 <- c("#EE0000", "#E41A1C", "#377EB8", "#4DAF4A", "#984EA3", "#FF7F00",
           "#FFFF33", "#A65628", "#F781BF", "#999999");
plot = ggplot(dgemm_sel2, aes(x=m*n*k, y=duration, color=factor(cpu))) +
    geom_point(alpha=.2) + 
    geom_smooth(data=dgemm_sel1, method='lm', se=F, fullrange=T, size=.5) +
    geom_smooth(data=dgemm, color="black", method='lm', se=F, fullrange=T, linetype=4) + 
    scale_color_manual(values=MSet1, guide=F)
plot = plot + theme_bw() + ylab('Duration (s)') + xlab('M.N.K') +  labs(color='CPU') + xlim(0,9E10)
ggsave(filename="figures/kernels/dgemm_heterogeneity.pdf", plot=plot, width=4,height=4)
plot
#+end_src

#+RESULTS:
[[file:/tmp/babel-19053_Jy/figure190537Ok.png]]

Scatter plot for one CPU, to show the time variability.

For the model, we use the coefficients currently used for [[https://github.com/Ezibenroc/hpl/blob/1425f27cd3c7bce472fff5455a15e807ed3b637b/src/blas/HPL_dgemm.c#L235-L238][CPU 4]] that were
computed in [[https://github.com/Ezibenroc/mpi_calibration/blob/6ecf77050064dcc790b96891fe1ff55a60022d3d/dahu/blas/dgemm_heterogeneous_model.ipynb][this notebook]] (see cell 35).
#+begin_src R :results output graphics :file (org-babel-temp-file "figure" ".png") :exports both :width 600 :height 400 :session *R*
dgemm = df[(df$func == 'dgemm') & (df$cpu == 4) & (df$mode == 'reality'),]
dgemm$pred = 5.329919e-07 + 7.018230e-11*dgemm$mnk + -4.171307e-10*dgemm$mn + 1.428695e-09*dgemm$mk + 2.710319e-09*dgemm$nk
plot = ggplot(dgemm, aes(x=m*n*k, y=duration)) + geom_point(alpha=0.3) + geom_point(aes(y=pred), alpha=0.3, color='red')
plot = plot + theme_bw()
plot
#+end_src

#+RESULTS:
[[file:/tmp/babel-R1JxhR/figurepXHcAJ.png]]

Scatter plot to show our model.

#+begin_src R :results output graphics :file (org-babel-temp-file "figure" ".png") :exports both :width 600 :height 400 :session *R*
dgemm = df[(df$func == 'dgemm'),]
plot = ggplot(dgemm, aes(x=m*n*k, y=duration, color=mode)) + geom_point(alpha=0.3)
plot = plot + theme_bw() + ylab('Duration (s)') + xlab('MNK') + labs(color='Mode')
ggsave(filename="figures/kernels/dgemm_model.png", plot=plot)
plot
#+end_src

#+RESULTS:
[[file:/tmp/babel-R1JxhR/figure9TYKZu.png]]

**** HPL_dlatcpy
Scatter plot to show the time variability and how we model it.

#+begin_src R :results output :session *R2* :exports both
df = read.csv('data/kernel_calibration/trace_functions.csv')
print(unique(df$func))
# in this experiment, we got the nodes dahu-{1,...,8} and the ranks were mapped in the right order
df$node = 1 + df$rank %/% 32
df$cpu = 2*df$node + df$rank %% 2
df$mnk = df$m * df$n * df$k
df$mn = df$m * df$n
df$mk = df$m * df$k
df$nk = df$n * df$k
head(df)
#+end_src

#+RESULTS:
#+begin_example
[1] dtrsm         dgemm         HPL_dlatcpy   HPL_dlaswp03T HPL_dlaswp02N
[6] ion          
Levels: HPL_dlaswp02N HPL_dlaswp03T HPL_dlatcpy dgemm dtrsm ion
         func     m n  k   start        end    duration rank    mode node cpu
1       dtrsm     2 2 NA 0.01674 0.01678434 0.000044337    0 reality    1   2
2       dgemm 50046 2  2 0.01678 0.01698043 0.000200426    0 reality    1   2
3 HPL_dlatcpy     2 2 NA 0.01726 0.01726033 0.000000326    0 reality    1   2
4       dtrsm     4 4 NA 0.01726 0.01726144 0.000001438    0 reality    1   2
5       dgemm 50044 4  4 0.01727 0.01764994 0.000379944    0 reality    1   2
6       dtrsm     2 2 NA 0.01790 0.01790106 0.000001056    0 reality    1   2
     mnk     mn     mk nk
1     NA      4     NA NA
2 200184 100092 100092  4
3     NA      4     NA NA
4     NA     16     NA NA
5 800704 200176 200176 16
6     NA      4     NA NA
#+end_example

#+begin_src R :results output :session *R2* :exports both
func = df[(df$func == 'HPL_dlatcpy'),]
summary(lm(data=func, duration ~ (I(m*n):factor(cpu))+0))
#+end_src

#+RESULTS:
#+begin_example

Call:
lm(formula = duration ~ (I(m * n):factor(cpu)) + 0, data = func)

Residuals:
       Min         1Q     Median         3Q        Max 
-1.357e-03 -8.570e-06 -7.100e-07  4.000e-08  2.735e-03 

Coefficients:
                        Estimate Std. Error t value Pr(>|t|)    
I(m * n):factor(cpu)2  4.949e-09  1.012e-11 489.036   <2e-16 ***
I(m * n):factor(cpu)3  5.020e-09  9.889e-12 507.660   <2e-16 ***
I(m * n):factor(cpu)4  4.975e-09  1.011e-11 492.166   <2e-16 ***
I(m * n):factor(cpu)5  5.080e-09  1.037e-11 489.933   <2e-16 ***
I(m * n):factor(cpu)6  4.974e-09  1.019e-11 488.265   <2e-16 ***
I(m * n):factor(cpu)7  5.001e-09  1.027e-11 487.150   <2e-16 ***
I(m * n):factor(cpu)8  4.892e-09  1.013e-11 482.801   <2e-16 ***
I(m * n):factor(cpu)9  4.845e-09  1.051e-11 460.972   <2e-16 ***
I(m * n):factor(cpu)10 4.795e-09  1.022e-11 469.275   <2e-16 ***
I(m * n):factor(cpu)11 4.760e-09  1.046e-11 455.167   <2e-16 ***
I(m * n):factor(cpu)13 3.295e-09  3.937e-09   0.837    0.403    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 9.619e-05 on 21086 degrees of freedom
Multiple R-squared:  0.991,	Adjusted R-squared:  0.991 
F-statistic: 2.116e+05 on 11 and 21086 DF,  p-value: < 2.2e-16
#+end_example

OK. cpu 13, is the one with very few measurements and a weird
behavior. Let's get rid of it.

#+begin_src R :results output graphics :file (org-babel-temp-file "figure" ".png") :exports both :width 600 :height 400 :session *R2*
func = df[(df$func == 'HPL_dlatcpy') & (df$cpu!=13),]
plot = ggplot(func, aes(x=m*n, y=duration, color=mode)) + 
    geom_smooth(data = func[func$mode == "reality",], aes(group=factor(cpu)), method='lm', 
                se=F, size=.2, color="blue", alpha=.2, fullrange=T) + 
    geom_point(alpha=.5,size=.5) + 
    geom_smooth(data = func[func$mode == "reality",], method='lm', se=F, fullrange=T, linetype=4, color="black")
plot = plot + theme_bw() + ylab('Duration (s)') + xlab('M.N')
    xlim(0,max(func$m*func$n)*1.1) +     
    scale_color_brewer(palette="Set1")  +
    theme(legend.position = c(0.3,0.85), legend.title=element_blank()) +
    guides(colour = guide_legend(override.aes = list(alpha = 1)))

ggsave(filename='figures/kernels/dlatcpy_model.png', plot=plot, width=5,height=4, dpi=200)
plot
#+end_src

#+RESULTS:
[[file:/tmp/babel-19053_Jy/figure19053OQB.png]]

* Validation at Scale
#+LaTeX: \label{sec:validation}
To evaluate the soundness of our approach, we compare several real
executions of HPL with simulations using the previous models.
** Experimental Setup
We used the /Dahu/ cluster from the /Grid5000/ testbed. It has 32 nodes connected
through a single switch by 100 Gbps Omnipath links. Each node has two Intel Xeon
Gold 6130 CPU with 16 cores per CPU. We took care of disabling hyperthreading
and fixing the core frequencies to 3.7 GHz. We used HPL version 2.2 compiled
with GCC version 6.3.0. We also used the libraries OpenMPI version 2.0.2 and
OpenBLAS version 0.3.1.
HPL executions were done using a block size of 128 and a matrix of varying size
(from \num{50000} to \num{500000}). We used one single-threaded MPI rank per core and a
look-ahead =depth= of 1. Finally, we used the =increasing-2-ring= broadcast with the
=Crout= panel factorization algorithms.

# |   | matrix_size | block_size | proc_p | proc_q | pfact | rfact | bcast | depth | swap | mem_align | process_per_node | thread_per_process |
# |---+-------------+------------+--------+--------+-------+-------+-------+-------+------+-----------+------------------+--------------------|
# | 1 |      175000 |        128 |     32 |     32 |     1 |     2 |     2 |     1 |    0 |         8 |               32 |                  1 |

Although this machine is much smaller than top supercomputers, we
believe that faithfully simulating an HPL execution with such settings
is as challenging as a typical TOP500 qualification run.
- We simulated one rank per core to obtain a higher number
  (\Num{1024}) of MPI process. This is more difficult than simulating
  one rank per node, as (1) this increases the amount of data
  transfered through MPI (2) the performance is more subject to network
  heterogeneity (which we model by having a different model for
  local and remote communications) and memory interference.
- We used a smaller block size than what is usually done, which leads
  to a higher number of iterations, hence a larger amount of
  complex communication patterns.
- The matrix is smaller, hence a lower simulation time, which is
  generally harder to predict with a good precision.
# - The network is more stable due to its smaller size.
** Gantt Chart generation                                         :noexport:
*** Downloading the CSV
These CSV have been generated with this [[https://github.com/Ezibenroc/mpi_calibration/blob/3933006b4bfb9b3ce5a8d0758258f6b1fd7957c2/dahu/hpl/hpl_trace.ipynb][notebook]] (the dump to the CSV files
happens in the function paper_plot, cell 14, that is called in cells 15 and 16).
The notebook uses the ZIP archives from this [[https://github.com/Ezibenroc/mpi_calibration/tree/0d4f39b8391597c93861482621b98f814272bdb4/dahu/smpi_hpl/paper_sc19/traces/2][directory]].

#+begin_src sh :results output :exports both
mkdir -p data/validation_traces/
cd data/validation_traces/
wget -c https://github.com/Ezibenroc/mpi_calibration/raw/master/dahu/smpi_hpl/paper_sc19/traces/2/trace_reality.csv
wget -c https://github.com/Ezibenroc/mpi_calibration/raw/master/dahu/smpi_hpl/paper_sc19/traces/2/trace_simulation_deterministic-CPU_linear-DGEMM_deterministic-network.csv
wget -c https://github.com/Ezibenroc/mpi_calibration/raw/master/dahu/smpi_hpl/paper_sc19/traces/2/trace_simulation_deterministic-CPU_linear-DGEMM_stochastic-network.csv
wget -c https://github.com/Ezibenroc/mpi_calibration/raw/master/dahu/smpi_hpl/paper_sc19/traces/2/trace_simulation_stochastic-CPU_polynomial-DGEMM_deterministic-network.csv
wget -c https://github.com/Ezibenroc/mpi_calibration/raw/master/dahu/smpi_hpl/paper_sc19/traces/2/trace_simulation_stochastic-CPU_polynomial-DGEMM_stochastic-network.csv
#+end_src

#+RESULTS:

*** Drawing the Gantt charts
#+NAME: init_gantt
#+begin_src R :results output :session *R* :exports both
library(ggplot2)
library(dplyr)
# Levels: MPI_Recv MPI_Send dgemm dtrsm other
colours <- c("#5050AA", "#AA2020", "#FFFF88", "#FF00FF", "#FF0000")

draw_gantt <- function(csv_name, xmax= 10, xstep = 2) {
    df = read.csv(csv_name)
    df$func = factor(df$func, levels=c('MPI_Recv', 'MPI_Send', 'dgemm', 'dtrsm', 'other'))
    dfend = df %>% group_by(rank) %>% filter(func=="dgemm") %>% summarize(end=max(end)) %>% select(end) %>% ungroup()  %>% summarize(end=mean(end))
    myend <<- dfend;
    gc = ggplot(df) + geom_rect(aes(xmin=start, xmax=end, ymin=rank, ymax=rank+1, fill=func)) + theme_bw() +
        scale_fill_manual(values=colours,  guide=F) +  # scale_fill_brewer(type='qualitative', palette='Set1',) 
        geom_vline(data=data.frame(x=seq(from=0, to=xmax, by=xstep)),aes(xintercept=x), linetype=2) +
        geom_vline(data=dfend,aes(xintercept=end),color="darkred") +
        xlim(0,xmax) +
        theme(text=element_text(size=20))
    return(gc)
}
#+end_src

#+RESULTS: init_gantt

#+RESULTS:

#+begin_src R :results output graphics :file figures/gantt_charts/gantt_reality.png :exports both :width 600 :height 400 :session *R* :var dep=init_gantt
draw_gantt("data/validation_traces/trace_reality.csv")
#+end_src

#+RESULTS:
[[file:figures/gantt_charts/gantt_reality.png]]

#+begin_src R :results output :session *R* :exports both :var dep=init_gantt
file_list=c("trace_reality", 
            "trace_simulation_deterministic-CPU_linear-DGEMM_deterministic-network", 
            "trace_simulation_deterministic-CPU_linear-DGEMM_stochastic-network",
            "trace_simulation_stochastic-CPU_polynomial-DGEMM_deterministic-network",
            "trace_simulation_stochastic-CPU_polynomial-DGEMM_stochastic-network",
            "trace_simulation_stochastic-CPU_polynomial-DGEMM_stochastic-network");
for(i in file_list) {
    png(filename=paste0("figures/gantt_charts/",gsub("^trace_","gantt_",i),".png"),width=800,height=400); 
    plot(draw_gantt(paste0("data/validation_traces/",i,".csv")));
    dev.off();
}
#+end_src

#+RESULTS:

** Performance plots generation                                   :noexport:
For this plot, the CSV files are small, so they are stored directly in the
repository, no need to download them. They have been dumped by [[https://github.com/Ezibenroc/mpi_calibration/blob/57e844cb6c9803de2efe85f9d7d6ee84b4acee02/dahu/smpi_hpl/hpl_simulation.ipynb][this notebook]]
(cell 2).

The zip archives for these files are:
- Real executions of October: [[https://github.com/Ezibenroc/mpi_calibration/blob/master/dahu/hpl/grenoble_2018-10-10_1811810.zip][this]] and [[https://github.com/Ezibenroc/mpi_calibration/blob/master/dahu/hpl/grenoble_2018-10-10_1811847.zip][this]] archives.
- Real executions of March: [[https://github.com/Ezibenroc/mpi_calibration/blob/master/dahu/hpl/grenoble_2019-03-15_1855885.zip][this]] and [[https://github.com/Ezibenroc/mpi_calibration/blob/master/dahu/hpl/grenoble_2019-03-18_1856059.zip][this]] archives.
- Simulations with the homogeneous dgemm model: [[https://github.com/Ezibenroc/mpi_calibration/tree/master/dahu/smpi_hpl/paper_sc19/performance/2][these archives]].
- Simulation with the heterogeneous dgemm model: [[https://github.com/Ezibenroc/mpi_calibration/tree/master/dahu/smpi_hpl/paper_sc19/performance/11][these archives]].
*** Drawing the plot
Here, we use tikzDevice to generate Tikz code with ggplot. More information on
this [[https://matthew-parker.rbind.io/post/easy-latex-titles-and-labels-for-ggplot/][tutorial]].

#+begin_src R :results output :session *R* :exports both
library(ggplot2)
library(tikzDevice)
library(dplyr)
dfreal = read.csv('data/validation_performance/hpl_reality.csv')
dfreal = dfreal %>% filter(date == '2019-03')
dfsim = rbind(
    read.csv('data/validation_performance/hpl_simulation_heterogeneous.csv'),
    read.csv('data/validation_performance/hpl_simulation_homogeneous.csv')
)
head(dfreal)
head(dfsim)
#+end_src

#+RESULTS:
#+begin_example
  matrix_size gflops    time    mode    date
1      175000  22610  158.00 reality 2019-03
2      500000  22330 3732.41 reality 2019-03
3       50000  12780    6.52 reality 2019-03
4      300000  21140  851.46 reality 2019-03
5      400000  21660 1969.91 reality 2019-03
6      150000  19910  113.02 reality 2019-03
  matrix_size gflops    time       mode stochastic_cpu stochastic_network
1      100000  18870   35.33 simulation           True              False
2      200000  21390  249.29 simulation           True              False
3      400000  22690 1880.62 simulation           True              False
4       75000  15930   17.65 simulation           True               True
5      175000  19690  181.49 simulation           True               True
6      350000  21470 1331.50 simulation           True               True
  polynomial_dgemm heterogeneous_dgemm  model
1            False                True B1_het
2            False                True B1_het
3            False                True B1_het
4             True                True D2_het
5             True                True D2_het
6             True                True D2_het
#+end_example

Keeping only a subset of the models, to have a readable plot.
#+begin_src R :results output :session *R* :exports both
dfsim = dfsim %>% filter(model %in% c('A1', 'A2', 'A1_het', 'C1_het', 'D1_het', 'D2_het'))
#+end_src

#+RESULTS:

Removing the two outliers in the real executions. These two points are
"abnormaly fast", each of them was the first to be made in the sequence of runs
(the machines were not overheating yet).
#+begin_src R :results output :session *R* :exports both
print(length(dfreal$gflops))
dfreal = dfreal %>% filter(matrix_size != 175000 | gflops < 22000)
print(length(dfreal$gflops))
#+end_src

#+RESULTS:
: [1] 112
: [1] 110

For information, the notations are:
#+BEGIN_SRC latex
\newcommand{\model}[2][]{\ensuremath{\mathcal{M}_{#1}\ifthenelse{\equal{#2}{}}{}{\!-\!}{#2}}\xspace}
\newcommand{\modelp}[2][]{\ensuremath{\mathcal{M'}_{#1}\!\ifthenelse{\equal{#2}{}}{}{\!-\!}{#2}}\xspace}
\newcommand{\noise}[2][]{\ensuremath{\mathcal{N}_{#1}\ifthenelse{\equal{#2}{}}{}{\!-\!}{#2}}\xspace}
\newcommand{\noisep}[2][]{\ensuremath{\mathcal{N'}_{#1}\!\ifthenelse{\equal{#2}{}}{}{\!-\!}{#2}}\xspace}
#+END_SRC

#  +begin_src R :results output graphics :file (org-babel-temp-file "figure" ".png") :exports both :width 1000 :height 600 :session *R*
#+begin_src R :results output :session *R* :exports both
tikzDevice::tikz(file = './figures/validation_performance.tex', width = 5, height = 3)

model_ <- function(letter, het, prime, nb) {
    if(prime) {
        letter = paste(letter, "'", sep='')
    }
    result = paste('\\mathcal{', letter, '}', sep='')
    if(het) {
        result = paste(result, '_{H}', sep='')
    }
    return(paste(result, '\\!-\\!', as.character(nb), sep=''))
}
model <- function(het_model, prime_model, nb_model, het_noise, prime_noise, nb_noise) {
    return(paste(model_('M', het_model, prime_model, nb_model), model_('N', het_noise, prime_noise, nb_noise)))
}
to_tex <- function(name, result) {
    result=paste(name, '$\\sim', result, '$', sep='')
    print(result)
    return(result)
}

text_size = 3
# Labels definitions
lab = dfsim %>% filter(
    (model == 'A1'     & matrix_size == 300000) |
    (model == 'A2'     & matrix_size == 300000) |
    (model == 'A1_het' & matrix_size == 250000) |
    (model == 'C1_het' & matrix_size == 250000) |
    (model == 'D1_het' & matrix_size == 500000) |
    (model == 'D2_het' & matrix_size == 500000)
) 
lab = lab %>% select(gflops, matrix_size, model) %>% distinct()
lab = lab %>% mutate(label = case_when(model == 'A1'     ~ paste(to_tex('kernels', model(F, F, 1, F, F, 0)), to_tex('network', model(F, T, 1, F, F, 0)), sep='\n'),
                                       model == 'A2'     ~ paste(to_tex('kernels', model(F, F, 1, F, F, 0)), to_tex('network', model(F, T, 1, F, T, 1)), sep='\n'),
                                       model == 'A1_het' ~ paste(to_tex('kernels', model(F, F, 1, F, F, 0)), to_tex('dgemm', model(T, F, 1, F, F, 0)), to_tex('network', model(F, T, 1, F, F, 0)), sep='\n'),
                                       model == 'C1_het' ~ paste(to_tex('kernels', model(F, F, 1, F, F, 0)), to_tex('dgemm', model(T, F, 2, F, F, 0)), to_tex('network', model(F, T, 1, F, F, 0)), sep='\n'),
                                       model == 'D1_het' ~ paste(to_tex('kernels', model(F, F, 1, F, F, 2)), to_tex('dgemm', model(T, F, 2, T, F, 2)), to_tex('network', model(F, T, 1, F, F, 0)), sep='\n'),
                                       model == 'D2_het' ~ paste(to_tex('kernels', model(F, F, 1, F, F, 2)), to_tex('dgemm', model(T, F, 2, T, F, 2)), to_tex('network', model(F, T, 1, F, T, 1)), sep='\n'),
                                       T             ~ as.character(model)))
lab$x = lab$matrix_size
lab$y = lab$gflops
lab$xl = lab$x*1.0
lab$yl = lab$y*1.0
delta_x = max(dfsim$matrix_size) / 12
delta_y = max(dfsim$gflops) / 12
max_x = max(dfsim$matrix_size)
max_y = max(dfsim$gflops)
lab = lab %>% mutate(xl = case_when(model == 'A1'     ~ 0.25*max_x,
                                    model == 'A2'     ~ 0.8*max_x,
                                    model == 'A1_het' ~ 0.3*max_x,
                                    model == 'C1_het' ~ 0.6*max_x,
                                    model == 'D1_het' ~ 0.38*max_x,
                                    model == 'D2_het' ~ 0.8*max_x,
                                       T             ~ xl))
lab = lab %>% mutate(yl = case_when(model == 'A1'     ~ 0.95*max_y,
                                    model == 'A2'     ~ 0.9*max_y,
                                    model == 'A1_het' ~ 0.4*max_y,
                                    model == 'C1_het' ~ 0.4*max_y,
                                    model == 'D1_het' ~ 0.1*max_y,
                                    model == 'D2_het' ~ 0.1*max_y,
                                       T             ~ yl))

# Plot drawing
plot = ggplot(dfsim, aes(x=matrix_size, y=gflops)) + geom_point(data=dfreal, shape=1, size=0.5) + geom_point(aes(color=model), size=0.5)
plot = plot + stat_summary(aes(color=model), fun.y='mean', geom='line', linetype='dashed')
plot = plot + stat_summary(fun.y='mean', geom='line', data=dfreal)
plot = plot + theme_bw() + expand_limits(y=0)
plot = plot + scale_color_brewer(type='qual', palette='Dark2', guide=F)
plot = plot + theme(text=element_text(size=12))
plot = plot + ylab('Gflop/s') + xlab('Matrix rank')
plot = plot + geom_segment(data=lab, aes(x=xl, xend=x, y=yl, yend=y, color=model), linetype="solid")
plot = plot + geom_label(data=lab, aes(x=xl, y=yl, label=label, color=model), size=text_size)
plot = plot + geom_segment(data=lab, x=max_x*0.75, xend=4.5e5, y=max_y*0.6, yend=mean((dfreal %>% filter(matrix_size == 450000))$gflops), linetype="solid")
plot = plot + geom_label(data=lab, aes(x=max_x*0.75, y=max_y*0.6), label='\\textbf{reality}', size=text_size)
plot
dev.off()
print(plot)
#ggsave(filename='figures/validation_performance.pdf', plot=plot)
#plot
#+end_src

#+RESULTS:
#+begin_example
[1] "kernels$\\sim\\mathcal{M}\\!-\\!1 \\mathcal{N}\\!-\\!0$"
[1] "network$\\sim\\mathcal{M'}\\!-\\!1 \\mathcal{N}\\!-\\!0$"
[1] "kernels$\\sim\\mathcal{M}\\!-\\!1 \\mathcal{N}\\!-\\!0$"
[1] "network$\\sim\\mathcal{M'}\\!-\\!1 \\mathcal{N'}\\!-\\!1$"
[1] "kernels$\\sim\\mathcal{M}\\!-\\!1 \\mathcal{N}\\!-\\!0$"
[1] "dgemm$\\sim\\mathcal{M}_{H}\\!-\\!1 \\mathcal{N}\\!-\\!0$"
[1] "network$\\sim\\mathcal{M'}\\!-\\!1 \\mathcal{N}\\!-\\!0$"
[1] "kernels$\\sim\\mathcal{M}\\!-\\!1 \\mathcal{N}\\!-\\!0$"
[1] "dgemm$\\sim\\mathcal{M}_{H}\\!-\\!2 \\mathcal{N}\\!-\\!0$"
[1] "network$\\sim\\mathcal{M'}\\!-\\!1 \\mathcal{N}\\!-\\!0$"
[1] "kernels$\\sim\\mathcal{M}\\!-\\!1 \\mathcal{N}\\!-\\!2$"
[1] "dgemm$\\sim\\mathcal{M}_{H}\\!-\\!2 \\mathcal{N}_{H}\\!-\\!2$"
[1] "network$\\sim\\mathcal{M'}\\!-\\!1 \\mathcal{N}\\!-\\!0$"
[1] "kernels$\\sim\\mathcal{M}\\!-\\!1 \\mathcal{N}\\!-\\!2$"
[1] "dgemm$\\sim\\mathcal{M}_{H}\\!-\\!2 \\mathcal{N}_{H}\\!-\\!2$"
[1] "network$\\sim\\mathcal{M'}\\!-\\!1 \\mathcal{N'}\\!-\\!1$"
null device 
          1
#+end_example

** \scalebox{.94}{Comparing Simulations with Real Executions}
Our first evaluation consists in comparing the traces of the
simulations with the reality. We instrumented HPL to collect the start
and end timestamps of each kernel and MPI call. We limited the
execution to 256 ranks and the first five iterations, to limit the
trace sizes. A first qualitative validation can be done by visually
comparing the Gantt charts of the simulations with the reality (see
figure\ref{fig:gantt_simulation}). In the charts, calls to
\texttt{dgemm} are in yellow, \texttt{MPI\_Send} in red,
\texttt{MPI\_Recv} in blue. Although the structure is similar in all
charts, the shape and the duration of the communication phases can be
way too optimistic in simulations compared to reality.  The charts
show that, at this scale, using a deterministic or a stochastic model
for the network has no noticeable impact on HPL simulation. However,
having a more complex model for the kernels leads to much more
realistic traces. The variability in the computation durations leads
to an increase of the time spent in communications and an overall
slightly longer execution. In HPL, computation variability directly
translates in late senders and receivers that destroy the efficiency
of collective operations.

#+BEGIN_EXPORT latex
\newcommand{\ganttcaption}[2]{\rotatebox{90}{\hspace{1cm}$\text{#1}\atop \text{#2}$\hspace{-1cm}}}
\begin{figure}[t]
    \centering
    \begin{tabular}{c@{}c}
    \ganttcaption{\hspace{.3cm}Reality}{}                        & \includegraphics[width=.85\linewidth]{./figures/gantt_charts/gantt_reality.png} \\
    \ganttcaption{Simple kernel}{Simple network}    & \includegraphics[width=.85\linewidth]{./figures/gantt_charts/gantt_simulation_deterministic-CPU_linear-DGEMM_deterministic-network.png}\\
    \ganttcaption{Complex kernel}{Simple network}   & \includegraphics[width=.85\linewidth]{./figures/gantt_charts/gantt_simulation_stochastic-CPU_polynomial-DGEMM_deterministic-network.png}\\
    \ganttcaption{Complex kernel}{Complex network}  & \includegraphics[width=.85\linewidth]{./figures/gantt_charts/gantt_simulation_stochastic-CPU_polynomial-DGEMM_stochastic-network.png} \\
    \end{tabular}
    \caption{Gantt charts of HPL first iterations in simulation}
    \label{fig:gantt_simulation}
    \labspace
\end{figure}
#+END_EXPORT

#+BEGIN_EXPORT latex
\begin{figure}[h]
    \centering
    \resizebox{0.95\linewidth}{!}{\input{figures/validation_performance.tex}}
    % \includegraphics[width=0.95\linewidth]{./figures/validation_performance.pdf}
    \caption{Comparison of HPL performance prediction with the reality}
    \label{fig:validation_performance}
    \labspace
\end{figure}
#+END_EXPORT

We now provide a more quantative comparison using the whole cluster
and focusing on the \si{\giga\flops} rate reported by HPL when varying
matrix size (see Figure\ref{fig:validation_performance}).
The real executions are depicted in black. For each matrix size, we performed 8
runs of HPL, to illustrate the temporal variability of the performance.  The
light green line, on the top, is our first tentative to simulate HPL. The
simulation was done with a simple model: \model{1} for the kernels and
\modelp{1} for the network with no noise (\noise{0}) in both cases. This model
overestimates HPL performance by more than 30%. Our initial thoughts was that
the network model was too optimistic, so we switched to a stochastic multi-modal
network model, \noisep{1}, shown in yellow, which unfortunately does
not yield any significant change in HPL performance prediction.

As shown by figure \ref{fig:blas_var}, there is an important heterogeneity in
the cluster. For this reason, we started using a \model[H]{1}/\noise{0} model
for \texttt{dgemm} while keeping the models for the other kernels and the
network as before. This increases very significantly the realism of the
simulation as the performance is now overestimated by only 9% (shown in dark
green in the plot).

As expected, using a polynomial model for \texttt{dgemm} instead of a linear
model (thus switching from \model[H]{1} to \model[H]{2}) improves
the performance prediction, in particular for smaller matrices. 
This new model, depicted in orange, is very close to reality at the
beginning but gets equivalent to the previous model when the matrix gets
larger. Adding the temporal variability noise (\noise{2} for all
kernels, \noise[H]{2} for \texttt{dgemm}) is the key ingredient to
obtain the last bit of realism. The prediction, in blue, is now
extremly close to the reality as it underestimates the performance by
less than 5%, even 2% for the larger matrices. Adding back temporal variability
to the network model (\noisep{1}, in pink) still has no significant
effect but this can be explained by the fact that HPL mostly
communicates very large amount of data in bulk. Network temporal
variability may be a very important aspect to model for applications
that are more /latency-bound/.

It is interesting to mention that we obtained an early access to the
Dahu cluster just after it was installed. It experienced several
maintenance sessions and over the duration of our investigations (a
few months), the performance of HPL has surprisingly decreased by
about 10%. Although we had a very good software control over the
cluster, we noticed that the performance of a few nodes has
significantly changed, which has increased the system heterogeneity,
leading to the current performance depicted in
Figure\ref{fig:validation_performance}. By replacing the few currently
slow nodes by "average" nodes in our model, we have been able to
re-estimate the overall performance of HPL and to obtain a (higher)
prediction matching the performance obtained a few months ago.

We have thus shown it is possible to predict consistently the
performance of HPL within a few percents of reality provided a
faithful model of each individual resource is realized. Again, we
insist on the fact that modeling both spatial and temporal variability
is crucial.
** \scalebox{.92}{Comparing With the Stampede Qualification Run}
*** Stampede modeling                                              :ignore:
#+LaTeX: \label{sec:stampede}
# #+BEGIN_EXPORT latex
# \begin{figure*}%[!htb]
#   \centering
#   % \begin{minipage}[b]{.27\textwidth}
#   %   \includegraphics[width=\linewidth,page=2]{./figures/stampede_knc_model.pdf}
#   %   \vspace{-2em}
#   %   \caption{Automatic offloading on the KNC depends on matrix dimensions.}
#   %   \vspace{-1em}
#   %   \label{fig:hpl_mkl}
#   % \end{minipage}~~~
#   \begin{minipage}[b]{.7\textwidth}\centering
#     \scalebox{.88}{\begin{tabular}{l|r|r|r|r}
#     & \multicolumn{2}{c|}{CPU (\texttt{CPU})} & \multicolumn{2}{c}{KNC (\texttt{PHI}) }\\
#     & Coefficient $[\si{\sec\per\flop}]$& Intercept $[\sec]$ & Coefficient $[\si{\sec\per\flop}]$& Intercept $[\sec]$ \\
#     \hline
#     \texttt{DGEMM} & \Num{1.029e-11} & \Num{2.737e-02} & \Num{1.981e-12} & \Num{6.316e-01} \\
#     \texttt{DTRSM} & \Num{9.882e-12} & \Num{4.329e-02} & \Num{1.954e-12} & \Num{5.222e-01}
#     \end{tabular}}\medskip\\
#     \lstset{frame=bt,language=C,numbers=none,escapechar=|}\lstinputlisting{HPL_dtrsm_macro_real.c}
#     \caption{Modeling automatic offloading on KNC in MKL BLAS kernels.}
#     \vspace{-1em}
#     \label{fig:macro_real}
#   \end{minipage}~~~\begin{minipage}[b]{.27\textwidth}
#   \centering
#   \includegraphics[width=\linewidth,page=1]{./figures/stampede_calibration_send.png}
#   \caption{Modeling communication time on stampede. Each color is manually adjusted and 
#        corresponds to a different synchronization mode 
#       (eager, rendez-vous,...). }\vspace{-1em}
#   \label{fig:stampede_calibration}
#   \labspace
#   \end{minipage}
# \end{figure*}
# #+END_EXPORT

# # SMPI_DGEMM_COEFFICIENT=1.029e-11 SMPI_DGEMM_INTERCEPT=2.737e-02 SMPI_DGEMM_PHI_COEFFICIENT=1.981e-12 SMPI_DGEMM_PHI_INTERCEPT=6.316e-01 \
# # SMPI_DTRSM_COEFFICIENT=9.882e-12 SMPI_DTRSM_INTERCEPT=4.329e-02 SMPI_DTRSM_PHI_COEFFICIENT=1.954e-12 SMPI_DTRSM_PHI_INTERCEPT=5.222e-01"

Each node of the Stampede cluster comprises two 8-core Intel Xeon
E5-2680 8C \NSI{2.7}{\GHz} CPUs and one 61-core Intel Xeon Phi SE10P
(KNC) \NSI{1.1}{\GHz} accelerator that is roughly three times more
powerful than the two CPUs. The HPL output submitted to the TOP500
(Figure\ref{fig:typical_run}) does not indicate how the KNC was
used. However, because of the values assigned to $P$ and $Q$, we are
certain that only a single MPI process per node was run. For this
reason, it is likely that the KNC was used as an accelerator, which is
effortless with Intel's Math Kernel Library (MKL) as it support
automatic offloading for selected BLAS functions.  Although, we cannot
know precisely which MKL version was used in 2013, we measured the
default version (version11.1.1) used on Stampede in the beginning
of 2017. The MKL documentation states that, depending on the matrix
geometry, the computation will run on either all the cores of the CPU
or exclusively on the KNC.  In the case of =dgemm=, the computation of
$A=\alpha\cdot{}A+\beta\cdot{}B\times{}C$ with $A, B, C$ of dimensions $M\times{}K$, $K\times{}N$ and $M\times{}N$,
respectively, is offloaded onto the KNC whenever $M$ and $N$ are both
larger than $1280$ while $K$ is simultaneously larger than $256$,
which calls for a \modelp model. Similarly, offloading for =dtrsm= is
used when both $M$ and $N$ are larger than $512$, which results in a
better throughput but incurs a higher latency. The measured
performance was close to the peak performance: \eg for =DGEMM= on the
Phi reached $2/\Num{1.981e-12} = \NSI{1.009}{\tera\flops}$. Since the
block size used in HPL is \Num{1024}, all calls (except for maybe the
very last iteration) are offloaded to the KNC. Therefore, we decided
as a first step to use very simple (\modelp{1}\noise{0}) models for
=dgemm= and =dtrsm= and to simply skip all other functions, which is a
very optimistic modeling. Likewise, although the performance of MPI
measured in 2017 calls for a \modelp{1}\noisep{1} model, we used a
simple optimistic \modelp{1}\noise{0} model. All HPL input parameters were
set to exactly the values used in the TOP500 qualification run and were
coherent with the submitted output.
*** Xeon Phi R figures                                           :noexport:
# See CH's journal from [2017-10-03 Tue] to see how the version was determined
#+begin_src R :results output :session *R* :exports both
  library(gridExtra)
  library(ggplot2)
  dgemm <- read.csv('/home/alegrand/Work/SimGrid/tom/m2_internship_journal/stampede/offloading_dgemm.csv')
  dgemm$m = as.double(dgemm$m)
  dtrsm <- read.csv('/home/alegrand/Work/SimGrid/tom/m2_internship_journal/stampede/offloading_dtrsm.csv')
  dtrsm$m = as.double(dtrsm$m)

  dgemm_new = dgemm[dgemm$automatic_offload == 'True',]
  dtrsm_new = dtrsm[dtrsm$automatic_offload == 'True',]
  dgemm_new$offload = (dgemm_new$m > 1280 & dgemm_new$n > 1280 & dgemm_new$k > 256)
  dtrsm_new$offload = (dtrsm_new$m > 512 & dtrsm_new$n > 512)

  dgemm_new$flops = dgemm_new$m * dgemm_new$n * dgemm_new$k;
  dtrsm_new$flops = dtrsm_new$m * dtrsm_new$n^2;

  dgemm_new$type = "dgemm";
  dtrsm_new$type = "dtrsm";

  df = dtrsm_new
  df$k = NA;
  df$lead_C = NA;
  df = rbind(df,dgemm_new)
  head(df)
  tail(df)
#+end_src

#+RESULTS:
#+begin_example
       time    m    n lead_A lead_B automatic_offloading offload        flops
1  0.029975 7251  261   7251   7251                 True   FALSE    493945371
4  2.227428  578 4619   4619   4619                 True    TRUE  12331723058
5  0.042097 4424  420   4424   4424                 True   FALSE    780393600
8  0.018786 3115  305   3115   3115                 True   FALSE    289772875
10 2.931274  650 5466   5466   5466                 True    TRUE  19420151400
12 3.240624 5606 6490   6490   6490                 True    TRUE 236125280600
    type  k lead_C
1  dtrsm NA     NA
4  dtrsm NA     NA
5  dtrsm NA     NA
8  dtrsm NA     NA
10 dtrsm NA     NA
12 dtrsm NA     NA
         time    m    n lead_A lead_B automatic_offloading offload        flops
89   0.083594  244 5757   5757   5757                 True   FALSE    847038924
91   4.932572 5527 6493   6493   6493                 True    TRUE 189518248891
931  2.943795 1425 6127   6127   6127                 True    TRUE  33954761775
96   0.262358   62 6621   6621   6621                 True   FALSE   2151851484
981  2.749753 4991 2256   4991   4991                 True    TRUE  17002140960
1001 2.383139 1421 1348   1646   1646                 True    TRUE   3152926168
      type    k lead_C
89   dgemm  603   5757
91   dgemm 5281   6493
931  dgemm 3889   6127
96   dgemm 5242   6621
981  dgemm 1510   4991
1001 dgemm 1646   1646
#+end_example

#+begin_src R :results output :session *R* :exports both
get_legend<-function(myggplot){
  tmp <- ggplot_gtable(ggplot_build(myggplot))
  leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box")
  legend <- tmp$grobs[[leg]]
  return(legend)
}
#+end_src

#+RESULTS:

#+begin_src R :results output graphics :file figures/stampede_knc_model.pdf :exports both :width 3.5 :height 5.3 :session *R* 
  labels = rbind(
      data.frame(x = 2E11, y=3.5, label="Offloading on the KNC", offload = T),
      data.frame(x = 1.1E11, y=1, label="Computation on the CPU", offload = F));
  
  p1 = ggplot(dgemm_new, aes_string(x='m*n*k', y='time', color='offload')) +
      geom_point() + geom_smooth(method="lm",fullrange=T) + theme(legend.position="top") + 
      geom_text(data = labels, aes(x=x, y=y, color=offload, label=label)) + ylim(0,1.1*max(dgemm_new$time)) +
      ggtitle('Duration of DGEMM') + theme_bw() +
      xlab("M.N.K [Flop]") + ylab("Duration [s]") + scale_color_brewer(palette="Set1")

  p1_legend = get_legend(p1);
  p1 = p1 + theme(legend.position="none")
  labels = rbind(
      data.frame(x = 3E11, y=2.8, label="Offloading on the KNC", offload = T),
      data.frame(x = 1.6E11, y=.6, label="Computation on the CPU", offload = F));
  p2 = ggplot(dtrsm_new, aes_string(x='m*n*n', y='time', color='offload')) +
      geom_point()+ geom_smooth(method="lm",fullrange=T) +  ylim(0,1.1*max(dtrsm_new$time)) +
      geom_text(data = labels, aes(x=x, y=y, color=offload, label=label)) +
      ggtitle('Duration of DTRSM') + theme_bw() +
      xlab("M.N [Flop]") + ylab("Duration [s]") + scale_color_brewer(palette="Set1")
  p2 = p2 + theme(legend.position="none")

   lay <- rbind(c(1), c(2));
   grid.arrange(p1,p2, layout_matrix = lay,widths=c(1), heights=c(2,2));
#+end_src

#+RESULTS:
[[file:figures/stampede_knc_model.pdf]]

#+begin_src sh :results output :exports both
pdfcrop figures/stampede_knc_model.pdf figures/stampede_knc_model.pdf
#+end_src

#+begin_src R :results output graphics :file (org-babel-temp-file "figure" ".png") :exports both :width 600 :height 400 :session *R* 
  ggplot(df, aes(x=flops, y=time, color=offload)) +
      geom_point() + geom_smooth(method="lm") + 
      facet_wrap(~type)
#+end_src

#+RESULTS:
[[file:/tmp/babel-1674kfe/figure1674sWN.png]]

**** Communications
# #+BEGIN_EXPORT latex
# \begin{figure}[t]
#   \centering
#   \includegraphics[width=\linewidth,page=1]{./figures/stampede_calibration_send.png}
#   \caption{Modeling communication time on stampede. Each color corresponds to a
#       manually adjusted breakpoint corresponding to a synchronization mode 
#       (eager, rendez-vous,...). }\vspace{-1em}
#   \label{fig:stampede_calibration}
#   \labspace
# \end{figure}
# #+END_EXPORT

We unfortunately do not know for sure which version of Intel MPI was used in
2013, so we decided to use the default one on Stampede
in May 2017, \ie version 3.1.4. As explained in 
Section\ref{sec:smpi}, SMPI's communication model is a hybrid model
between the LogP family and a fluid model. For each message, the send mode
(\eg fully asynchronous, detached or eager) is determined solely by the
message size. It is hence possible to model the resulting performance
of communication operations through a piece-wise linear model, as depicted in
Figure\ref{fig:stampede_calibration}. For a thorough discussion of
the calibration techniques used to obtain this model,
see\cite{smpi}. As illustrated, the results for
=MPI_Send= are quite stable and piece-wise regular, but the behavior of
=MPI_Recv= is surprising: for small messages with a size of less than \NSI{17420}{\byte}
(represented by purple, blue and red dots), one can observe two modes,
namely ``slow'' and ``fast'' communications. ``Slow''
operations take twice longer and are much more common than the 
``fast'' ones. We observed this behavior in several experiments even though both MPI
processes that were used in the calibration were connected through 
the same local switch. When observed, this ``perturbation'' was present throughout the execution of that
calibration. 
Having taken into consideration that small messages are scarce in HPL, we eventually decided to
ignore this phenomenon and opted to use the more favorable scenario (fast
communications) for small messages. We believe that the impact of
our choice on the simulation accuracy is minimal as primarily large,
bulk messages are sent that make use of the /rendez-vous/ mode (depicted in dark green).

Furthermore, we configured SMPI to use Stampede's network topology,
\ie Mellanox FDR InfiniBand technology with \NSI{56}{\giga\bit\per\second}, setup in
a fat-tree topology (see Figure\ref{fig:fat_tree_topology}). We
assumed the routing was done through D-mod-K\cite{dmodk} as it is
commonly used on this topology.
***** Stampede network calibration figures                     :noexport:
This figure is generated in [[file:~/Work/SimGrid/platform-calibration/data/stampede_17_06_01-17:14/calibration/analysis.org][the platform calibration repository]]. Data
should be read from there. Final adjustments (in the "Combined plot
section") were done here:

#+begin_src R :results output :session *R* :exports both
library(gridExtra)
get_legend<-function(myggplot){
  tmp <- ggplot_gtable(ggplot_build(myggplot))
  leg <- which(sapply(tmp$grobs, function(x) x$name) == "guide-box")
  legend <- tmp$grobs[[leg]]
  return(legend)
}

p1 = eth$p_send + theme(legend.position="top", legend.background = element_rect(fill = "white", colour = NA)) + guides(colour = guide_legend(override.aes = list(alpha = 1)))
#     + annotate("text",x=1E2,y=2.3E-6, label="40GB IB model",color="black")


p2 = eth$p_recv + theme(legend.position="top", legend.background = element_rect(fill = "white", colour = NA)) 
#     + annotate("text",x=1E2,y=2.3E-6, label="40GB IB model",color="black")

p1_legend = get_legend(p1);
p1 = p1 + theme(legend.position="none")
p2 = p2 + theme(legend.position="none")

# lay <- rbind(c(1,1),
#              c(2,3));
# p = grid.arrange(p1_legend,p1,p2, layout_matrix = lay,widths=c(2,2), heights=c(1.3,4));
# ggsave(filename="/tmp/taurus_send_recv.pdf",plot=p,width = 6, height = 4)

lay <- rbind(c(1,2));
p = grid.arrange(p1,p2, layout_matrix = lay,widths=c(2,2), heights=c(4));
ggsave(filename="/tmp/stampede_send_recv_eth.pdf",plot=p,width = 6, height = 3)
#+end_src

#+RESULTS:
: Warning message:
: Transformation introduced infinite values in continuous x-axis
: Warning messages:
: 1: Transformation introduced infinite values in continuous x-axis 
: 2: Transformation introduced infinite values in continuous x-axis

#+begin_src R :results output :session *R* :exports both
ggsave(filename="/tmp/stampede_send_recv_eth.png",plot=p,width = 6, height = 3)
#+end_src

#+RESULTS:

#+begin_src sh :results output :exports both
cp /tmp/stampede_send_recv_eth.png ./figures/stampede_calibration_send.png
#+end_src

#+RESULTS:
**** Summary of modeling uncertainties
For the compiler, Intel MPI and MKL, we were unable to determine
which version was used in 2013, but decided to go for rather optimistic
choices. The models for the MKL and for Intel MPI are close to the peak
performance. It is plausible that the compiler managed to optimize
computations in HPL. While it is true that most of these computations
are executed in our simulations, they are not accounted for. This
allows us to obtain fully deterministic simulations without harming the
outcome of the simulation as these parts only represent a tiny fraction of
the total execution time of HPL. A few HPL compilation flags (\eg
=HPL_NO_MPI_DATATYPE= and =HPL_COPY_L= that control whether MPI datatypes
should be used and how, respectively) could not be deduced from
HPL's original output on Stampede but we believe their impact to be
minimal. Finally, the HPL output reports the use of HPL v2.1 but the
main difference between v2.1 and v2.2 is the option to
continuously report factorization progress. We hence decided to apply
our modifications to the later version of HPL.

With all these modifications in place, we expected the prediction of
our simulations to be optimistic yet close to results obtained by a real life execution.
# - iMPI version ???
# - HPL compilation ? Possible modifications s.a. using openMP to have thread taking care of MPI communications and progressions.
*** Simulating HPL                                                 :ignore:
Figure\ref{fig:stampede_prediction} compares two simulation scenarios
with the original result from 2013. The solid red line represents the HPL
performance prediction as obtained with SMPI with the very optimistic Stampede model
we just described. Surprisingly, the prediction was much lower than the TOP500 result.
We verified that no part of HPL was left unmodeled and decided to
investigate whether a flaw in our network model that would result in
too much congestion could explain the performance. 
Alas, even a congestion-free network model 
(represented by the dashed blue line in Figure\ref{fig:stampede_prediction}) only
results in minor improvements. In our experiments to model =DGEMM= and =DTRSM=,
either the CPU or the KNC seemed to be used at one time and a specifically
optimized version of the MKL may have been used in 2013. 
Removing the offloading latency and modeling each node as a
single \NSI{1.2}{\tera\flops} node also fails to explain the
huge difference between our prediction results and reality.

#+BEGIN_EXPORT latex
\begin{figure}[t]
  \centering
  \includegraphics[width=\linewidth,page=1]{./figures/stampede_simgrid.pdf}
  \caption{Performance prediction of HPL on Stampede using SimGrid.}\vspace{-1em}
  \label{fig:stampede_prediction}
  \labspace
\end{figure}
#+END_EXPORT

*** HPL prediction                                               :noexport:

Starting from Tom's journal, entry "2017-09-27 Wednesday : Complete experiments with the crosstraffic desabled"
#+begin_src R :results output :session *R* :exports both
library(ggplot2)
# files <- dir('/home/alegrand/Work/SimGrid/tom/m2_internship_journal/stampede/simulation/8', pattern = '\\.csv', full.names = TRUE)
# tables <- lapply(files, read.csv)
# results = do.call(rbind, tables)

classical = rbind(read.csv('/home/alegrand/Work/SimGrid/tom/m2_internship_journal/stampede/simulation/8/result_1000000.csv'),
    read.csv('/home/alegrand/Work/SimGrid/tom/m2_internship_journal/stampede/simulation/8/result_2000000.csv'),
    read.csv('/home/alegrand/Work/SimGrid/tom/m2_internship_journal/stampede/simulation/8/result_3875000.csv'))
classical$mode = 'classical'

highbw = rbind(read.csv('/home/alegrand/Work/SimGrid/tom/m2_internship_journal/stampede/simulation/8/result_highbw_1000000.csv'),
    read.csv('/home/alegrand/Work/SimGrid/tom/m2_internship_journal/stampede/simulation/8/result_highbw_2000000.csv'),
    read.csv('/home/alegrand/Work/SimGrid/tom/m2_internship_journal/stampede/simulation/8/result_highbw_3875000.csv'))
highbw$mode = 'highbw'

fatpipe = rbind(read.csv('/home/alegrand/Work/SimGrid/tom/m2_internship_journal/stampede/simulation/8/result_fatpipe_1000000.csv'),
    read.csv('/home/alegrand/Work/SimGrid/tom/m2_internship_journal/stampede/simulation/8/result_fatpipe_2000000.csv'),
    read.csv('/home/alegrand/Work/SimGrid/tom/m2_internship_journal/stampede/simulation/8/result_fatpipe_3875000.csv'))
fatpipe$mode = 'fatpipe'

results = rbind(classical, highbw, fatpipe)
#+end_src

#+RESULTS:

#+begin_src R :results output graphics :file figures/stampede_simgrid.pdf :exports both :width 5 :height 3.5 :session *R* 
res_lab = results[results$mode != 'highbw' & results$size > 3E6,];
res_lab$x=res_lab$size;
res_lab$y=res_lab$Gflops;
res_lab$xl=res_lab$x*.9;
res_lab$yl=res_lab$y*.9;


res_lab$xl=res_lab$x*.8;
res_lab$yl=res_lab$y*.9;

res_lab[res_lab$mode=='classical',]$xl=3.4e6
res_lab[res_lab$mode=='classical',]$yl=2.5e6
res_lab[res_lab$mode=='fatpipe',]$xl=2.e6
res_lab[res_lab$mode=='fatpipe',]$yl=4.1e6

res_lab$label = NA;
res_lab[res_lab$mode=='fatpipe',]$label = "Simulation\n (No Contention)";
res_lab[res_lab$mode=='classical',]$label = "Simulation\n (Fat Tree)";

ggplot(results[results$mode != 'highbw',], aes(x=size, y=Gflops, color=mode, linetype=mode)) + 
    # Inner labels
    geom_segment(data=res_lab, 
                 aes(x=xl, xend=x, y=yl, yend=y), linetype="solid",
                 color="black") +
    geom_label(data=res_lab, 
               aes(label = factor(label), x=xl, y=yl, fill=mode),
               colour =  "white", fontface = "bold") +
    # SMPI lines
    geom_point() + geom_line() +  
    # TOP500 perf
    geom_hline(yintercept=5.16811e+06) + 
    annotate("text",x=3875000, 1E2,y=5.4e+06, hjust="right",
        label="Top 500 performance",color="black") + 
    annotate("text",x=3875000, 1E2,y=4.96e+06, hjust="right",
        label="(5.168 TeraFlop/s)",color="black") + 
    annotate("point",x=3875000, 1E2,y=5.16811e+06,color="black") + 
    # Cosmetics
    guides(fill=FALSE, color=FALSE, linetype=FALSE) + ylab("GFlop/s") + xlab("Matrix rank") +
    theme_bw() +  scale_color_brewer(palette="Set1") +  scale_fill_brewer(palette="Set1")+ 
    theme(legend.position="top") +
    ggtitle('Performance of HPL')
#+end_src

#+RESULTS:
[[file:figures/stampede_simgrid.pdf]]


#+begin_src R :results output graphics :file (org-babel-temp-file "figure" ".png") :exports both :width 600 :height 400 :session *R* 
ggplot(results, aes(x=size, y=simulation_time, color=mode, linetype=mode)) + geom_point() + geom_line() + ggtitle('Simulation time')
#+end_src

#+RESULTS:
[[file:/tmp/babel-23284Iao/figure232842Rn.png]]

*** Performance Gap Investigation                                  :ignore:
# The simulation time to get the full-scale trace was:
# - 420 seconds for two iterations (250 seconds spent in HPL),
# - 609 seconds for five iterations (265 seconds spent in HPL).

To identify the origin of this mismatch, we decided to trace the first
iterations of HPL to get an idea of what could be improved (the trace
for the first five iterations can be obtained in about 10 minutes on a
commodity computer and is about \NSI{175}{\mega\byte} large once
compressed). Figure\ref{fig:hpl_gantt} illustrates the very
synchronous and iterative nature of the first iterations with the
HPL configuration of Figure\ref{fig:typical_run}: One can
identify first a factorization of the panel, then a broadcast to all
the nodes, and finally an update of trailing matrix.  More than one
fifth of each iteration is spent communicating (although the first
iterations are the ones with the lowest communication to computation
ratio), which prevents HPL from reaching the TOP500 performance.
Overlapping these heavy communication phases with computation would
significantly improve performance. The fact that this is almost not
happening can be explained by the look-ahead ~DEPTH~ parameter that was
supposedly set to =0=. This is quite
surprising as even the tuning section of the HPL documentation
indicates that a =depth= of =1= is supposed to yield the best results,
even though a large problem size could be needed to see some
performance gain. We discussed this surprising behavior with the
Stampede-team and were informed that, although the HPL output mentions
=HPLinpack 2.1= from =October 26, 2012= by Petitet\etal, the run in 2013
was actually executed with the Intel binary version of HPL and which
was probably specifically modified for Stampede. The submitted HPL
output provides information about the progress of HPL throughout
iterations and statistics for the panel-owning process about the time
spent in the most important parts.  According to these statistics, the
total time spent in the =Update= section was \NSI{9390}{\sec} whereas
the total execution time was \NSI{7505}{\sec}, which is impossible
unless iterations have overlapped.

It is thus very almost sure that some configuration values have been
hardcoded to enforce an overlap of iterations with others and that
they should not be trusted. The broadcast and swapping algorithms use
very heavy communication patterns. This is not at all surprising since
for a matrix of this order, several hundred megabytes need to be
broadcast.  Although the output states that the =blongM= algorithm was
used it is likely that another algorithm has been used.  We tried the
the 6 other broadcast algorithms provided by HPL but could not
obtain significantly better overall performance.  An analysis of the
symbols in the Intel binary revealed that another broadcast algorithm
named =HPL_bcast_bpush= was available. Unlike the others, this new
algorithm relies on non-blocking sends, which could contribute to the
performance obtained in 2013.  Likewise, the swapping algorithm that
was used (~SWAP=Binary-exchange~) involves communications that are
rather long and organized in trees, which is surprising as the
~spread-roll~ algorithm is recommended for large matrices.

We do not aim to reverse engineer the Intel HPL code. We can, however,
already draw two conclusions from our analysis: 1) it is very likely
that the reported parameters are not the ones used in the real
execution, probably because these values were hardcoded and the
configuration output file was not updated accordingly and 2) it is
apparent that many optimizations have been done on the communication
side with respect to asynchrony and to the broadcast algorithm.
#+BEGIN_EXPORT latex
\begin{figure}[t]
  \centering
  \includegraphics[width=\linewidth,page=1]{./figures/fullscale_unzoomed.png}
  \caption{Gantt chart of the first two iterations of HPL. Communication states are in 
      red while computations are in cyan. Each communication between two process
      is represented with a white arrow, which results in very cluttered white areas.}\vspace{-1em}
  \label{fig:hpl_gantt}
  \labspace
\end{figure}
#+END_EXPORT

**** Gantt charts                                               :noexport:
#+begin_src sh :results output :exports both
cp /home/alegrand/Work/SimGrid/tom/m2_internship_journal/stampede/communications/fullscale_unzoomed.png figures/
#+end_src

#+RESULTS:

* Conclusions
#+LaTeX: \label{sec:cl}

# , although
# other benchmarks such as HPCG and HPGMG have recently been proposed to
# become the new standard

Studying HPC applications at scale can be very time- and
resource-consuming. Simulation is often an effective approach in this
context and SMPI has previously been successfully validated in several small-scale
studies with standard HPC applications\cite{smpi,heinrich:hal-01523608}.  In this
article, we proposed and evaluated extensions to the SimGrid/SMPI
framework that allowed us to emulate HPL at the scale of a
supercomputer. Our application of choice, HPL, is particularly challenging in terms of simulation
as it implements its own set of non-blocking collective operations
that rely on =MPI_Iprobe= in order to facilitate overlapping with computations.

More specifically, we tried to reproduce the execution of HPL on the
Stampede supercomputer conducted in $2013$ for the TOP500, which
involved a \NSI{120}{\tera\byte} matrix and took two hours on 6,006\nbsp{}nodes.  
Our emulation of a similar configuration ran on a single machine for
about $62$ hours and required less than \NSI{19}{\giga\byte} of RAM. This emulation
employed several non-trivial operating-system level optimizations
(memory mapping, dynamic library loading, huge pages) that have since been
integrated into the last version of SimGrid/SMPI.

The downside of scaling this high is a less well-controlled scenario.
The reference run of HPL on Stampede was done several years ago and we only
have very limited information about the setup (\eg software versions
and configuration), but a reservation and re-execution on the whole
machine was impossible for us. We nevertheless modeled Stampede carefully, which
allowed us to predict the performance that would
have been obtained using an unmodified, freely available version of HPL.
Unfortunately, despite all our efforts, the predicted performance
was much lower than what was reported in 2013. We determined that this
discrepancy comes from the fact that a modified, closed-source version of HPL
supplied by Intel was used in 2013.
We believe that some of the HPL configuration parameters were
hardcoded and therefore misreported in the output. A quick analysis of the optimized
HPL binary confirmed that algorithmic differences were likely to be the
reason for the performance differences.

We conclude that a large-scale (in)validation is unfortunately not
possible due to the modified source code being unavailable to us.
We claim that the modifications we made are
minor and are applicable to that optimized version. In fact, while HPL
comprises 16K lines of ANSI C over 149 files, our modifications only
changed 14 files with 286 line insertions and 18 deletions.

We believe being capable of precisely predicting an application's
performance on a given platform will become
invaluable in the future to aid compute centers with the decision of
whether a new machine (and what technology) will work best for a given
application or if an upgrade of the current machine should be
considered. As a future work, we intend to conduct similar studies
with other HPC benchmarks (\eg HPCG or HPGMG) and with other TOP500
machines. From our experience, we believe that a faithful and public
reporting of the experimental conditions (compiler options, library
versions, HPL output, etc.) is invaluable and allows researchers
to better understand of these platforms actually behave.

# This goal will be subject to a more thorough investigation
# in the very near future.

# As we saw in Section\ref{sec:hplchanges}, two BLAS functions (=dgemm=
# and =dtrsm=) were the dominating factor with regards to the runtime although other BLAS
# functions were called as well. For this study, we neglected the other
# functions but with a fully automatic calibration procedure for any
# BLAS function results could effortlessly become more precise as the
# application could just be linked against a BLAS-replacement
# library. 
# #+LaTeX: \CH{Problem here: HPL uses \texttt{HPL\_dtrsm()} wrappers.}

# #+LaTeX: \CH{I like the idea of pointing out again that our simulation takes much longer (48 hours instead of 2?) but that we use 1/6000 of the ressources}

** Clearpage                                               :noexport:ignore:
\clearpage\setcounter{page}{11}
* Acknowledgements

Experiments presented in this paper were carried out using the Grid'5000
testbed, supported by a scientific interest group hosted by Inria and including
CNRS, RENATER and several Universities as well as other organizations (see
https://www.grid5000.fr).

We warmly thank our TACC colleagues for their support in this study and
providing us with as much information as they could.

This research used resources of the Argonne Leadership Computing Facility, which
is a DOE Office of Science User Facility supported under Contract
DE-AC02-06CH11357.
We thank our Cray colleagues for providing us with information about the TOP500
run of Theta.
** References                                                       :ignore:

# See next section to understand how refs.bib file is created.

#+LATEX: \bibliographystyle{IEEEtran}
#+LATEX: \bibliography{refs}

* Bib file is here                                                 :noexport:

Tangle this file with C-c C-v t

#+begin_src bib :tangle refs.bib
@IEEEtranBSTCTL{IEEEexample:BSTcontrol,
   CTLuse_article_number = "yes",
   CTLuse_paper = "yes",
   CTLuse_url = "yes",
   CTLuse_forced_etal = "yes",
   CTLmax_names_forced_etal = "6",
   CTLnames_show_etal = "3",
   CTLuse_alt_spacing = "yes",
   CTLalt_stretch_factor = "4",
   CTLdash_repeated_names = "yes",
   CTLname_format_string = "{f. ~}{vv ~}{ll}{, jj}",
   CTLname_latex_cmd = "",
   CTLname_url_prefix = "[Online]. Available:"
}

@mastersthesis{cornebize:hal-01544827,
  TITLE = {{Capacity Planning of Supercomputers: Simulating MPI Applications at Scale}},
  AUTHOR = {Cornebize, Tom},
  URL = {https://hal.inria.fr/hal-01544827},
  SCHOOL = {{Grenoble INP ; Universit{\'e} Grenoble - Alpes}},
  YEAR = {2017},
  MONTH = Jun,
  KEYWORDS = {Simulation ;  MPI runtime and applications ;  Performance prediction and extrapolation ;  High Performance LINPACK},
  PDF = {https://hal.inria.fr/hal-01544827/file/report.pdf},
  HAL_ID = {hal-01544827},
  HAL_VERSION = {v1},
}

@incollection{grid5000,
   title = {Adding Virtualization Capabilities to the {Grid'5000} Testbed},
   author = {Balouek, Daniel and Carpen-Amarie, Alexandra and Charrier, Ghislain and Desprez, Fr{\'e}d{\'e}ric and Jeannot, Emmanuel and Jeanvoine, Emmanuel and L{\`e}bre, Adrien and Margery, David and Niclausse, Nicolas and Nussbaum, Lucas and Richard, Olivier and P{\'e}rez, Christian and Quesnel, Flavien and Rohr, Cyril and Sarzyniec, Luc},
   booktitle = {Cloud Computing and Services Science},
   publisher = {Springer International Publishing},
   OPTpages = {3-20},
   volume = {367},
   editor = {Ivanov, IvanI. and Sinderen, Marten and Leymann, Frank and Shan, Tony },
   series = {Communications in Computer and Information Science },
   isbn = {978-3-319-04518-4 },
   doi = {10.1007/978-3-319-04519-1\_1 },
   year = {2013},
}

%%% Online simulation of MPI applications
@article{xsim,
  author        = "Christian Engelmann",
  title         = {{Scaling To A Million Cores And Beyond: {Using} Light-Weight
                   Simulation to Understand The Challenges Ahead On The Road To
                   Exascale}},
  journal       = "FGCS",
  volume        = 30,
  pages         = "59--65",
  month         = jan,
  year          = 2014,
  publisher     = "Elsevier"}

@Article{sstmacro,
  author = {Curtis L. Janssen and Helgi Adalsteinsson and Scott Cranford and Joseph P. Kenny and Ali Pinar and David A. Evensky and Jackson Mayo},
  journal = {International Journal of Parallel and Distributed Systems},
  title = {A Simulator for Large-scale Parallel Architectures},
  volume = {1},
  number = {2},
  pages = {57--73},
  year = {2010},
  note = "\url{http://dx.doi.org/10.4018/jdst.2010040104}",
  doi = {10.4018/jdst.2010040104}
}

@article{SST,
  author    = {Rodrigues, Arun and Hemmert, Karl and Barrett, Brian
                  and Kersey, Chad and Oldfield, Ron and Weston, Marlo
                  and Riesen, Rolf and Cook, Jeanine and Rosenfeld,
                  Paul and CooperBalls, Elliot and Jacob, Bruce },
  title     = {{The Structural Simulation Toolkit}},
  journal   = {{SIGMETRICS} Performance Evaluation Review},
  volume    = 38,
  number    = 4,
  pages     = {37--42},
  year      = 2011
}

@article{dickens_tpds96,
  title={{Parallelized Direct Execution Simulation of Message-Passing
                  Parallel Programs}},
  author={Dickens, Phillip and Heidelberger, Philip and Nicol, David},
  journal={IEEE Transactions on Parallel and Distributed Systems},
  volume=7,
  number=10,
  year=1996,
  pages={1090--1105}
}

@ARTICLE{bagrodia_ijhpca01,
  author={Bagrodia, Rajive and Deelman, Ewa and Phan, Thomas},
  title={{Parallel Simulation of Large-Scale Parallel Applications}},
  journal={International Journal of High Performance Computing and
                  Applications},
  volume=15,
  number=1,
  year=2001,
  pages={3--12}
}

%%% Offline simulation of MPI applications
@INPROCEEDINGS{loggopsim_10,
  title={{LogGOPSim - Simulating Large-Scale Applications in 
          the LogGOPS Model}},
  author={Hoefler, Torsten and Siebert, Christian and Lumsdaine, Andrew},
  month=Jun,
  year={2010},
  pages = {597--604},
  booktitle={Proc. of the LSAP Workshop},
}

@inproceedings{hoefler-goal,
  author={T. Hoefler and C. Siebert and A. Lumsdaine},
  title={{Group Operation Assembly Language - A Flexible Way to Express Collective Communication}},
  year={2009},
  booktitle={Proc. of the 38th ICPP}
}

@inproceedings{bigsim_04,
  author={Zheng, Gengbin and Kakulapati, Gunavardhan and Kale,
                  Laxmikant},
  title={{BigSim: A Parallel Simulator for Performance Prediction of
                  Extremely Large Parallel Machines}},
  year=2004,
  booktitle={Proc. of the 18th IPDPS},
}

@inproceedings{dimemas,
	title = {{Dimemas: Predicting MPI Applications Behaviour in Grid Environments}},
	year = {2003},
	month = jun,
	booktitle = {Proc. of the Workshop on Grid Applications and
                  Programming Tools},
	author = {Rosa M. Badia and Jes{\'u}s Labarta and Judit Gim{\'e}nez and Francesc Escal{\'e}}
}

@article {CODES,
 title = {Enabling Parallel Simulation of Large-Scale {HPC} Network Systems},
 journal = {IEEE Transactions on Parallel and Distributed Systems},
 year = {2016},
 author = {Mubarak, M. and C. D. Carothers and Robert B. Ross and Philip H. Carns}
}

@article{ROSS_SC12,
author = {Misbah Mubarak and Christopher D. Carothers and Robert Ross and Philip Carns},
title = {{Modeling a Million-Node Dragonfly Network Using Massively Parallel Discrete-Event Simulation}},
journal ={SC Companion},
year = {2012},
pages = {366-376},
}

%%% Self citations on previous work
@Article{simgrid,
  title = {{Versatile, Scalable, and Accurate Simulation of Distributed Applications and Platforms}},
  author = {Casanova, Henri and Giersch, Arnaud and Legrand, Arnaud and Quinson, Martin and Suter, Fr{\'e}d{\'e}ric},
  publisher = {Elsevier},
  pages = {2899-2917},
  journal = {Journal of Parallel and Distributed Computing},
  volume = {74},
  number = {10},
  year = {2014}
}

@InProceedings{simetierre,
  author = {Bobelin, Laurent and Legrand, Arnaud and 
                  M{\'a}rquez, David Alejandro Gonz{\'a}lez and Navarro,
                  Pierre and Quinson, Martin and Suter,
                  Fr{\'e}d{\'e}ric and Thiery, Christophe},
  title = 	 {{Scalable Multi-Purpose Network Representation for
                  Large Scale Distributed System Simulation}},
  booktitle = {Proc. of the 12th IEEE/ACM International
                  Symposium on Cluster, Cloud and Grid Computing},
  year = 	 2012,
  pages = {220--227},
  address = 	 {Ottawa, Canada}
}

@InProceedings {simgrid_simix2_12,
  author = {Martin Quinson and Cristian Rosa and Christophe Thi{\'e}ry},
  title = {Parallel Simulation of Peer-to-Peer Systems},
  booktitle = {{P}roc. of the 12th {IEEE/ACM} {I}ntl. {S}ymposium on {C}luster, Cloud and Grid {C}omputing},
  year = {2012},
  address = {Ottawa, Canada}   
} 

@InProceedings {DCLV_LSAP_10,
  title = {{Fast and Scalable Simulation of Volunteer Computing Systems
                  Using SimGrid}},
  booktitle = {Proc. of the Workshop on Large-Scale System and Application
                  Performance},
  year = {2010},
  month = Jun,
  address = {Chicago, IL},
  author = {Donassolo, Bruno and Casanova, Henri and Legrand, Arnaud
                  and Velho, Pedro},
  category = {core}
} 

@InProceedings{SMPI_IPDPS,
  author	= {Clauss, Pierre-Nicolas and Stillwell, Mark and Genaud,
		  St\'ephane and Suter, Fr\'ed\'eric and Casanova, Henri and
		  Quinson, Martin},
  title	= {{Single Node On-Line Simulation of MPI Applications with
		  SMPI}},
  booktitle= {Proc. of the 25th IEEE Intl. Parallel and
		  Distributed Processing Symposium},
  year	= 2011,
  address	= {Anchorage, AK}
}


@Article{Velho_TOMACS13,
  author = {Velho, Pedro and Schnorr, Lucas and Casanova, Henri and Legrand, Arnaud},
  title = 	 {{On the Validity of Flow-level {TCP} Network Models for Grid and Cloud Simulations}},
  journal = 	 {ACM Transactions on Modeling and Computer Simulation},
  year = 	 {2013},
 PUBLISHER = {ACM}, 
  VOLUME = 23, 
  NUMBER = 4,
  pages = 23, 
  MONTH = Oct
}

@article{smpi,
  TITLE = {Simulating {MPI} applications: the {SMPI} approach},
  AUTHOR = {Degomme, Augustin and Legrand, Arnaud and Markomanolis, Georges and Quinson, Martin and Stillwell, Mark S and Suter, Frdric},
  JOURNAL = {{IEEE Transactions on Parallel and Distributed Systems}},
  PUBLISHER = {{Institute of Electrical and Electronics Engineers}},
  volume =       "28",
  number =       "8",
  pages =        "2387--2400",
  PAGES = {14},
  YEAR = {2017},
  MONTH = Feb,
  DOI = {10.1109/TPDS.2017.2669305},
  KEYWORDS = {Simulation ; MPI runtime and applications ; Performance prediction and extrapolation},
  PDF = {https://hal.inria.fr/hal-01415484/file/smpi_article.pdf},
  HAL_ID = {hal-01415484},
  HAL_VERSION = {v2},
  category =     "core",
}

@InProceedings{heinrich:hal-01523608,
  title =        "{Predicting the Energy Consumption of {MPI} Applications
                 at Scale Using a Single Node}",
  author =       "Franz C. Heinrich and Tom Cornebize and Augustin
                 Degomme and Arnaud Legrand and Alexandra Carpen-Amarie
                 and Sascha Hunold and Anne-Ccile Orgerie and Martin
                 Quinson",
  URL =          "https://hal.inria.fr/hal-01523608",
  booktitle =    "Proc. of the 19th IEEE Cluster Conference",
  year =         "2017",
  keywords =     "simulation ; HPC ; energy ; platform modeling",
  pdf =          "https://hal.inria.fr/hal-01523608/file/predicting-energy-consumption-at-scale.pdf",
  hal_id =       "hal-01523608",
  category =     "core",
}

% Trace extrapolation
@InProceedings{scalaextrap,
  author = 	 {Xing Wu and Frank Mueller},
  title = 	 {{S}cala{E}xtrap: Trace-Based Communication Extrapolation
                  for {SPMD} Programs},
  booktitle = {Proc. of the 16th ACM Symp. on Principles and
               Practice of Parallel Programming},
  year = 	 {2011},
  pages = {113--122},
}

@InProceedings{pmac_lspp13,
  author = 	 {Laura Carrington and Michael Laurenzano and Ananta Tiwari},
  title = 	 {Inferring Large-scale Computation Behavior via Trace Extrapolation},
  booktitle = {Proc. of the Workshop on Large-Scale Parallel Processing},
  year = 	 {2013},
}

@Misc{hpl,
  author = 	 {Antoine Petitet and Clint Whaley and Jack Dongarra and Andy Cleary and Piotr Luszczek},
  title = 	 {{HPL} - A Portable Implementation of the {High-Performance Linpack} Benchmark for Distributed-Memory Computers},
  howpublished = {\url{http://www.netlib.org/benchmark/hpl}},
  month = 	 {February},
  year = 	 {2016},
  note = 	 {Version 2.2}
}

@book{top500,
 author = {Meuer, Hans Werner and Strohmaier, Erich and Dongarra, Jack and Simon, Horst D.},
 title = {The {TOP500}: History, Trends, and Future Directions in {High Performance Computing}},
 year = {2014},
 isbn = {143981595X, 9781439815953},
 edition = {1st},
 publisher = {Chapman \& Hall/CRC},
} 

@techreport{dmodk,
  author = 	 {Eitan Zahavi},
  title = 	 {{D-Mod-K} Routing Providing Non-Blocking Traffic for Shift Permutations on Real Life Fat Trees},
  institution = {Technion Israel Institute of Technology},
  year = 	 {2010},
}

% Statistics
@Manual{R,
  title = {R: A Language and Environment for Statistical Computing},
  author = {{R Core Team}},
  organization = {R Foundation for Statistical Computing},
  address = {Vienna, Austria},
  year = {2018},
  url = {https://www.R-project.org/},
}

@inproceedings{statsmodels,
  title={Statsmodels: Econometric and statistical modeling with python},
  author={Seabold, Skipper and Perktold, Josef},
  booktitle={9th Python in Science Conference},
  year={2010},
}

@Manual{cubist,
  title = {Cubist: Rule- And Instance-Based Regression Modeling},
  author = {Max Kuhn and Ross Quinlan},
  year = {2018},
  note = {R package version 0.2.2},
  url = {https://CRAN.R-project.org/package=Cubist},
}

@Article{mclust,
  title = {{mclust} 5: clustering, classification and density estimation using {G}aussian finite mixture models},
  author = {Luca Scrucca and Michael Fop and Thomas Brendan Murphy and Adrian E. Raftery},
  journal = {The {R} Journal},
  year = {2016},
  volume = {8},
  number = {1},
  pages = {205--233},
  url = {https://journal.r-project.org/archive/2016-1/scrucca-fop-murphy-etal.pdf},
}

@Article{flexmix,
  title = {{FlexMix} Version 2: Finite Mixtures with Concomitant Variables and Varying and Constant Parameters},
  author = {Bettina Gr\"un and Friedrich Leisch},
  journal = {Journal of Statistical Software},
  year = {2008},
  volume = {28},
  number = {4},
  pages = {1--35},
  doi = {10.18637/jss.v028.i04},
  url = {http://www.jstatsoft.org/v28/i04/},
}

@article{stan,
    author = "Carpenter, Bob and Gelman, Andrew and Hoffman, Matthew D. and Lee, Daniel and Goodrich, Ben and Betancourt, Michael and Brubaker, Marcus and Guo, Jiqiang and Li, Peter and Riddell, Allen",
    doi = "10.18637/jss.v076.i01",
    url = "https://doi.org/10.18637%2Fjss.v076.i01",
    year = "2017",
    publisher = "Foundation for Open Access Statistic",
    volume = "76",
    number = "1",
    title = "Stan: A Probabilistic Programming Language",
    journal = "Journal of Statistical Software"
}

#+end_src

* Emacs Setup 							   :noexport:
# Local Variables:
# eval:    (require 'org-install)
# eval:    (org-babel-do-load-languages 'org-babel-load-languages '( (shell . t) (R . t) (perl . t) (ditaa . t) ))
# eval:    (setq org-confirm-babel-evaluate nil)
# eval:    (unless (boundp 'org-latex-classes) (setq org-latex-classes nil))
# eval:    (add-to-list 'org-latex-classes '("IEEEtran"
# "\\documentclass[conference, 10pt]{IEEEtran}\n \[NO-DEFAULT-PACKAGES]\n \[EXTRA]\n  \\usepackage{graphicx}\n  \\usepackage{hyperref}"  ("\\section{%s}" . "\\section*{%s}") ("\\subsection{%s}" . "\\subsection*{%s}")                       ("\\subsubsection{%s}" . "\\subsubsection*{%s}")                       ("\\paragraph{%s}" . "\\paragraph*{%s}")                       ("\\subparagraph{%s}" . "\\subparagraph*{%s}")))
# eval:    (add-to-list 'org-latex-classes '("llncs" "\\documentclass{llncs2e/llncs}\n \[NO-DEFAULT-PACKAGES]\n \[EXTRA]\n"  ("\\section{%s}" . "\\section*{%s}") ("\\subsection{%s}" . "\\subsection*{%s}")                       ("\\subsubsection{%s}" . "\\subsubsection*{%s}")                       ("\\paragraph{%s}" . "\\paragraph*{%s}")                       ("\\subparagraph{%s}" . "\\subparagraph*{%s}")))
# eval:    (add-to-list 'org-latex-classes '("acm-proc-article-sp" "\\documentclass{acm_proc_article-sp}\n \[NO-DEFAULT-PACKAGES]\n \[EXTRA]\n"  ("\\section{%s}" . "\\section*{%s}") ("\\subsection{%s}" . "\\subsection*{%s}")                       ("\\subsubsection{%s}" . "\\subsubsection*{%s}")                       ("\\paragraph{%s}" . "\\paragraph*{%s}")                       ("\\subparagraph{%s}" . "\\subparagraph*{%s}")))
# eval:    (add-to-list 'org-latex-classes '("acmart" "\\documentclass{acmart}\n \[NO-DEFAULT-PACKAGES]\n \[EXTRA]\n"  ("\\section{%s}" . "\\section*{%s}") ("\\subsection{%s}" . "\\subsection*{%s}")                       ("\\subsubsection{%s}" . "\\subsubsection*{%s}")                       ("\\paragraph{%s}" . "\\paragraph*{%s}")                       ("\\subparagraph{%s}" . "\\subparagraph*{%s}")))
# eval:    (add-to-list 'org-latex-classes '("sig-alternate" "\\documentclass{sig-alternate}\n \[NO-DEFAULT-PACKAGES]\n \[EXTRA]\n"  ("\\section{%s}" . "\\section*{%s}") ("\\subsection{%s}" . "\\subsection*{%s}")                       ("\\subsubsection{%s}" . "\\subsubsection*{%s}")                       ("\\paragraph{%s}" . "\\paragraph*{%s}")                       ("\\subparagraph{%s}" . "\\subparagraph*{%s}")))
# eval:    (setq org-alphabetical-lists t)
# eval:    (setq org-src-fontify-natively t)
# eval:   (setq ispell-local-dictionary "american")
# eval:   (eval (flyspell-mode t))
# eval:   (setq org-todo-keyword-faces '(("FLAWED" . (:foreground "RED" :weight bold))))
# eval:   (custom-set-variables '(org-babel-shell-names (quote ("sh" "bash" "csh" "ash" "dash" "ksh" "mksh" "posh" "zsh"))))
# eval:   (add-to-list 'load-path ".")
# eval:   (require 'ox-extra)
# eval:   (setq org-latex-tables-centered nil)
# eval:   (ox-extras-activate '(ignore-headlines))
# End:

